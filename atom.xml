<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Qiuly&#39;s blog!</title>
  
  <subtitle>A weak OIer from HN-YZ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://qiulyblog.github.io/"/>
  <updated>2019-05-06T10:07:38.445Z</updated>
  <id>http://qiulyblog.github.io/</id>
  
  <author>
    <name>Qiuly</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HEOI2013]SAO  ç»„åˆæ•°å­¦+æ ‘å½¢DP  luoguP4099</title>
    <link href="http://qiulyblog.github.io/2019/05/06/%5B%E9%A2%98%E8%A7%A3%5DluoguP4099/"/>
    <id>http://qiulyblog.github.io/2019/05/06/[é¢˜è§£]luoguP4099/</id>
    <published>2019-05-05T16:00:00.000Z</published>
    <updated>2019-05-06T10:07:38.445Z</updated>
    
    <content type="html"><![CDATA[<p>$loj$ ä¸Šæ²¡æœ‰æ­¤é¢˜ï¼Œ$bzoj$ ä¸Šæ˜¯æƒé™é¢˜ï¼Œå¯¹äºä¸ä¸Š $yzoj$ çš„æˆ‘æ¥è¯´åªèƒ½å»æ´›è°·åšé¢˜äº†ï¼š<a href="https://www.luogu.org/problemnew/show/P4099" target="_blank" rel="noopener">è½¬é€é—¨ğŸ˜„</a> ã€‚</p><p>æˆ‘ä»¬å…ˆä¸è€ƒè™‘è¾¹çš„æƒå€¼(&lt;ä¸&gt;)ï¼Œè¿™æ ·å­ $n-1$ æ¡è¾¹ç»„æˆçš„å°±æ˜¯æ ‘äº†ï¼Œå¾ˆæ˜¾ç„¶æ˜¯éœ€è¦æˆ‘ä»¬æ±‚å‡ºè¿™æ£µæ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„ä¸ªæ•°ï¼Œè€ƒè™‘ä½¿ç”¨ $\rm{DP}$ ï¼Œå¯¹äºè¾¹çš„æ–¹å‘(å³&lt;,&gt;) ï¼Œæˆ‘ä»¬åˆ†ç±»è®¨è®ºå³å¯ã€‚</p><p>é¦–å…ˆçš„ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è®¾ $f_u$ è¡¨ç¤ºç‚¹ $u$ çš„å­æ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„æ€»æ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å¦‚ä½•è®¡ç®—å‘¢<a id="more"></a>ï¼Œå¯¹äºä¸€ä¸ª $u$ çš„å„¿å­ $v$ ï¼Œæˆ‘ä»¬è™½ç„¶çŸ¥é“ $u$ å’Œ $v$ çš„æ”»å…‹çš„å‰åå…³ç³»ï¼Œä½†æ˜¯åˆå¹¶ç­”æ¡ˆè²Œä¼¼å¹¶ä¸å¥½åˆå¹¶ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¢åŠ ä¸€ç»´ $j$ ï¼Œ$f_{u,j}$ è¡¨ç¤º $u$ çš„å­æ ‘çš„æ‰€æœ‰åˆæ³•æ‹“æ‰‘åºä¸­ $u$ åœ¨ç¬¬ $j$ ä½ä¸Šçš„æ€»çŠ¶æ€æ•°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªå¿…é¡»åœ¨ $u$ å‰é¢æ”»å…‹çš„å…³å¡ $v$ ï¼Œæˆ‘ä»¬è€ƒè™‘æšä¸¾ä¸€ä¸ª $j$ ï¼Œ$v$ å­æ ‘ä¸­ $j$ ä¸ªç»“ç‚¹åœ¨åˆå¹¶ $u,v$ åæ”¾åˆ° $u$ å‰é¢ï¼Œå¦å¤– $sz_v-j$ ä¸ªæ”¾åˆ° $u$ åé¢ï¼Œç„¶åæšä¸¾ä¸€ä¸ª $k$ ï¼Œè¡¨ç¤ºå½“å‰çš„ $v$ æ’åœ¨ $v$ å­æ ‘çš„æ‹“æ‰‘åºä¸­çš„ç¬¬ $k$ ä½ï¼Œåªæœ‰ $k\leq j$ çš„æ—¶å€™ $v$ æ‰å¯ä»¥è½¬ç§» $u$ ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ $v$ åœ¨ $u$ å‰é¢ã€‚</p><p>ç°åœ¨å†æ¥è€ƒè™‘$â€œ$ $j$ ä¸ªç»“ç‚¹æ”¾åœ¨ $u$ å‰é¢ $â€$ çš„æ–¹æ¡ˆæ•°å’Œ$â€œ$ $sz_v-j$ ä¸ªç»“ç‚¹æ”¾åœ¨ $u$ åé¢çš„æ–¹æ¡ˆæ•°$â€$ï¼Œè¿™ä¸ªæ˜¾ç„¶å¯ä»¥ç”¨ç»„åˆæ•°ç®—ï¼Œåˆå¹¶ $v$ çš„å­æ ‘åï¼Œ$u$ çš„æ’åä» $i$ å˜æˆäº† $i+j$ ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦å°† $j$ ä¸ªä¹±åºæ’å…¥åˆ° $u$ å‰é¢ $i+j-1$ ä¸ªæ•°ä¸­ï¼Œæ–¹æ¡ˆæ•°æ˜¾ç„¶ä¸º $C_{i+j-1}^{j}$ ï¼Œé‚£ä¹ˆç°åœ¨æ€»èŠ‚ç‚¹æ•°æ˜¾ç„¶ä¸º $sz_u+sz_v$ (ç°åœ¨ $sz_u$ å’Œ $sz_v$ è¿˜æ²¡æœ‰å¹¶åœ¨ä¸€èµ·) ï¼Œ$u$ åé¢ç†æ‰€å½“ç„¶æœ‰ $sz_u+sz_v-i-j$ ä¸ªä½ç½®ï¼Œå°† $sz_v-j$ ä¸ªæ•°æ’è¿›å»çš„æ–¹æ¡ˆæ•°æ˜¾ç„¶ä¸º $C_{sz_u+sz_v-i-j}^{sz_v-j}$ ä¸ªï¼Œè¿™ä¸¤ä¸ªæ•°å†ä¹˜ä¸Š $f_{u,i}$ å’Œ $f_{v,k}$ å°±å¥½äº†ï¼Œè¿™ä¸€æ¬¡åˆå¹¶å $u$ çš„ä½ç½®æ˜¾ç„¶åˆ°äº† $i+j$ ï¼Œæ‰€ä»¥ $f_{u,i+j}$ æ˜¾ç„¶è¦åŠ ä¸Šè¿™ä¸€ç»„è´¡çŒ®ã€‚</p><p>ç»æ•´ç†åçš„è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">pls(f_{u,i+j},f_{u,i}\cdot f_{v,k}\cdot C_{i+j-1}^{j}\cdot C_{sz_u+sz_v-i-j}^{sz_v-j})</script><p>ä»£ç å°±æ˜¯è¿™æ ·å†™ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i=<span class="number">1</span> to sz[u]</span><br><span class="line">    <span class="keyword">for</span> j=<span class="number">1</span> to sz[v]</span><br><span class="line">        <span class="keyword">for</span> k=<span class="number">1</span> to j</span><br><span class="line">            pls(f[u][i+j],f[u][i]*f[v][k]*C[i+j<span class="number">-1</span>][j]*C[sz[u]+sz[v]-i-j][sz[v]-j])</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ $n^3$ çš„ï¼Œè¿‡ä¸å»ã€‚è€ƒè™‘å‰ç¼€å’Œä¼˜åŒ–ï¼Œå‡ ä¸‹ $f_v$ çš„å‰ç¼€å’Œï¼Œæœ€åçš„ä¸€å±‚å¾ªç¯å°±å¯ä»¥ç›´æ¥ä¸¢æ‰äº†ã€‚</p><p>è¿™ä¸ªå°±æ˜¯ $v$ è¦åœ¨ $u$ å‰é¢çš„æƒ…å†µï¼Œ$u$ åœ¨ $v$ å‰é¢çš„æƒ…å†µå’Œè¿™ä¸ªå·®ä¸å¤šï¼Œä¸è¿‡è½¬ç§»çš„æ—¶å€™ $j$ å°±è¦ä» $0$ å¼€å§‹äº†ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™ $u$ å‰é¢æ˜¯å¯ä»¥ä¸å¤šæ”¾ä»»ä½•ä¸œè¥¿çš„ï¼Œè¿˜æœ‰å°±æ˜¯ $u$ åœ¨ $v$ å‰é¢çš„æ—¶å€™æ³¨æ„ $k\geq j$ æ—¶æ‰å¯ä»¥è½¬ç§» !</p><p>æœ€åçš„ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{i=1}^{n} f_{1,i}$ å•¦ã€‚</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e3</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[N],cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to,val;&#125;G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> C[N][N],f[N][N],pre[N][N],suf[N][N],sz[N],g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[u],v,w&#125;,head[u]=cnt;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[v],u,w^<span class="number">1</span>&#125;,head[v]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(<span class="keyword">int</span>&amp;x,<span class="keyword">int</span> y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;=mod)x-=mod;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sz[u]=f[u][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l=head[u];l;l=G[l].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> v=G[l].to,w=G[l].val;</span><br><span class="line">        <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v,u);</span><br><span class="line">        <span class="built_in">memset</span>(g,<span class="number">0</span>,<span class="keyword">sizeof</span>(g));</span><br><span class="line">        <span class="keyword">if</span>(w) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=sz[v];++j)</span><br><span class="line">                    pls(g[i+j],<span class="number">1l</span>l*f[u][i]*pre[v][j]%mod*C[i+j<span class="number">-1</span>][j]%mod</span><br><span class="line">                    *C[sz[u]+sz[v]-i-j][sz[v]-j]%mod);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=sz[v];++j)</span><br><span class="line">                    pls(g[i+j],<span class="number">1l</span>l*f[u][i]*suf[v][j+<span class="number">1</span>]%mod*C[i+j<span class="number">-1</span>][j]%mod</span><br><span class="line">                    *C[sz[u]+sz[v]-i-j][sz[v]-j]%mod);</span><br><span class="line">        &#125;</span><br><span class="line">        sz[u]+=sz[v];</span><br><span class="line">        <span class="built_in">memcpy</span>(f[u],g,<span class="keyword">sizeof</span>(g));</span><br><span class="line">    &#125;</span><br><span class="line">    pre[u][<span class="number">0</span>]=suf[u][sz[u]+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i) pre[u][i]=(pre[u][i<span class="number">-1</span>]+f[u][i])%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=sz[u];i&gt;=<span class="number">1</span>;--i) suf[u][i]=(suf[u][i+<span class="number">1</span>]+f[u][i])%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head)),cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">int</span> n;IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u,v;<span class="keyword">char</span> sign;</span><br><span class="line">        IN(u),sign=getchar(),IN(v);</span><br><span class="line">        add(u+<span class="number">1</span>,v+<span class="number">1</span>,sign==<span class="string">'&lt;'</span>?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) pls(ans,f[<span class="number">1</span>][i]);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*é¢„å¤„ç†ç»„åˆæ•°*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=N<span class="number">-2</span>;++i) C[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N<span class="number">-2</span>;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=N<span class="number">-2</span>;++j)</span><br><span class="line">            C[i][j]=(C[i<span class="number">-1</span>][j]+C[i<span class="number">-1</span>][j<span class="number">-1</span>])%mod;</span><br><span class="line">    <span class="keyword">int</span> T;IN(T);</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯èƒ½æœ‰äººä¼šé—®ï¼Œå¦‚æœ $u$ çš„å„¿å­ $v$ ä¸‹é¢çš„è¾¹å…¨éƒ½æ˜¯ $&gt;$ ï¼Œå¹¶ä¸” $u$ è¿å‘ $v$ çš„è¾¹ä¹Ÿæ˜¯ $&gt;$ ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ $v$ ä»¥åŠå…¶å­æ ‘çš„æ‰€æœ‰ç‚¹éƒ½å¿…é¡»åœ¨ $u$ å‰é¢å®Œæˆï¼Œåœ¨è½¬ç§»çš„æ—¶å€™ä¸ºä»€ä¹ˆå¯ä»¥ $â€œ$ æå‡º $j$ ä¸ªç»“ç‚¹æ”¾åˆ° $u$ å‰é¢ $â€$ å‘¢ï¼Ÿ</p><p>å…¶å®æƒ³æƒ³å°±å¯ä»¥æ˜ç™½ï¼Œåœ¨å‘ä¸Šç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™å¯¹äºä¸€ä¸ª $v$ çš„å„¿å­ $a$ ï¼Œæˆ‘ä»¬åªç»Ÿè®¡äº†åˆå¹¶å $a$ åœ¨ $v$ å‰é¢çš„æƒ…å†µï¼ŒåŒæ ·åœ¨ $u$ ç»Ÿè®¡ $v$ æ—¶ä¹Ÿåªæ˜¯ç»Ÿè®¡äº†åˆå¹¶å $v$ åœ¨ $u$ å‰é¢çš„æƒ…å†µï¼Œæ‰€æœ‰æˆ‘ä»¬ä¹Ÿåªæ˜¯ç»Ÿè®¡äº† $â€œ$ $a$ åœ¨ $v$ å‰é¢ä¸” $v$ åœ¨ $u$ å‰é¢ $â€$ çš„æƒ…å†µï¼Œæ‰€æœ‰è¢«ç»Ÿè®¡çš„æƒ…å†µä¸€å®šæ˜¯åˆæ³•çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;$loj$ ä¸Šæ²¡æœ‰æ­¤é¢˜ï¼Œ$bzoj$ ä¸Šæ˜¯æƒé™é¢˜ï¼Œå¯¹äºä¸ä¸Š $yzoj$ çš„æˆ‘æ¥è¯´åªèƒ½å»æ´›è°·åšé¢˜äº†ï¼š&lt;a href=&quot;https://www.luogu.org/problemnew/show/P4099&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è½¬é€é—¨ğŸ˜„&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä¸è€ƒè™‘è¾¹çš„æƒå€¼(&amp;lt;ä¸&amp;gt;)ï¼Œè¿™æ ·å­ $n-1$ æ¡è¾¹ç»„æˆçš„å°±æ˜¯æ ‘äº†ï¼Œå¾ˆæ˜¾ç„¶æ˜¯éœ€è¦æˆ‘ä»¬æ±‚å‡ºè¿™æ£µæ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„ä¸ªæ•°ï¼Œè€ƒè™‘ä½¿ç”¨ $\rm{DP}$ ï¼Œå¯¹äºè¾¹çš„æ–¹å‘(å³&amp;lt;,&amp;gt;) ï¼Œæˆ‘ä»¬åˆ†ç±»è®¨è®ºå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆçš„ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è®¾ $f_u$ è¡¨ç¤ºç‚¹ $u$ çš„å­æ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„æ€»æ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å¦‚ä½•è®¡ç®—å‘¢&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ç»„åˆæ•°å­¦" scheme="http://qiulyblog.github.io/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"/>
    
      <category term="æ ‘å½¢DP" scheme="http://qiulyblog.github.io/tags/%E6%A0%91%E5%BD%A2DP/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘  [HAOI2018]è‹¹æœæ ‘  ç»„åˆæ•°å­¦  loj2526</title>
    <link href="http://qiulyblog.github.io/2019/05/05/%5B%E9%A2%98%E8%A7%A3%5Dloj2526/"/>
    <id>http://qiulyblog.github.io/2019/05/05/[é¢˜è§£]loj2526/</id>
    <published>2019-05-04T16:00:00.000Z</published>
    <updated>2019-05-06T05:23:46.830Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰è¶£çš„é¢˜ç›®ï¼Œå¯çˆ±çš„ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2526" target="_blank" rel="noopener">æˆ³è¿™å‘¢=ï¿£Ï‰ï¿£=</a></p><p>åˆšå¼€å§‹å¾€æ¦‚ç‡ $\rm{DP}$ æƒ³äº†ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç‚¹çš„æ¦‚ç‡æ˜¯å¥½ç®—ï¼Œä½†æ˜¯å¦‚æœæ±‚è´¡çŒ®çš„è¯å°±ä¼šå¾ˆéš¾åŠã€‚æœ€åä¸‡èˆ¬æ— èµ–çš„ç‚¹å¼€äº†é¢˜è§£ï¼Œå‘ç°å±…ç„¶æ˜¯â€¦â€¦ç»„åˆæ•°å­¦ï¼Ÿå…¶å®å’Œ $\rm{DP}$ æ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ $i$ ï¼Œæˆ‘ä»¬æšä¸¾å…¶å­æ ‘å¤§å° $j$ ã€‚ç°åœ¨è€ƒè™‘æœ€ç»ˆæœ‰å¤šå°‘ç§åˆæ³•çš„æƒ…å†µå¯ä»¥ä½¿å¾— $i$ çš„å­æ ‘å¤§å°æ°å¥½ä¸º $j$ ã€‚</p><a id="more"></a><p>æ˜“çŸ¥èŠ‚ç‚¹æ•°ä¸º $n$ çš„äºŒå‰æ ‘çš„æ€»å½¢æ€æ•°ä¸º $n!$ ï¼Œè€Œä¸” $i$ å­æ ‘ä¸‹çš„æ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·ä¸€å®šè¦å¤§äº $i$ ï¼Œæˆ‘ä»¬è€ƒè™‘â€å…ˆå°† $i$ å­æ ‘æ„é€ å‡ºæ¥å†å¡«å…¥èŠ‚ç‚¹â€çš„è¿‡ç¨‹ï¼Œå­æ ‘çš„å½¢æ€æ•°æ˜¾ç„¶ä¸º $j!$ ï¼Œç„¶åæˆ‘ä»¬åªèƒ½é€‰å‰©ä¸‹çš„ $n-i$ ä¸ªèŠ‚ç‚¹(ç¼–å·è¦æ¯” $i$ å¤§) ï¼Œå¡«å…¥å‰©ä¸‹çš„ $j-1$ ä¸ªä½ç½®( $i$ å äº†ä¸€ä¸ªä½ç½®) ï¼Œæ˜¾ç„¶è¿™æ ·çš„æ–¹æ¡ˆæ•°ä¸º $C_{n-i}^{j-1}$ ã€‚</p><p>è¿™æ ·çš„ä¸€ä¸ª $i$ ï¼Œå…¶å­æ ‘å¤§å°ä¸º $j$ ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥åšå‡ºå¤šå°‘è´¡çŒ®å‘¢ï¼Ÿè€ƒè™‘ $fa_i \Rightarrow i$ è¿™æ¡è¾¹ä¼šç»è¿‡å¤šå°‘æ¬¡ï¼Œæ˜¾ç„¶æ˜¯ $j\cdot(n-j)$ æ¬¡( $j$ ä¸ºå­æ ‘èŠ‚ç‚¹ä¸ªæ•°ï¼Œ$n-j$ ä¸ºä¸Šé¢çš„èŠ‚ç‚¹ä¸ªæ•°) ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ ·çš„æ–¹æ¡ˆå¯ä»¥é€ æˆ $j\cdot (n-j)$ çš„è´¡çŒ®ã€‚</p><p>é‚£ä¹ˆç°åœ¨ $i$ çš„å­æ ‘å¾—åˆ°ç¡®å®šäº†ï¼Œæˆ‘ä»¬å°† $i$ ä»¥åŠå…¶å­æ ‘çœ‹åšä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è€ƒè™‘ $1$ åˆ° $i$ è¿™äº›èŠ‚ç‚¹ï¼Œå®ƒä»¬å¯ä»¥ä»¥ä»»æ„å½¢æ€ç»„æˆä¸€æ£µæ ‘ï¼Œæ–¹æ¡ˆæ•°æ˜¯ $i!$ ã€‚</p><p>æ¥ç€æˆ‘ä»¬éœ€è¦å°†å‰©ä¸‹çš„ $n-j-(i-1)$ ä¸ªèŠ‚ç‚¹æŒ‚åˆ°æ ‘ä¸Šå»ã€‚å¯¹äºç¬¬ $i$ ä¸ªæŒ‚åˆ°æ ‘ä¸Šçš„ç‚¹ï¼Œå®ƒæœ‰ $i$ ä¸ªä½ç½®å¯ä»¥æŒ‚ã€‚ä½†æ˜¯å› ä¸º $i$ ä¸€å®šè¦å ä¸€ä¸ªä½ç½®ï¼Œæ‰€ä»¥è¿™ä¸ªèŠ‚ç‚¹åªæœ‰ $i-1$ ä¸ªä½ç½®å¯ä»¥æŒ‚äº†ï¼Œç¬¬äºŒä¸ªå¤šå‡ºæ¥çš„èŠ‚ç‚¹å°±æœ‰ $i$ ä¸ªä½ç½®å¯ä»¥æŒ‚â€¦â€¦ç¬¬ $k$ ä¸ªæ˜¾ç„¶æœ‰ $i-2+k$ ä¸ªä½ç½®å¯ä»¥æŒ‚ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™äº›ç‚¹æŒ‚ä¸Šå»çš„æ€»æ–¹æ¡ˆæ•°ä¸º $\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)$ ã€‚</p><p>å°†ä¸Šé¢çš„ä¹˜èµ·æ¥å°±æ˜¯è¿™ä¸€ç»„ $i,j$ å¯¹ç­”æ¡ˆé€ æˆçš„è´¡çŒ®äº†ï¼š</p><script type="math/tex; mode=display">j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i!\cdot\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)</script><p>$\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)$ æ¯”è¾ƒä¸å¥½è®¡ç®—ï¼Œä½†æ˜¯ç®€å•çš„å˜åŒ–åå‘ç°è¿™ä¸ªæ˜¯å’Œ $(n-j-1)!/(i-2)!$ ç­‰ä»·çš„ï¼Œæˆ‘ä»¬å¸¦è¿›åŸå¼å­ã€‚</p><script type="math/tex; mode=display">j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i!\cdot(n-j-1)!/(i-2)!\\\\=j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i\cdot (i-1)\cdot(n-j-1)!\\\\=j!\cdot C_{n-i}^{j-1}\cdot j\cdot i\cdot (i-1)\cdot (n-j)!</script><p>è¿™æ ·å°±å¾ˆå¥½ç®—äº†ï¼Œæˆ‘ä»¬é¢„å¤„ç†ç»„åˆæ•°å’Œé˜¶ä¹˜ï¼Œä¸Šé¢çš„å¼å­ $O(1)$ ç®—~</p><p>ä»£ç å¾ˆçŸ­ã€‚</p><h3 id="Codeï¼š"><a href="#Codeï¼š" class="headerlink" title="Codeï¼š"></a>Codeï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e3</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,p,ans,fac[N],C[N][N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(<span class="keyword">int</span>&amp;x,<span class="keyword">int</span> y)</span> </span>&#123;x+=y;x%=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(p);</span><br><span class="line">    fac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) fac[i]=<span class="number">1l</span>l*fac[i<span class="number">-1</span>]*i%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) C[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i;++j)</span><br><span class="line">            C[i][j]=(C[i<span class="number">-1</span>][j]+C[i<span class="number">-1</span>][j<span class="number">-1</span>])%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n-i+<span class="number">1</span>;++j)</span><br><span class="line">            pls(ans,(ll)fac[j]*fac[n-j]%p*C[n-i][j<span class="number">-1</span>]%p*(i*(i<span class="number">-1</span>))%p*j%p);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ‰è¶£çš„é¢˜ç›®ï¼Œå¯çˆ±çš„ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2526&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ³è¿™å‘¢=ï¿£Ï‰ï¿£=&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹å¾€æ¦‚ç‡ $\rm{DP}$ æƒ³äº†ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç‚¹çš„æ¦‚ç‡æ˜¯å¥½ç®—ï¼Œä½†æ˜¯å¦‚æœæ±‚è´¡çŒ®çš„è¯å°±ä¼šå¾ˆéš¾åŠã€‚æœ€åä¸‡èˆ¬æ— èµ–çš„ç‚¹å¼€äº†é¢˜è§£ï¼Œå‘ç°å±…ç„¶æ˜¯â€¦â€¦ç»„åˆæ•°å­¦ï¼Ÿå…¶å®å’Œ $\rm{DP}$ æ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ $i$ ï¼Œæˆ‘ä»¬æšä¸¾å…¶å­æ ‘å¤§å° $j$ ã€‚ç°åœ¨è€ƒè™‘æœ€ç»ˆæœ‰å¤šå°‘ç§åˆæ³•çš„æƒ…å†µå¯ä»¥ä½¿å¾— $i$ çš„å­æ ‘å¤§å°æ°å¥½ä¸º $j$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ç»„åˆæ•°å­¦" scheme="http://qiulyblog.github.io/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [å…­çœè”è€ƒ2017]åˆ†æ‰‹æ˜¯ç¥æ„¿  æ¦‚ç‡DP  loj2145</title>
    <link href="http://qiulyblog.github.io/2019/05/05/%5B%E9%A2%98%E8%A7%A3%5Dloj2145/"/>
    <id>http://qiulyblog.github.io/2019/05/05/[é¢˜è§£]loj2145/</id>
    <published>2019-05-04T16:00:00.000Z</published>
    <updated>2019-05-05T02:43:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ¦‚ç‡ç¥ä»™é¢˜çš„ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2145" target="_blank" rel="noopener"><del>åˆ«æˆ³åäº†</del></a></p><p>è®¾ $f_i$ è¡¨ç¤ºè¿˜å‰©ä¸‹ $i$ ç›ç¯äº®åˆ°è¿˜å‰©ä¸‹ $i-1$ ç›ç¯äº®çš„æœŸæœ›æ“ä½œæ¬¡æ•°ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ $\frac{i}{n}$ çš„æ¦‚ç‡æŒ‰ä¸­äº®çš„ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‰ä¸­äº®çš„çš„è¯å°±åªèƒ½é€€åˆ° $f_{i+1}$ ã€‚ä¸éš¾åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_i=\frac{i}{n}+(1-\frac{i}{n})\cdot (1+f_i+f_{i+1})</script><p>å› ä¸ºè½¬ç§»å¼ä¸­æœ‰ä¸ª $f_i$ ï¼Œæœ‰äº›ä¸å¥½åŠâ€¦â€¦æ¨ä¸€æ¨å¼å­åº·åº·ã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=\frac{i}{n}+1\cdot (1+f_i+f_{i+1})-\frac{i}{n}\cdot (1+f_i+f_{i+1})\\\\f_i=\frac{i}{n}+1+f_i+f_{i+1}-\frac{i}{n}-\frac{i}{n}f_i-\frac{i}{n}f_{i+1}\\\\f_i=1+f_i+f_{i+1}-\frac{i}{n}f_i-\frac{i}{n}f_{i+1}\\\\\frac{i}{n}f_i=1+f_{i+1}-\frac{i}{n}f_{i+1}\\\\f_i=\frac{1+f_{i+1}-\frac{i}{n}f_{i+1}}{\frac{i}{n}}\\\\f_i=\frac{n\cdot(1+f_{i+1})-i\cdot f_{i+1}}{i}\\\\f_i=\frac{n+(n-i)\cdot f_{i+1}}{i}\\\\f_i=1+\frac{(n-i)\cdot (f_{i+1}+1)}{i}</script><p>é¢„å¤„ç†é€†å…ƒå°±å¯ä»¥ç›´æ¥è®¡ç®—äº†ï¼Œè®°å¾—æœ€åä¹˜ä¸Š $n!$ ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p=<span class="number">100003</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,k,step,a[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans,f[N],inv[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(k);</span><br><span class="line">    inv[<span class="number">0</span>]=<span class="number">0</span>,inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) inv[i]=(<span class="keyword">long</span> <span class="keyword">long</span>)(p-p/i)*inv[p%i]%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;=n;j+=i) g[j].push_back(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;--i) <span class="keyword">if</span>(a[i]) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;g[i].size();++j) a[g[i][j]]^=<span class="number">1</span>;</span><br><span class="line">        ++step;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(step&lt;=k) ans=step;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        f[n]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;<span class="number">1</span>;--i) f[i]=(<span class="number">1l</span>l+(<span class="number">1l</span>l*n-i)*(f[i+<span class="number">1</span>]+<span class="number">1</span>)*inv[i])%p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=step;i&gt;k;--i) ans=(ans+f[i])%p;</span><br><span class="line">        ans=(ans+k)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans=(<span class="number">1l</span>l*i*ans)%p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¦‚ç‡ç¥ä»™é¢˜çš„ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2145&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;del&gt;åˆ«æˆ³åäº†&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºè¿˜å‰©ä¸‹ $i$ ç›ç¯äº®åˆ°è¿˜å‰©ä¸‹ $i-1$ ç›ç¯äº®çš„æœŸæœ›æ“ä½œæ¬¡æ•°ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ $\frac{i}{n}$ çš„æ¦‚ç‡æŒ‰ä¸­äº®çš„ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‰ä¸­äº®çš„çš„è¯å°±åªèƒ½é€€åˆ° $f_{i+1}$ ã€‚ä¸éš¾åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\frac{i}{n}+(1-\frac{i}{n})\cdot (1+f_i+f_{i+1})&lt;/script&gt;&lt;p&gt;å› ä¸ºè½¬ç§»å¼ä¸­æœ‰ä¸ª $f_i$ ï¼Œæœ‰äº›ä¸å¥½åŠâ€¦â€¦æ¨ä¸€æ¨å¼å­åº·åº·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SCOI2014]æ–¹ä¼¯ä¼¯çš„ç‰ç±³ç”°  æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–DP  luoguP3287</title>
    <link href="http://qiulyblog.github.io/2019/05/04/%5B%E9%A2%98%E8%A7%A3%5DluoguP3287/"/>
    <id>http://qiulyblog.github.io/2019/05/04/[é¢˜è§£]luoguP3287/</id>
    <published>2019-05-03T16:00:00.000Z</published>
    <updated>2019-05-05T02:25:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥åä¸è¦è¢«è¿™ç§å‚»é€¼é¢˜ç»™è’™éª—äº†ã€‚ä¼ é€é—¨ï¼š<a href="https://www.luogu.org/problemnew/show/P3287" target="_blank" rel="noopener">æ–¹ä¼¯ä¼¯çš„ä¼ é€é—¨=ã€‚=</a></p><p>é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼Œæ¯ä¸€æ¬¡æ‹”é«˜çš„å³ç«¯ç‚¹ä¸€å®šæ˜¯ $n$ ï¼Œå¦‚æœæ˜¯åªæ‹”é«˜ä¸­é—´éƒ¨åˆ†ï¼Œå³è¾¹çš„åˆè¦å°½å¯èƒ½å¤§äºä¸­é—´éƒ¨åˆ†ï¼Œç´¢æ€§ä¸€èµ·æ‹”äº†ï¼Œè¿™ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚</p><p>è®¾ $f_{i,j}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªç‰ç±³è¢«æ‹”é«˜äº† $j$ æ¬¡æ—¶ä»¥ $i$ ç»“å°¾çš„æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é•¿åº¦ï¼Œå®¹æ˜“å¾—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><a id="more"></a><script type="math/tex; mode=display">f_{i,j}=\max\{f_{k,l}+1\} \ \ (k<i,l\leq j,h_i+j\geq h_k+l)</script><p>å¯èƒ½æœ‰äººä¼šé—®ä¸ºä»€ä¹ˆ $l\leq j$ ï¼Œå¾ˆæ˜¾ç„¶å°±æ˜¯ä¸Šé¢çš„é“ç†ï¼Œè¶Šå¤§çš„ $i$ ä¸€å®šæ‹”é«˜æ¬¡æ•°æ˜¯å•è°ƒä¸å‡çš„ã€‚</p><p>å‘ç°ä¸Šé¢çš„è½¬ç§»å…¶å®æ˜¯ $O(n^2k^2)$ çš„ï¼Œä¸‡æ¶çš„å‡ºé¢˜äººä¸ä¼šç»™è¿™ä¸ªå¤æ‚åº¦ä¸€ä¸ç‚¹åˆ†â€¦â€¦è¿™ä¸ªæ—¶å€™ç”¨æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–è½¬ç§»ï¼Œå‘ç°ä¸Šé¢æœ‰ä¸‰ä¸ªé™åˆ¶æ¡ä»¶ï¼Œæˆ‘ä»¬æ­£ç€æšä¸¾ $i$ ï¼Œå°±å·²ç»æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶äº†ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™æ ‘çŠ¶æ•°ç»„ä¸­çš„éƒ½æ˜¯å°äº $i$ çš„ $k$ ã€‚ç„¶åå°†æ¯ä¸ªç‚¹æŒ‰ç…§ $(j+1,h_i+j)$ æ”¾åˆ°å¹³é¢ä¸Šï¼Œç„¶åæ ‘çŠ¶æ•°ç»„ç»Ÿè®¡ç­”æ¡ˆå³å¯ã€‚</p><p>æ ‘çŠ¶æ•°ç»„ç»´æŠ¤çš„æ˜¯ $\max$  ï¼Œä¸æ˜¯å’Œã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e4</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K=<span class="number">5e2</span>+<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N],n,k,mx;</span><br><span class="line"><span class="keyword">namespace</span> BIT&#123;</span><br><span class="line">    <span class="keyword">int</span> c[N][<span class="number">5009</span>+K];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">const</span> <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(;x&lt;=mx+k;x+=(x&amp;-x))<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i&lt;=k+<span class="number">1</span>;i+=(i&amp;-i))</span><br><span class="line">                c[x][i]=max(c[x][i],v); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(;x;x-=(x&amp;-x))<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i;i-=(i&amp;-i))</span><br><span class="line">                ans=max(ans,c[x][i]);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> BIT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]),mx=max(mx,a[i]);</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)   </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=k;~j;--j) &#123;</span><br><span class="line">            <span class="keyword">int</span> res=query(a[i]+j,j+<span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line">            ans=max(ans,res),update(a[i]+j,j+<span class="number">1</span>,res);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»¥åä¸è¦è¢«è¿™ç§å‚»é€¼é¢˜ç»™è’™éª—äº†ã€‚ä¼ é€é—¨ï¼š&lt;a href=&quot;https://www.luogu.org/problemnew/show/P3287&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ–¹ä¼¯ä¼¯çš„ä¼ é€é—¨=ã€‚=&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼Œæ¯ä¸€æ¬¡æ‹”é«˜çš„å³ç«¯ç‚¹ä¸€å®šæ˜¯ $n$ ï¼Œå¦‚æœæ˜¯åªæ‹”é«˜ä¸­é—´éƒ¨åˆ†ï¼Œå³è¾¹çš„åˆè¦å°½å¯èƒ½å¤§äºä¸­é—´éƒ¨åˆ†ï¼Œç´¢æ€§ä¸€èµ·æ‹”äº†ï¼Œè¿™ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f_{i,j}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªç‰ç±³è¢«æ‹”é«˜äº† $j$ æ¬¡æ—¶ä»¥ $i$ ç»“å°¾çš„æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é•¿åº¦ï¼Œå®¹æ˜“å¾—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ ‘çŠ¶æ•°ç»„" scheme="http://qiulyblog.github.io/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
      <category term="äºŒç»´æ ‘çŠ¶æ•°ç»„" scheme="http://qiulyblog.github.io/tags/%E4%BA%8C%E7%BB%B4%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SHOI2014]æ¦‚ç‡å……ç”µå™¨  æ¦‚ç‡DP  loj2192</title>
    <link href="http://qiulyblog.github.io/2019/05/02/%5B%E9%A2%98%E8%A7%A3%5Dloj2192/"/>
    <id>http://qiulyblog.github.io/2019/05/02/[é¢˜è§£]loj2192/</id>
    <published>2019-05-01T16:00:00.000Z</published>
    <updated>2019-05-05T02:07:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¼ é€é—¨åœ¨è¿™ï¼š<a href="https://loj.ac/problem/2192" target="_blank" rel="noopener">æˆ‘æ˜¯ä¼ é€é—¨$QwQ$</a></p><p>å…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦ç®—çš„å°±æ˜¯ $\sum a_i$ (å…¶ä¸­ $a_i$ ä¸ºç‚¹ $i$ çš„é€šç”µæ¦‚ç‡) ã€‚æˆ‘ä»¬éœ€è¦ç®—å‡ºæ¯ä¸ªç‚¹çš„é€šç”µæ¦‚ç‡å³å¯ã€‚å› ä¸ºæœ‰äº›ç‚¹å¯ä»¥è‡ªå·±å‘ç”µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è€ƒè™‘çˆ¶äº²å’Œå„¿å­çš„é€šç”µæƒ…å†µã€‚</p><p>å› ä¸ºç›´æ¥è®¾é€šç”µæ¦‚ç‡æœ‰äº›æ£˜æ‰‹ï¼Œæˆ‘ä»¬è®¾ $f_i$ è¡¨ç¤ºç‚¹ $i$ çš„å„¿å­æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç®—ï¼Œæˆ‘ä»¬é¡ºå¸¦ç®—ä¸Šç‚¹ $i$ è‡ªå·±å‘ç”µçš„æ¦‚ç‡ã€‚</p><a id="more"></a><p>æšä¸¾æ¯ä¸€ä¸ªå„¿å­ï¼Œå¯¹äºè¿™ä¸ªå„¿å­åªæœ‰ä¸¤ç§æƒ…å†µï¼šè¯¥å„¿å­æ²¡æœ‰é€šä¸Šç”µï¼Œè¯¥å„¿å­é€šä¸Šç”µäº†ä¸”ä¼ é€å¤±è´¥ã€‚ä¸¤ç§æƒ…å†µçš„æ¦‚ç‡éƒ½å¾ˆå¥½ç®—ã€‚æˆ‘ä»¬å¯ä»¥åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_u=(1-q_u)\cdot \prod (f_v+(1-f_v)\cdot(1-G_i.p))</script><p>å…¶ä¸­ $(1-q_u)$ æ˜¾ç„¶ä¸ºè¯¥ç‚¹æœ¬èº«ä¸é€šç”µçš„æ¦‚ç‡ï¼Œç„¶åæšä¸¾å„¿å­ $v$ ï¼Œ$f_v$ å°±æ˜¯è¯¥å„¿å­æœ¬æ¥å°±æ²¡æœ‰é€šä¸Šç”µçš„æ¦‚ç‡ï¼Œ$(1-f_v)\cdot(1-G_i.p)$ å°±æ˜¯é€šä¸Šç”µçš„ä¼ é€å¤±è´¥(æ³¨ï¼š$G_i.p$ æ˜¯å½“å‰è¿æ¥ $u,v$ çš„è¾¹çš„é€šç”µæ¦‚ç‡) ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è®¡ç®—çˆ¶äº²ä¼ æ¥çš„ç”µå‘¢ï¼Ÿè®¾ $g_i$ è¡¨ç¤ºç‚¹ $i$ çš„çˆ¶äº²æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ã€‚è®¡ç®—ä¸€ä¸‹çˆ¶èŠ‚ç‚¹ä¸é€šç”µçš„æ¦‚ç‡ï¼Œæ³¨æ„ä¸è¦è®¡ç®—ä¸Šè¯¥å„¿å­çš„è´¡çŒ®ï¼Œä¸ç„¶ä¼šä¹±ã€‚è®¡ç®—å®Œä¸é€šç”µçš„æ¦‚ç‡ååˆ†ä¸Šé¢ä¸¤ç§æƒ…å†µè®¨è®ºå³å¯ã€‚</p><script type="math/tex; mode=display">res=g_u\cdot f_v / (f_v+(1-f_v)\cdot(1-G_i.p))\\\\g_v=res+(1-res)\cdot(1-G_i.p)</script><p>ä¸¤è¾¹ $dfs$ å°±å¯ä»¥æå®šã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> ans,f[N],g[N],q[N];</span><br><span class="line"><span class="keyword">int</span> head[N],cnt,n,tot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to;<span class="keyword">double</span> p;&#125;G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">double</span> p)</span> </span>&#123;G[++cnt]=(Edge)&#123;head[x],y,p&#125;,head[x]=cnt;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[u]=<span class="number">1</span>-q[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u],v;i;i=G[i].nxt) </span><br><span class="line">        <span class="keyword">if</span>((v=G[i].to)!=fa)</span><br><span class="line">            dfs1(v,u),f[u]*=(f[v]+(<span class="number">1</span>-f[v])*(<span class="number">1</span>-G[i].p));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u],v;i;i=G[i].nxt) </span><br><span class="line">        <span class="keyword">if</span>((v=G[i].to)!=fa) &#123;</span><br><span class="line">            <span class="keyword">double</span> res=g[u]*f[u]/(f[v]+(<span class="number">1</span>-f[v])*(<span class="number">1</span>-G[i].p));</span><br><span class="line">            g[v]=res+(<span class="number">1</span>-res)*(<span class="number">1</span>-G[i].p);dfs2(v,u);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y,p;IN(x),IN(y),IN(p);</span><br><span class="line">        add(x,y,p/<span class="number">100.0</span>),add(y,x,p/<span class="number">100.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,x;i&lt;=n;++i) IN(x),q[i]=x/<span class="number">100.0</span>;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    g[<span class="number">1</span>]=<span class="number">1.0</span>,dfs2(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans+=<span class="number">1</span>-f[i]*g[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.6f\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¼ é€é—¨åœ¨è¿™ï¼š&lt;a href=&quot;https://loj.ac/problem/2192&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ‘æ˜¯ä¼ é€é—¨$QwQ$&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦ç®—çš„å°±æ˜¯ $\sum a_i$ (å…¶ä¸­ $a_i$ ä¸ºç‚¹ $i$ çš„é€šç”µæ¦‚ç‡) ã€‚æˆ‘ä»¬éœ€è¦ç®—å‡ºæ¯ä¸ªç‚¹çš„é€šç”µæ¦‚ç‡å³å¯ã€‚å› ä¸ºæœ‰äº›ç‚¹å¯ä»¥è‡ªå·±å‘ç”µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è€ƒè™‘çˆ¶äº²å’Œå„¿å­çš„é€šç”µæƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºç›´æ¥è®¾é€šç”µæ¦‚ç‡æœ‰äº›æ£˜æ‰‹ï¼Œæˆ‘ä»¬è®¾ $f_i$ è¡¨ç¤ºç‚¹ $i$ çš„å„¿å­æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç®—ï¼Œæˆ‘ä»¬é¡ºå¸¦ç®—ä¸Šç‚¹ $i$ è‡ªå·±å‘ç”µçš„æ¦‚ç‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2015]å¯¿å¸æ™šå®´  çŠ¶å‹DP  loj2131</title>
    <link href="http://qiulyblog.github.io/2019/05/01/%5B%E9%A2%98%E8%A7%A3%5Dloj2131/"/>
    <id>http://qiulyblog.github.io/2019/05/01/[é¢˜è§£]loj2131/</id>
    <published>2019-04-30T16:00:00.000Z</published>
    <updated>2019-05-05T01:22:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œä¸¤ä¸ªæ•°ä¸äº’è´¨åŒç†äºä¸¤ä¸ªæ•°çš„è´¨å› å­é›†åˆæ²¡æœ‰äº¤é›†ã€‚è€ƒè™‘ä¸€ä¸‹ $n\leq 30$ çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°è¿™é‡Œé¢çš„è´¨æ•°ä¹Ÿåªæœ‰ $10$ ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ¯ä¸€ä¸ªå¯¿å¸åˆ†è§£è´¨å› æ•°ï¼Œç„¶åå°†è´¨å› å­å‹æˆä¸€ä¸ªçŠ¶æ€ã€‚</p><p>è®¾ $f[s1][s2]$ è¡¨ç¤ºå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œå° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™æšä¸¾å¯¿å¸ï¼Œåˆ†åˆ«åˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦èƒ½åƒç„¶åè½¬ç§»å³å¯ã€‚</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mul=<span class="number">1024</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n,s[N];ll p,f[<span class="number">2</span>][mul][mul];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(ll&amp;x,ll&amp;y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;p)x-=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("1.in","r",stdin);</span></span><br><span class="line">    <span class="comment">// freopen("1.out","w",stdout);</span></span><br><span class="line">    IN(n),IN(p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">10</span>;++j)</span><br><span class="line">            <span class="keyword">if</span>(!(i%pri[j])) s[i]|=<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>);</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> now=i&amp;<span class="number">1</span>,lst=!now;</span><br><span class="line">        <span class="built_in">memcpy</span>(f[now],f[lst],<span class="keyword">sizeof</span>(f[lst]));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;mul;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;mul;++s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!f[lst][s1][s2]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;s[i])) pls(f[now][s1|s[i]][s2],f[lst][s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;s[i])) pls(f[now][s1][s2|s[i]],f[lst][s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;mul;++s1)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;mul;++s2) pls(ans,f[n&amp;<span class="number">1</span>][s1][s2]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>å¯ä»¥çŸ¥é“ $n\leq 500$ çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªæ•°æœ€å¤šå¸¦ä¸Šä¸€ä¸ªå¤§äºç­‰äº $23$ çš„è´¨å› å­ã€‚æˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰çš„å¯¿å¸åˆ†ä¸ºä¸¤ç±»ï¼šå¸¦äº†å¤§äºç­‰äº $23$ çš„è´¨å› å­çš„å’Œæ²¡å¸¦çš„ã€‚</p><p>æ²¡å¸¦çš„æ˜¾ç„¶å¯ä»¥å‘ä¸Šé¢é‚£æ ·è½¬ç§»ã€‚é‚£ä¹ˆå¸¦äº†çš„å‘¢ï¼Ÿè¿™ä¸ªæ˜¾ç„¶ä¸èƒ½å‹ç¼©å§ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘å°†å¸¦äº†åŒæ ·çš„å¤§äºç­‰äº $23$ çš„è´¨å› å­çš„åˆ†æˆä¸€ç»„ï¼Œè¿™ä¸€ç»„è¦ä¸å° $\rm{G}$ åƒå° $\rm{W}$ ä¸åƒï¼Œè¦ä¸å° $\rm{W}$ åƒå° $G$ ä¸åƒã€‚åˆ†åˆ«è®¨è®ºå³å¯ã€‚</p><p>è®¾ $f1[s1][s2]$ è¡¨ç¤ºè¿™ä¸€ç»„æ˜¯å° $\rm{G}$ åƒæ—¶ï¼Œå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œ å° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚åŒç†ï¼Œè®¾ $f2[s1][s2]$ è¡¨ç¤ºè¿™ä¸€ç»„æ˜¯å° $\rm{W}$ åƒæ—¶ï¼Œå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œ å° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚åˆ†åˆ«è½¬ç§»å°±å¥½äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=pos+<span class="number">1</span>;i&lt;=n;++i) &#123; <span class="comment">/*æšä¸¾è¿™äº›å¯¿å¸*/</span></span><br><span class="line">    <span class="keyword">if</span>(a[i].t!=a[i<span class="number">-1</span>].t) <span class="comment">/*å¤§è´¨å› å­ä¸åŒäº†*/</span></span><br><span class="line">        <span class="built_in">memcpy</span>(f1,f,<span class="keyword">sizeof</span>(f)),<span class="built_in">memcpy</span>(f2,f,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">        <span class="comment">/*å€’ç€æšä¸¾æ‰€ä»¥æ²¡ç”¨æ»šåŠ¨æ•°ç»„*/</span></span><br><span class="line">        <span class="comment">/*æ‰€è°“çš„åˆ†åˆ«è½¬ç§»*/</span></span><br><span class="line">        <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f1[s1|a[i].s][s2],f1[s1][s2]);</span><br><span class="line">        <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f2[s1][s2|a[i].s],f2[s1][s2]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¿™ä¸€ç»„ç»“æŸäº†ï¼Œéœ€è¦åˆå¹¶ç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">if</span>(a[i].t!=a[i+<span class="number">1</span>].t||i==n)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2)</span><br><span class="line">            <span class="comment">/*å› ä¸ºf1[s1][s2]å’Œf2[s1][s2]éƒ½é‡å¤ç®—äº†ä¸€éåŸæ¥çš„</span></span><br><span class="line"><span class="comment">            f[s1][s2]ï¼Œæ‰€ä»¥å‡æ‰åå†å–è†œ*/</span></span><br><span class="line">            f[s1][s2]=(f1[s1][s2]+f2[s1][s2]-f[s1][s2]+p)%p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M=<span class="number">256</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>&#125;;</span><br><span class="line">ll p,f[M][M],f1[M][M],f2[M][M];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span><span class="keyword">int</span> t,s;&#125;a[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Node a,Node b)</span> </span>&#123;<span class="keyword">return</span> a.t&lt;b.t;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(ll&amp;x,ll&amp;y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;=p)x%=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;IN(n),IN(p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        a[i].t=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">8</span>;++j)<span class="keyword">if</span>(!(i%pri[j])) &#123;</span><br><span class="line">            a[i].s|=<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>),a[i].t/=pri[j];</span><br><span class="line">            <span class="keyword">while</span>(!(a[i].t%pri[j])) a[i].t/=pri[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    sort(a+<span class="number">2</span>,a+n+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">int</span> pos=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span>(a[pos].t==<span class="number">1</span>) ++pos;--pos;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=pos;++i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f[s1|a[i].s][s2],f[s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f[s1][s2|a[i].s],f[s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=pos+<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i].t!=a[i<span class="number">-1</span>].t)</span><br><span class="line">            <span class="built_in">memcpy</span>(f1,f,<span class="keyword">sizeof</span>(f)),<span class="built_in">memcpy</span>(f2,f,<span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f1[s1|a[i].s][s2],f1[s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f2[s1][s2|a[i].s],f2[s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a[i].t!=a[i+<span class="number">1</span>].t||i==n)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2)</span><br><span class="line">                f[s1][s2]=(f1[s1][s2]+f2[s1][s2]-f[s1][s2]+p)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2) pls(ans,f[s1][s2]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(ans+p)%p);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¦–å…ˆï¼Œä¸¤ä¸ªæ•°ä¸äº’è´¨åŒç†äºä¸¤ä¸ªæ•°çš„è´¨å› å­é›†åˆæ²¡æœ‰äº¤é›†ã€‚è€ƒè™‘ä¸€ä¸‹ $n\leq 30$ çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°è¿™é‡Œé¢çš„è´¨æ•°ä¹Ÿåªæœ‰ $10$ ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ¯ä¸€ä¸ªå¯¿å¸åˆ†è§£è´¨å› æ•°ï¼Œç„¶åå°†è´¨å› å­å‹æˆä¸€ä¸ªçŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f[s1][s2]$ è¡¨ç¤ºå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œå° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™æšä¸¾å¯¿å¸ï¼Œåˆ†åˆ«åˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦èƒ½åƒç„¶åè½¬ç§»å³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çŠ¶æ€å‹ç¼©" scheme="http://qiulyblog.github.io/tags/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [JSOI2016]ç¯å¡”  å†³ç­–å•è°ƒæ€§&amp;DP  loj2074</title>
    <link href="http://qiulyblog.github.io/2019/04/30/%5B%E9%A2%98%E8%A7%A3%5Dloj2047/"/>
    <id>http://qiulyblog.github.io/2019/04/30/[é¢˜è§£]loj2047/</id>
    <published>2019-04-29T16:00:00.000Z</published>
    <updated>2019-05-05T01:22:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®è¿™é“é¢˜æ˜¯ $\rm{POI}$ çš„åŸé¢˜ï¼Œ$loj$ ä¼ é€é—¨é“¾æ¥ï¼š<a href="https://loj.ac/problem/2074" target="_blank" rel="noopener">åœ¨è¿™å‘¢o(ï¿£ï¸¶ï¿£)o</a></p><p>åˆšå¼€å§‹è‚¯å®šè¿˜æ˜¯çœ‹ä¸å‡ºè¿™é¢˜æ˜¯ä»€ä¹ˆ $\rm{DP}$ ï¼Œæ„Ÿè§‰å¾ˆè¯¡å¼‚ï¼Œä½†æ˜¯æ¨ä¸€æ¨è‡ªç„¶å°±å‡ºæ¥äº†ï¼š</p><script type="math/tex; mode=display">h_j \leq h_i+p-\sqrt{|iâˆ’j|}\\\\p\geq h_j-h_i +\sqrt{|iâˆ’j|}\\\\p=\max\{ h_j-h_i +\sqrt{|iâˆ’j|}\}</script><p>è®¾ $f_i$ è¡¨ç¤º $i$ çš„ $p$ å€¼ï¼Œé‚£ä¹ˆç»§ç»­ï¼š</p><a id="more"></a><script type="math/tex; mode=display">f_i=\max\{ h_j +\sqrt{|iâˆ’j|}\}-h_i</script><p>å‘ç°ç»å¯¹å€¼å¾ˆçƒ¦äººï¼Œå°†ç»å¯¹å€¼æ‹†å¼€ã€‚</p><script type="math/tex; mode=display">f_i=\max(\max\limits_{j=1}^{i}\{h_j +\sqrt{iâˆ’j}\},\max\limits_{j=i}^{n}\{h_j +\sqrt{j-i}\})-h_i</script><p>åŸåºåˆ—ç¿»è½¬ä¸€ä¸‹å°±å¯ä»¥ç›´æ¥è®¡ç®—åé¢çš„å¼å­ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦è€ƒè™‘ç¬¬ä¸€ä¸ªï¼š</p><script type="math/tex; mode=display">f_i=\max\limits_{j=1}^{i}\{h_j +\sqrt{iâˆ’j}\}-h_i</script><p>å‡è®¾å¯¹äº $i$ æ¥è¯´ $j$ æ˜¯æœ€ä¼˜çš„å†³ç­–ï¼Œé‚£ä¹ˆå¦‚æœå­˜åœ¨ä¸€ä¸ªå°äº $j$ çš„ $k$ ï¼Œæ˜¯å¦åœ¨è½¬ç§»ä¸€ä¸ªå¤§äº $i$ çš„ $l$ ä¼šæ›´ä¼˜å‘¢ï¼Ÿæ˜¾ç„¶ä¸ä¼šï¼Œå¯ä»¥çŸ¥é“ $i-k$ æ˜¾ç„¶æ˜¯å¤§äº $i-j$ çš„ï¼Œè€Œä¸”æ ¹å·æ˜¯å¢é•¿çš„è¶Šæ¥è¶Šæ…¢çš„ã€‚æ‰€ä»¥å¦‚æœåœ¨ $i$ æ—¶ $k$ å°±æ²¡æœ‰ $j$ ä¼˜äº†ï¼Œé‚£ä¹ˆåœ¨ä»¥åæ‰€ä»¥å¤§äº $i$ çš„ $l$ è½¬ç§»æ—¶ $k$ ä¹Ÿä¸å¯èƒ½æ¯” $j$ ä¼˜ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ä¸Šé¢çš„å¼å­æ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ $O(n\log n)$ æ„‰å¿«æ±‚å‡ºäº†ã€‚</p><p>è¿™é‡Œè¯´æ˜ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ul><li><strong>1.</strong> å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸‰å…ƒç»„ï¼Œä¸‰å…ƒç»„åŒ…å« $v$ (å†³ç­–ç‚¹ $v$) ï¼Œ$l$ (å†³ç­–ç‚¹ $v$ ä½œä¸ºæœ€ä¼˜å†³ç­–ç‚¹çš„æœ€å·¦ç«¯ç‚¹) ï¼Œ$r$ (å†³ç­–ç‚¹ $v$ ä½œä¸ºæœ€ä¼˜å†³ç­–ç‚¹çš„æœ€å³ç«¯ç‚¹) ï¼Œæ¯ä¸€æ¬¡æ’é™¤æ‰æœ€å³ç«¯ç‚¹å°äº $i$ çš„å…ƒç´ (å› ä¸ºè¯¥å…ƒç´ å·²ç»æ²¡ç”¨äº†) ï¼Œæ’å…¥é˜Ÿåˆ—çš„æ—¶å€™å»æ‰å®Œå…¨åŠ£äº $i$ çš„ï¼Œç„¶åå¯¹äºæŠ˜ä¸­çš„äºŒåˆ†å³å¯ã€‚(å…·ä½“å‚è§è¯—äººå° $\rm{G}$ çš„é¢˜è§£) ã€‚</li><li><strong>2.</strong> åˆ†æ²»è®¡ç®—ç­”æ¡ˆã€‚è®¾ $slove(al,ar,vl,vr)$ è¡¨ç¤ºåœ¨åŸæ•°ç»„ $al$ åˆ° $ar$ è¿™æ®µåŒºé—´çš„æœ€ä¼˜å†³ç­–ç‚¹ä½äº $vl$ åˆ° $vr$ åŒºé—´ã€‚æˆ‘ä»¬æ¯ä¸€æ¬¡æ‰¾åˆ° $al$ åˆ° $ar$ çš„ä¸­é—´ç‚¹ï¼Œä¹Ÿå°±æ˜¯ $mid$ ï¼Œç„¶ååœ¨ $vl$ åˆ° $vr$ å¯»æ‰¾æœ€ä¼˜çš„å†³ç­–ç‚¹æ›´æ–° $f_{mid}$ ( $\rm{DP}$ æ•°ç»„)ï¼Œè®¾è¿™ä¸ªæœ€ä¼˜ç‚¹ä¸º $g$ ã€‚å› ä¸ºæ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œ$al$ åˆ° $mid-1$ çš„æ‰€æœ‰ç‚¹çš„æœ€ä¼˜å†³ç­–ç‚¹ä¸€å®šåœ¨ $vl$ åˆ° $g$ ä¹‹é—´ï¼Œå³è¾¹ $mid+1$ åˆ° $ar$ çš„ä¹ŸåŒç†ï¼Œå°±è¿™ä¹ˆåˆ†æ²»ä¸‹å»å³å¯ã€‚</li></ul><p>å®é™…è¿ç”¨ä¸­åˆ†æ²»çš„æ•ˆç‡ä¸å¦‚ä¸‰å…ƒç»„ï¼Œä½†æ˜¯ä»£ç å´å¥½å†™å¾—å¤šï¼Œå¾ˆçŸ­ï¼Œå¹¶ä¸”è°ƒè¯•éš¾åº¦ä¹Ÿå¤§å¤§é™ä½ï¼Œæ‰€ä»¥æœ€ç»ˆæˆ‘é€‰æ‹©äº†åˆ†æ²»â€¦â€¦åˆ†æ²»çš„å…·ä½“ç»†èŠ‚çœ‹ä»£ç ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">6e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;ll a[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">double</span> f1[N],f2[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_f1</span><span class="params">(<span class="keyword">int</span> al,<span class="keyword">int</span> ar,<span class="keyword">int</span> vl,<span class="keyword">int</span> vr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(al&gt;ar) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(al+ar)&gt;&gt;<span class="number">1</span>,g=<span class="number">0</span>;</span><br><span class="line">    f1[mid]=a[mid];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=vl;i&lt;=min(vr,mid);++i) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> calc=a[i]+<span class="built_in">sqrt</span>(<span class="keyword">double</span>(mid-i));</span><br><span class="line">        <span class="keyword">if</span>(calc&gt;f1[mid]) f1[mid]=calc,g=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!g) g=mid;f1[mid]-=a[mid];</span><br><span class="line">    solve_f1(al,mid<span class="number">-1</span>,vl,g),solve_f1(mid+<span class="number">1</span>,ar,g,vr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_f2</span><span class="params">(<span class="keyword">int</span> al,<span class="keyword">int</span> ar,<span class="keyword">int</span> vl,<span class="keyword">int</span> vr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(al&gt;ar) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(al+ar)&gt;&gt;<span class="number">1</span>,g=<span class="number">0</span>;</span><br><span class="line">    f2[mid]=a[mid];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=vr;i&gt;=max(vl,mid);--i) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> calc=a[i]+<span class="built_in">sqrt</span>(<span class="keyword">double</span>(i-mid));</span><br><span class="line">        <span class="keyword">if</span>(calc&gt;f2[mid]) f2[mid]=calc,g=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!g) g=mid;f2[mid]-=a[mid];</span><br><span class="line">    solve_f2(al,mid<span class="number">-1</span>,vl,g),solve_f2(mid+<span class="number">1</span>,ar,g,vr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    solve_f1(<span class="number">1</span>,n,<span class="number">1</span>,n),solve_f2(<span class="number">1</span>,n,<span class="number">1</span>,n);</span><br><span class="line">    <span class="comment">/*æœ€ç»ˆæ²¡æœ‰ç¿»è½¬åºåˆ—ï¼Œè€Œæ˜¯é€‰æ‹©åšä¸¤éåˆ†æ²»*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(ll)<span class="built_in">ceil</span>(max(f1[i],f2[i])));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®è¿™é“é¢˜æ˜¯ $\rm{POI}$ çš„åŸé¢˜ï¼Œ$loj$ ä¼ é€é—¨é“¾æ¥ï¼š&lt;a href=&quot;https://loj.ac/problem/2074&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åœ¨è¿™å‘¢o(ï¿£ï¸¶ï¿£)o&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹è‚¯å®šè¿˜æ˜¯çœ‹ä¸å‡ºè¿™é¢˜æ˜¯ä»€ä¹ˆ $\rm{DP}$ ï¼Œæ„Ÿè§‰å¾ˆè¯¡å¼‚ï¼Œä½†æ˜¯æ¨ä¸€æ¨è‡ªç„¶å°±å‡ºæ¥äº†ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;h_j \leq h_i+p-\sqrt{|iâˆ’j|}\\\\p\geq h_j-h_i +\sqrt{|iâˆ’j|}\\\\p=\max\{ h_j-h_i +\sqrt{|iâˆ’j|}\}&lt;/script&gt;&lt;p&gt;è®¾ $f_i$ è¡¨ç¤º $i$ çš„ $p$ å€¼ï¼Œé‚£ä¹ˆç»§ç»­ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
      <category term="åˆ†æ²»" scheme="http://qiulyblog.github.io/tags/%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2016]å›½ç‹é¥®æ°´è®°  æ–œç‡ä¼˜åŒ–DP  loj2087</title>
    <link href="http://qiulyblog.github.io/2019/04/29/%5B%E9%A2%98%E8%A7%A3%5Dloj2087/"/>
    <id>http://qiulyblog.github.io/2019/04/29/[é¢˜è§£]loj2087/</id>
    <published>2019-04-28T16:00:00.000Z</published>
    <updated>2019-04-29T13:20:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¯çˆ±çš„é¢˜ç›®ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2087" target="_blank" rel="noopener">æˆ³æˆ‘æˆ³æˆ‘Â·(<em>â•¹â–½â•¹</em>)Â·</a></p><p>è¯´å®è¯è¿™é“é¢˜å¦‚æœå•çœ‹æ–œç‡ä¼˜åŒ– $\texttt{DP}$ ï¼Œä½†æ˜¯å¦‚æœæ²¡çŒœåˆ°é‚£ä¹ˆå¤šç»“è®ºï¼Œä½ æ˜¯æ€ä¹ˆä¹Ÿæƒ³ä¸åˆ°â€æ–œç‡ä¼˜åŒ–â€æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹çŒœç»“è®ºå§â€¦â€¦</p><ul><li><strong>1.</strong> åˆå§‹æ°´ä½å°äº $h_1$ çš„æ²¡æœ‰ç”¨ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ã€‚</p><a id="more"></a><ul><li><strong>2.</strong> å¦‚æœ $n\leq k$ ï¼Œé‚£ä¹ˆåªéœ€è¦å°†æ‰€ä»¥å¤§äº $h_1$ çš„è·Ÿ $1$ åŸå¸‚è¿å°±å¥½äº†ã€‚</li></ul><p>æ¯æ¬¡è¿æ¥çš„åŸå¸‚æ•°è¶Šå°‘è´¡çŒ®è¶Šå¤§ï¼Œé‚£ä¹ˆæ¯ä¸ªé€ä¸€è¿ä¸€æ¬¡ä¸€å®šæ˜¯æœ€ä¼˜æ–¹æ¡ˆã€‚</p><ul><li><strong>3.</strong> æ¯æ¬¡æ“ä½œå¿…ç„¶è·Ÿ $1$ åŸå¸‚æœ‰å…³ç³»ã€‚</li></ul><p>ä¸ç„¶æ²¡è´¡çŒ®ã€‚</p><ul><li><strong>4.</strong> é™¤äº† $1$ å·åŸå¸‚ï¼Œå…¶ä»–æ¯ä¸ªåŸå¸‚æœ€å¤šè¿ä¸€æ¬¡ã€‚</li></ul><p>å› ä¸ºè¿è¿‡ä¸€æ¬¡çš„åŸå¸‚çš„æ°´ä½å·²ç»å’Œ $1$ åŸå¸‚ä¸€æ ·äº†ï¼Œç®€å•ç‚¹è¯´è‚¯å®šå°±æ˜¯åºŸäº†ã€‚</p><ul><li><strong>5.</strong> æ¯æ¬¡è¿çš„æ‰€æœ‰åŸå¸‚ä¸­æœ€å°çš„ $h_i$ å¿…ç„¶å¤§äºä¸Šä¸€æ¬¡é“¾æ¥çš„æœ€å¤§çš„ $h_i$ ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ï¼Œä¸ç„¶ä¸æ»¡è¶³æœ€ä¼˜æ–¹æ¡ˆã€‚</p><ul><li><strong>6.</strong> å°†æ‰€ä»¥åŸå¸‚æŒ‰æ°´ä½æ’åºåï¼Œæ¯æ¬¡é€‰æ‹©çš„å¿…ç„¶æ˜¯è¿ç»­ä¸€æ®µåŒºé—´ã€‚</li></ul><p>å’Œä¸Šä¸€ä¸ªå·®ä¸å¤šã€‚</p><ul><li><strong>7.</strong> æ¯æ¬¡é€‰æ‹©çš„åŒºé—´å¿…ç„¶å’Œä¸Šä¸€æ¬¡çš„é€‰æ‹©åŒºé—´æ¥è§¦ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ã€‚</p><ul><li><strong>8.</strong> æ¯æ¬¡é€‰æ‹©çš„åŒºé—´çš„é•¿åº¦å¿…å®šå•è°ƒä¸å¢ã€‚</li></ul><p>æ»¡è¶³æœ€ä¼˜ï¼Œéƒ½è¯´äº†æ¯æ¬¡è¿æ¥çš„åŸå¸‚è¶Šå°‘è´¡çŒ®è¶Šå¤§ã€‚</p><hr><p>é‚£ä¹ˆæ˜¾ç„¶å°±å˜æˆäº†ä¸€ä¸ªåŒºé—´é—®é¢˜äº†ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªåŒºé—´åˆ†æˆè‹¥å¹²å—ã€‚</p><p>è®¾ $f_{i,j}$ è¡¨ç¤ºæ’åºåå‰ $i$ ä¸ªåŸå¸‚è”é€šäº† $j$ æ¬¡å $1$ å·åŸå¸‚çš„æœ€å¤§æ°´ä½é«˜åº¦ã€‚é‚£ä¹ˆè½¬ç§»ç›´æ¥æšä¸¾ä¸€ä¸ª $k$ ï¼Œåœ¨æ–°çš„ä¸€æ¬¡è¿æ¥ä¸­è¿æ¥äº† $k+1$ åˆ° $i$ è¿™äº›åŸå¸‚ã€‚è½¬ç§»æ–¹ç¨‹æ˜¾ç„¶ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\frac{f_{k,j-1}+(s_i-s_k)}{i-k+1}</script><p>*æ³¨ï¼š$s_i$ ä¸ºå‰ç¼€å’Œã€‚</p><p>ä¸Šå¼çš„å¤æ‚åº¦ä¸º $O(n^2k)$  ï¼Œè‚¯å®šçˆ†ç‚¸ã€‚ä½†æ˜¯è¿™ä¸ªæ˜¯å¯ä»¥<strong>æ–œç‡ä¼˜åŒ–</strong>çš„ï¼š</p><script type="math/tex; mode=display">\frac{f_{k,j-1}+(s_i-s_k)}{i-k+1} =\frac{s_i-(s_k-f_{k,j-1})}{i-(k-1)}\Rightarrow \frac{Y(i)-Y(k)}{X(i)-X(k)}</script><p>ç„¶åé€šè¿‡ç¬¬ $8$ æ¡æ€§è´¨å¯ä»¥å¾—çŸ¥ $\texttt{DP}$ æ˜¯æœ‰<strong>å†³ç­–å•è°ƒæ€§</strong>çš„ï¼Œæ•…å¤æ‚åº¦ä¸º $O(nk)$ ã€‚å› ä¸ºæ¶å¿ƒçš„é«˜ç²¾åº¦å°æ•°çš„è¿ç®—è¿˜éœ€è¦ $O(p)$ çš„å¤æ‚åº¦ï¼Œæ‰€ä»¥æœ€ç»ˆæ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(nkp)$ ã€‚</p><p>æˆ‘ä»¬å‘ç° $k$ æœ‰ $10^9$ ï¼Œæ‰€ä»¥å¤æ‚åº¦å¸¦ $k$ çš„ä¸€å®šå‡æ‰äº†ã€‚</p><p>é‚£ä¹ˆè§‚å¯Ÿç¬¬ $2$ æ¡æ€§è´¨ä¼šå‘ç°ï¼Œå¦‚æœ $k$ å¤§äº $n$ äº†ç›´æ¥å°† $k$ è®¾ä¸º $n$ å°±å¥½äº†ã€‚ä¹Ÿå°±æ˜¯è¯´å¤æ‚åº¦åº”è¯¥ä¸º $O(n^2p)$ ï¼Œè¿™æ ·å°±æ˜¯ $86$ åˆ†ï¼Œé€šè¿‡æ•°æ®æ¥çœ‹ä¼šå‘ç°è¿™ä¸ªå€¾å‘äºå¤§ä¼—åˆ†ï¼Œä¸€è½¦å¢çš„äººéƒ½æ˜¯è¿™ä¸ªåˆ†æ•°ã€‚</p><p>é‚£ä¹ˆå¦‚æœæƒ³è¦ $\texttt{AC}$ çš„è¯éœ€è¦æœ€åä¸€æ¡å¾ˆè¿·çš„æ€§è´¨ï¼š</p><ul><li><strong>9.</strong> å› ä¸º $h$ å„ä¸åŒï¼Œé€‰æ‹©çš„åŒºé—´æœ€å¤šåªæœ‰ $14$ ä¸ªåŒºé—´é•¿åº¦å¤§äº $1$ ï¼Œå…¶ä»–çš„åŒºé—´å‡ç­‰äº $1$ ã€‚</li></ul><p>å¾ˆè¿·ï¼Œå‡†ç¡®çš„è¯´è¿™æ ·çš„åŒºé—´æ˜¯ $O(\log\frac{nh}{\min_i\{h_i-h_{i-1}\}})$ ä¸ªã€‚</p><p>è¯æ˜ä¸ä¼šâ€¦â€¦ä½†æ˜¯è¿™é‡Œå†™äº†è¯æ˜(å”¯ä¸€çš„ä¸”å¾ˆè¿·çš„è¯æ˜)ï¼š<a href="https://github.com/qiulyblog/image/blob/master/[NOI2016]%E5%9B%BD%E7%8E%8B%E9%A5%AE%E6%B0%B4%E8%AE%B0%E9%A2%98%E8%A7%A3.pdf?raw=true" target="_blank" rel="noopener">å“ˆå“ˆæˆ‘æ˜¯ä¼ é€é—¨O(âˆ©_âˆ©)O</a></p><p>é‚£ä¹ˆå°±ä¸¢ä»£ç äº†ï¼Œå®é™…ä¸Šæ˜¯éœ€è¦é«˜ç²¾å°æ•°çš„ï¼Œè¿™é‡Œå…ˆç»™å‡ºä¸€ä¸ªé™¤å»é«˜ç²¾å°æ•°æ¿å­çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">8e3</span>+<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">Decimal ans;</span><br><span class="line"><span class="keyword">int</span> n,k,p,lim,h[N],s[N],pre[N][<span class="number">16</span>],tot;</span><br><span class="line"><span class="keyword">int</span> q[N],head,tail;</span><br><span class="line"><span class="keyword">double</span> f[N][<span class="number">16</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span>&#123;</span><span class="keyword">double</span> x,y;&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(point a,point b)</span> </span>&#123;<span class="keyword">return</span> (a.y-b.y)/(a.x-b.x);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Decimal <span class="title">solve</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!j) <span class="keyword">return</span> h[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> (solve(pre[i][j],j<span class="number">-1</span>)+s[i]-s[pre[i][j]])/(i-pre[i][j]+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;k,&amp;p,&amp;h[tot=<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d\n"</span>,&amp;h[i]);</span><br><span class="line">        <span class="keyword">if</span>(h[i]&gt;h[<span class="number">1</span>]) h[++tot]=h[i];</span><br><span class="line">    &#125;</span><br><span class="line">    n=tot;sort(&amp;h[<span class="number">1</span>],&amp;h[n+<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][<span class="number">0</span>]=h[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]=s[i<span class="number">-1</span>]+h[i];</span><br><span class="line">    k=min(k,n),lim=min(k,<span class="number">14</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=lim;++j) &#123;</span><br><span class="line">        q[head=tail=<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) t[i]=(point)&#123;i<span class="number">-1</span>,s[i]-f[i][j<span class="number">-1</span>]&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            point now=(point)&#123;i,s[i]&#125;;</span><br><span class="line">            <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(now,t[q[head]])&lt;slope(now,t[q[head+<span class="number">1</span>]])) ++head;</span><br><span class="line">            f[i][j]=(f[q[head]][j<span class="number">-1</span>]+s[i]-s[q[head]])/(i-q[head]+<span class="number">1</span>);</span><br><span class="line">            pre[i][j]=q[head];</span><br><span class="line">            <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(t[q[tail]],t[q[tail<span class="number">-1</span>]])&gt;slope(t[q[tail]],t[i])) --tail;</span><br><span class="line">            q[++tail]=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m=n-k+lim,pos;</span><br><span class="line">    <span class="keyword">double</span> mx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=lim;++i) </span><br><span class="line">        <span class="keyword">if</span>(f[m][i]&gt;mx) mx=f[m][i],pos=i;</span><br><span class="line">    ans=solve(m,pos);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=m+<span class="number">1</span>;i&lt;=n;++i) ans=(ans+h[i])/<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans.to_string(p&lt;&lt;<span class="number">1</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆé«˜ç²¾åº¦å°æ•°æ¿å­çš„ä¸‹è½½é“¾æ¥å°±è´´è¿™äº†ï¼š<a href="https://loj.ac/problem/2087/download/additional_file" target="_blank" rel="noopener">$loj$ çš„ä¸‹è½½åœ°å€ä¼ é€ä»¬(ï½ï¿£â–½ï¿£)ï½</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯çˆ±çš„é¢˜ç›®ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2087&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ³æˆ‘æˆ³æˆ‘Â·(&lt;em&gt;â•¹â–½â•¹&lt;/em&gt;)Â·&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯´å®è¯è¿™é“é¢˜å¦‚æœå•çœ‹æ–œç‡ä¼˜åŒ– $\texttt{DP}$ ï¼Œä½†æ˜¯å¦‚æœæ²¡çŒœåˆ°é‚£ä¹ˆå¤šç»“è®ºï¼Œä½ æ˜¯æ€ä¹ˆä¹Ÿæƒ³ä¸åˆ°â€æ–œç‡ä¼˜åŒ–â€æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹çŒœç»“è®ºå§â€¦â€¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;1.&lt;/strong&gt; åˆå§‹æ°´ä½å°äº $h_1$ çš„æ²¡æœ‰ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™å¾ˆæ˜¾ç„¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç®—æ³•ã€‘ å°è°ˆæ–œç‡ä¼˜åŒ–</title>
    <link href="http://qiulyblog.github.io/2019/04/28/%5B%E7%AE%97%E6%B3%95%5D%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    <id>http://qiulyblog.github.io/2019/04/28/[ç®—æ³•]æ–œç‡ä¼˜åŒ–/</id>
    <published>2019-04-27T16:00:00.000Z</published>
    <updated>2019-05-06T05:42:53.964Z</updated>
    
    <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="å†æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡" />    <label for="pass">å†æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡ä¸ºåŠ å¯†æ–‡ç« ï¼Œé˜…è¯»æœ¬æ–‡éœ€è¦è¾“å…¥å¯†ç ã€‚
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="ç®—æ³•" scheme="http://qiulyblog.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2015]äºšç‘Ÿç‹  æ¦‚ç‡DP  loj2112</title>
    <link href="http://qiulyblog.github.io/2019/04/28/%5B%E9%A2%98%E8%A7%A3%5Dloj2112/"/>
    <id>http://qiulyblog.github.io/2019/04/28/[é¢˜è§£]loj2112/</id>
    <published>2019-04-27T16:00:00.000Z</published>
    <updated>2019-04-29T13:18:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‘ç° <a href="https://loj.ac" target="_blank" rel="noopener">$loj$</a> çœŸçš„å¥½ç”¨â€¦â€¦æ¯” $luogu$ ä¸çŸ¥é“æ¸…çˆ½åˆ°å“ªé‡Œå»äº†ï¼Œæ›´ä½•å†µ $loj$ çš„é¢˜ç›®ä¹Ÿæ›´å¤šï¼Œè€Œä¸”æä¾›æ•°æ®å’Œä»£ç ï¼Œæ›´åŠ å¼€æ”¾ã€‚ä¼°è®¡ä»¥åéƒ½ä¼šåœ¨ $loj$ ä¸Šå¤šé€›é€›ã€‚( $bzoj$ æ˜¯çœŸçš„ä¸‘ï¼Œé™¤éæ˜¯åš $bzoj$ çš„åŸåˆ›é¢˜ä¸ç„¶æˆ‘ä¸ä¼šä¸Š $bzoj$ çš„) ã€‚</p><p>é¡ºä¾¿è´´ä¸€ä¸‹é¢˜ç›®ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2112" target="_blank" rel="noopener">$loj$çš„ä¼ é€é—¨å°±æˆ³æˆ‘å•¦(ï½ï¿£â–½ï¿£)ï½</a></p><p>æ¦‚ç‡ $\texttt{DP}$ ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºæ‰“äº†å‰ $i$ å¼ ç‰Œï¼Œè¿˜æœ‰ $j$ è½®æ²¡æœ‰æ‰“å‡ºç‰Œçš„æ¦‚ç‡ã€‚æˆ‘ä»¬æšä¸¾ç¬¬ $i+1$ å¼ ç‰Œï¼Œåˆ†åˆ«è®¨è®ºä¸€ä¸‹è¯¥ç‰Œæ‰“å‡ºä¸ä¸æ‰“å‡ºçš„æƒ…å†µå³å¯ã€‚</p><a id="more"></a><p>ç¬¬ä¸€ç§æƒ…å†µï¼š$j$ è½®ä¸­éƒ½æ²¡æœ‰æ‰“å‡ºç¬¬ $i+1$ å¼ ç‰Œï¼Œç”±äºä¸€è½®ä¸­ä¸æ‰“å‡ºç¬¬ $i+1$ å¼ ç‰Œçš„æ¦‚ç‡ä¸º $1-p_i$ ï¼Œé‚£ä¹ˆ $j$ è½®éƒ½ä¸æ‰“å‡ºè¯¥ç‰Œçš„æ¦‚ç‡æ˜¾ç„¶ä¸º $(1-p_i)^j$ ã€‚è½¬ç§»æ–¹ç¨‹æ˜¾ç„¶ï¼š</p><script type="math/tex; mode=display">f_{i+1,j}+=f_{i,j}\cdot (1-p_i)^jâ€‹</script><p>å› ä¸º $f_{i+1,j}$ å¯èƒ½ä»å¤šæ–¹å‘è½¬ç§»è¿‡æ¥ï¼Œæ‰€ä»¥æ˜¯ $+=$ ã€‚</p><p>ç¬¬äºŒç§æƒ…å†µï¼š$j$ è½®ä¸­è‡³å°‘æœ‰ä¸€è½®æ‰“å‡ºäº†ç¬¬ $i+1$ å¼ ç‰Œï¼Œæ¦‚ç‡æ˜¾ç„¶ä¸º $1-(1-p_i)^j$ ï¼Œè½¬ç§»ä¹Ÿå°±å¾ˆæ˜¾ç„¶äº†ï¼š</p><script type="math/tex; mode=display">f_{i+1,j-1}+=f_{i,j}\cdot ï¼ˆ1-(1-p_i)^jï¼‰</script><p>å¦‚æœæˆ‘ä»¬æ‰“å‡ºäº†ç¬¬ $i+1$ å¼ ç‰Œï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯è¦è®¡ç®—è´¡çŒ®çš„ï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥ç”¨è¿™ä¸ªæ¦‚ç‡ç®—è´¡çŒ®å°±å¥½äº†ã€‚</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> T,n,r,d[N];</span><br><span class="line"><span class="keyword">double</span> f[N][N],p[N],pw[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;r);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%lf%d"</span>,&amp;p[i],&amp;d[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            pw[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=r;++j) pw[i][j]=pw[i][j<span class="number">-1</span>]*(<span class="number">1</span>-p[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        f[<span class="number">0</span>][r]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=r;++j) &#123;</span><br><span class="line">                f[i+<span class="number">1</span>][j]+=f[i][j]*pw[i+<span class="number">1</span>][j];</span><br><span class="line">                <span class="keyword">if</span>(j) &#123;</span><br><span class="line">                    <span class="keyword">double</span> calc=f[i][j]*(<span class="number">1</span>-pw[i+<span class="number">1</span>][j]);</span><br><span class="line">                    f[i+<span class="number">1</span>][j<span class="number">-1</span>]+=calc,ans+=calc*d[i+<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.10f\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç° &lt;a href=&quot;https://loj.ac&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;$loj$&lt;/a&gt; çœŸçš„å¥½ç”¨â€¦â€¦æ¯” $luogu$ ä¸çŸ¥é“æ¸…çˆ½åˆ°å“ªé‡Œå»äº†ï¼Œæ›´ä½•å†µ $loj$ çš„é¢˜ç›®ä¹Ÿæ›´å¤šï¼Œè€Œä¸”æä¾›æ•°æ®å’Œä»£ç ï¼Œæ›´åŠ å¼€æ”¾ã€‚ä¼°è®¡ä»¥åéƒ½ä¼šåœ¨ $loj$ ä¸Šå¤šé€›é€›ã€‚( $bzoj$ æ˜¯çœŸçš„ä¸‘ï¼Œé™¤éæ˜¯åš $bzoj$ çš„åŸåˆ›é¢˜ä¸ç„¶æˆ‘ä¸ä¼šä¸Š $bzoj$ çš„) ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºä¾¿è´´ä¸€ä¸‹é¢˜ç›®ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2112&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;$loj$çš„ä¼ é€é—¨å°±æˆ³æˆ‘å•¦(ï½ï¿£â–½ï¿£)ï½&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¦‚ç‡ $\texttt{DP}$ ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºæ‰“äº†å‰ $i$ å¼ ç‰Œï¼Œè¿˜æœ‰ $j$ è½®æ²¡æœ‰æ‰“å‡ºç‰Œçš„æ¦‚ç‡ã€‚æˆ‘ä»¬æšä¸¾ç¬¬ $i+1$ å¼ ç‰Œï¼Œåˆ†åˆ«è®¨è®ºä¸€ä¸‹è¯¥ç‰Œæ‰“å‡ºä¸ä¸æ‰“å‡ºçš„æƒ…å†µå³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [CEOI2017]Building Bridges æ–œç‡ä¼˜åŒ–DP loj2483</title>
    <link href="http://qiulyblog.github.io/2019/04/27/%5B%E9%A2%98%E8%A7%A3%5Dloj2483/"/>
    <id>http://qiulyblog.github.io/2019/04/27/[é¢˜è§£]loj2483/</id>
    <published>2019-04-26T16:00:00.000Z</published>
    <updated>2019-04-29T13:17:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ„‰å¿«çš„æ¨å¼å­å§(ï¾‰â‰§âˆ€â‰¦)ï¾‰ï¼</p><p>è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ æ ¹æŸ±å­å®Œå·¥åçš„æœ€å°ä»£ä»·ã€‚æšä¸¾ä¸€ä¸ªå°äº $i$ çš„ $j$ ï¼Œè¡¨ç¤ºä¸ºä» $j$ å‘ $i$ è¿äº†ä¸€åº§æ¡¥ï¼Œä¸­é—´çš„æŸ±å­å½“ç„¶å…¨éƒ¨æ¨æ‰ï¼Œè®¡ç®—ä¸€ä¸‹å°±å¥½ï¼š</p><script type="math/tex; mode=display">f_i=\min\{f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\}</script><p>*å…¶ä¸­ $s$ ä¸º $w$ çš„å‰ç¼€å’Œã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\\\\f_i=f_j+s_{i-1}-s_j+h_i^2+h_j^2-2h_ih_j\\\\f_j+s_{i-1}-s_j+h_i^2+h_j^2=2h_ih_j+f_i</script><p>äºæ˜¯æœ€ç»ˆå¼å­å˜æˆäº† $y=kx+b$ çš„å½¢å¼ï¼Œæ–œç‡ä¼˜åŒ–ï¼</p><p>ä½†æ˜¯â€¦â€¦æ³¨æ„è¿™ä¸ªå¼å­çš„ $k$ ä¸æ˜¯å•è°ƒé€’å¢çš„ï¼Œå¹¶ä¸” $x$ ä¹Ÿä¸æ˜¯å•è°ƒé€’å¢çš„ï¼é‚£ä¹ˆæˆ‘ä»¬ä¸èƒ½ç”¨æœ´ç´ åšæ³•äº†ï¼Œä¹Ÿä¸èƒ½ç”¨äºŒåˆ†â€¦â€¦éš¾é“ç”¨ $Splay$ ï¼Ÿ(ç é‡å·¨å¤§) ã€‚</p><p>ä¸ï¼Œç”¨ $CDQ$ åˆ†æ²»ã€‚</p><p>å¯¹äºä¸€ä¸ª $i$ ï¼Œå¯èƒ½å¯ä»¥å¯¹ $i$ åšå‡ºè´¡çŒ®çš„åªæœ‰æ‰€æœ‰å°äº $i$ çš„ $j$ ã€‚ä¸ºäº†ä¿è¯ $x$ å•è°ƒæˆ‘ä»¬å…ˆå¤§åŠ›å°†åŸæ¥çš„æ•°ç»„æŒ‰ç…§ $x$ ä»å°åˆ°å¤§æ’ä¸ªåºï¼Œç„¶å $CDQ$ çš„æ—¶å€™åˆ†å·¦å³ä¸¤è¾¹ï¼Œå·¦è¾¹çš„æ‰€æœ‰å…ƒç´ åœ¨åˆå§‹æ•°ç»„çš„ä½ç½®éƒ½å°äºå³è¾¹çš„å·¦å³å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç›´æ¥ç”¨å·¦è¾¹å…ƒç´ å¯¹å³è¾¹å…ƒç´ åšå‡ºè´¡çŒ®ã€‚</p><p>åŒæ—¶è¿™é‡Œä¹Ÿä¿è¯äº†å·¦å³ä¸¤è¾¹çš„ $x$ ä¸€å®šæ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ï¼Œæ‰«ä¸€éå·¦è¾¹çš„å…ƒç´ ï¼Œç•™ä¸‹èƒ½åšè´¡çŒ®çš„ç‚¹(ä¸‹å‡¸å£³ä¸Šçš„ç‚¹)ï¼Œè¿™æ—¶å€™å·¦è¾¹çš„æ‰€æœ‰å…ƒç´ å¯ä»¥ä¿è¯ $x$ å’Œæ–œç‡éƒ½æ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>å³è¾¹å‘¢ï¼Ÿå› ä¸ºç›´çº¿çš„æ–œç‡æ˜¯ $2x$ ï¼Œè€Œå³è¾¹çš„ $x$ ä¹Ÿæ˜¯å•è°ƒä¸Šå¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„‰å¿«çš„åšæœ´ç´ çš„å•è°ƒé˜Ÿåˆ—äº†ã€‚</p><p>$CDQ$ åˆ†æ²»éƒ¨åˆ†çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;<span class="comment">/*ä¸€ä¸ªç‚¹çš„æ—¶å€™ç›´æ¥è®¡ç®—yå€¼*/</span></span><br><span class="line">        a[l].y=f[a[l].id]-s[a[l].id]+S(a[l].x);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(a[i].id&lt;=mid) b[c1++]=a[i]; <span class="comment">/*ç¼–å·å°çš„å·¦è¾¹å»*/</span></span><br><span class="line">        <span class="keyword">else</span> b[c2++]=a[i]; <span class="comment">/*ç¼–å·å¤§äº›çš„å³è¾¹å»*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    CDQ(l,mid); <span class="comment">/*è®¡ç®—å‡ºå·¦è¾¹æ‰€æœ‰å…ƒç´ çš„ f*/</span></span><br><span class="line">    <span class="keyword">int</span> head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=mid;++i) &#123; <span class="comment">/*å¤„ç†å‡ºå·¦è¾¹æ‰€æœ‰å…ƒç´ ç»„æˆçš„ä¸‹å‡¸å£³*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail<span class="number">-1</span>],q[tail])&gt;slope(q[tail],i)) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=mid+<span class="number">1</span>;i&lt;=r;++i) &#123; <span class="comment">/*è®¡ç®—å·¦è¾¹å…ƒç´ å¯¹å³è¾¹å…ƒç´ äº§ç”Ÿçš„è´¡çŒ®*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*a[i].x) ++head; <span class="comment">/*ç»´æŠ¤é˜Ÿåˆ—*/</span></span><br><span class="line">        <span class="keyword">int</span> x=a[i].id,y=a[q[head]].id;</span><br><span class="line">        f[x]=min(f[x],f[y]+s[x<span class="number">-1</span>]-s[y]+S(a[i].x-a[q[head]].x));</span><br><span class="line">        <span class="comment">/*å¯èƒ½è®¡ç®—å¤šæ¬¡æ‰€ä»¥è¦å–min*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i)  <span class="comment">/*è¿˜åŸaæ•°ç»„è‡³åˆå§‹çŠ¶æ€*/</span></span><br><span class="line">        <span class="keyword">if</span>(c2&gt;r||(c1&lt;=mid&amp;&amp;a[c1].x&lt;a[c2].x)) b[i]=a[c1++];</span><br><span class="line">        <span class="keyword">else</span> b[i]=a[c2++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//mainå‡½æ•°ä¸­</span></span><br><span class="line">sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n,cmp),CDQ(<span class="number">1</span>,n); <span class="comment">/*æ’åºåCDQå¼€å§‹*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]); <span class="comment">/*è¾“å‡º*/</span></span><br></pre></td></tr></table></figure><p>æœ€åå› ä¸ºå­˜åœ¨ $0$ ï¼Œåœ¨è®¡ç®—æ–œç‡çš„æ—¶å€™éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚è¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹ $long\ long$ çš„é—®é¢˜ï¼Œè®°å¾—å°† $f$ æ•°ç»„åˆå§‹åŒ–ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf=<span class="number">1e18</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span><span class="keyword">int</span> x,id;ll y;&#125;a[N],b[N];</span><br><span class="line">ll s[N],w[N],f[N];<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll x)</span> </span>&#123;<span class="keyword">return</span> x*x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(point x,point y)</span> </span>&#123;<span class="keyword">return</span> x.x&lt;y.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a[i].x==a[j].x) &#123;</span><br><span class="line">        <span class="keyword">return</span> a[i].y&lt;a[j].y?inf:-inf;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="keyword">double</span>(a[i].y-a[j].y)/<span class="keyword">double</span>(a[i].x-a[j].x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;a[l].y=f[a[l].id]-s[a[l].id]+S(a[l].x);<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(a[i].id&lt;=mid) b[c1++]=a[i];</span><br><span class="line">        <span class="keyword">else</span> b[c2++]=a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    CDQ(l,mid);</span><br><span class="line">    <span class="keyword">int</span> head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=mid;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail<span class="number">-1</span>],q[tail])&gt;slope(q[tail],i)) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=mid+<span class="number">1</span>;i&lt;=r;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*a[i].x) ++head;</span><br><span class="line">        <span class="keyword">int</span> x=a[i].id,y=a[q[head]].id;</span><br><span class="line">        f[x]=min(f[x],f[y]+s[x<span class="number">-1</span>]-s[y]+S(a[i].x-a[q[head]].x));</span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(c2&gt;r||(c1&lt;=mid&amp;&amp;a[c1].x&lt;a[c2].x)) b[i]=a[c1++];</span><br><span class="line">        <span class="keyword">else</span> b[i]=a[c2++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        IN(a[i].x),a[i].id=i,f[i]=inf;</span><br><span class="line">    f[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(w[i]),s[i]=s[i<span class="number">-1</span>]+w[i];</span><br><span class="line">    sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n,cmp),CDQ(<span class="number">1</span>,n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ„‰å¿«çš„æ¨å¼å­å§(ï¾‰â‰§âˆ€â‰¦)ï¾‰ï¼&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ æ ¹æŸ±å­å®Œå·¥åçš„æœ€å°ä»£ä»·ã€‚æšä¸¾ä¸€ä¸ªå°äº $i$ çš„ $j$ ï¼Œè¡¨ç¤ºä¸ºä» $j$ å‘ $i$ è¿äº†ä¸€åº§æ¡¥ï¼Œä¸­é—´çš„æŸ±å­å½“ç„¶å…¨éƒ¨æ¨æ‰ï¼Œè®¡ç®—ä¸€ä¸‹å°±å¥½ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\min\{f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\}&lt;/script&gt;&lt;p&gt;*å…¶ä¸­ $s$ ä¸º $w$ çš„å‰ç¼€å’Œã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2008]ç©å…·è£…ç®±TOY  æ–œç‡ä¼˜åŒ–DP  luoguP3195</title>
    <link href="http://qiulyblog.github.io/2019/04/24/%5B%E9%A2%98%E8%A7%A3%5DluoguP3195/"/>
    <id>http://qiulyblog.github.io/2019/04/24/[é¢˜è§£]luoguP3195/</id>
    <published>2019-04-23T16:00:00.000Z</published>
    <updated>2019-04-28T05:51:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>å·®ä¸å¤šææ‡‚äº†æ–œç‡ä¼˜åŒ–å§â€¦â€¦è¯´å®è¯ç½‘ä¸Šçš„æ–‡ç« éƒ½å†™å¾—å¾ˆè¿·ï¼Œè¿˜å¥½æ‰¾åˆ°äº†ä¸€ä¸ªä¸é”™çš„æ–‡ç« ï¼š<a href="https://www.cnblogs.com/yangsongyi/p/9630227.html" target="_blank" rel="noopener">è½¬é€é—¨æˆ³æˆ‘(ï¿£â–½ï¿£)~*</a> ã€‚(ä¸ºä»€ä¹ˆçªç„¶å‘ç°è¿™é“é¢˜å’Œè¯—äººå°Gå¾ˆåƒå‘¢) </p><p>è¿™ä¸ª $\texttt{DP}$ æ–¹ç¨‹è°éƒ½ä¼šè®¾ï¼šè®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªç©å…·çš„æœ€å°è´¹ç”¨ï¼Œè½¬ç§»æ˜¾ç„¶å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f_i=\min\limits_{j=1}^{i-1}\{f_j+(sum_i-sum_j+i-j-l)^2\}</script><p>(å…¶ä¸­ $sum$ æ˜¯å‰ç¼€å’Œ)ã€‚è¿™ä¸ªå¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ï¼Œè¿‡ä¸å»â€¦â€¦</p><a id="more"></a><p>ç»§ç»­æ¨å¼å­ï¼š</p><script type="math/tex; mode=display">f_i=\min\limits_{j=1}^{i-1}\{f_j+[(sum_i+i)-(sum_j+j)-l]^2\}</script><p>è®¾ $s_i=sum_i+i$ ï¼Œæˆ‘ä»¬å‡è®¾ $j$ ä¸ºæœ€ä¼˜å†³ç­–ï¼Œå°† $\min$ å»æ‰ã€‚</p><script type="math/tex; mode=display">f_i=f_j+(s_i-s_j-l)^2\\f_i=f_j+s_i^2+(s_j+l)^2-2\cdot s_i\cdot(s_j+l)\\f_j+s_i^2+(s_j+l)^2=2\cdot s_i\cdot(s_j+l)+f_iâ€‹</script><p>äºæ˜¯ä¸Šé¢çš„å¼å­å˜æˆäº† $y=kx+b$ çš„å½¢å¼ï¼Œå…¶ä¸­ $y=f_j+s_i^2+(s_j+l)^2$ ï¼Œ$k=2\cdot s_i$ ï¼Œ$x=s_j+l$ ï¼Œ$b=f_i$ ã€‚</p><p>ç„¶åå°† $x,y$ ä¸¤ä¸ªå€¼ä½œä¸ºç‚¹ $(x,y)$ æ”¾åˆ°å¹³é¢ä¸Šå³å¯ï¼Œå› ä¸ºæœ€ç»ˆç­”æ¡ˆæ˜¯å– $min$ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»´æŠ¤çš„æ˜¯ä¸‹å‡¸å£³ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ç®—æ–œç‡çš„æ—¶å€™å¯ä»¥å°†æ¯ä¸ªç‚¹çš„å¸¸æ•°é¡¹æˆ–è€…åªå’Œ $i$ æœ‰å…³çš„é¡¹å»æ‰ï¼Œå› ä¸ºç®—æ–œç‡æ˜¯ç›¸å‡çš„ï¼Œå‡çš„æ—¶å€™è¿™äº›é¡¹åŒæ ·ä¹Ÿæ²¡äº†ã€‚</p><p>ä¸Šé¢çš„ $x$ ä¸­çš„ $l$ æ˜¯å¸¸æ•°é¡¹äºæ˜¯å¯ä»¥çœç•¥ï¼Œ$y$ ä¸­çš„ $s_i^2$ åªå’Œ $i$ æœ‰å…³ï¼Œäºæ˜¯ä¹Ÿçœç•¥æ‰ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) ((x)*(x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> n,l,head,tail;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[N],s[N],q[N];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">X</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> s[i];&#125;<span class="comment">/*æ¯ä¸ªç‚¹çš„xåæ ‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> f[i]+S(s[i]+l);&#125;<span class="comment">/*æ¯ä¸ªç‚¹çš„yåæ ‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;<span class="keyword">return</span> (Y(j)-Y(i))/(X(j)-X(i));&#125;<span class="comment">/*ç®—æ–œç‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;s[i]),s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]+=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*s[i]) ++head;</span><br><span class="line">        f[i]=f[q[head]]+S(s[i]-s[q[head]]-l<span class="number">-1</span>);<span class="comment">/*è½¬ç§»*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail],i)&lt;slope(q[tail],q[tail<span class="number">-1</span>])) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ¥è§£é‡Šä¸€äº›é—®é¢˜ã€‚</p><h3 id="1-ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³"><a href="#1-ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³" class="headerlink" title="1.ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³"></a>1.ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³</h3><p>å› ä¸ºæˆ‘ä»¬çš„ $\texttt{DP}$ æ–¹ç¨‹æ˜¯åœ¨å– $\min$ ï¼Œå¦‚æœæ˜¯ $\max$ çš„è¯åˆ™ç»´æŠ¤ä¸Šå‡¸å£³ã€‚è€Œä¸”ç»´æŠ¤ä¸‹å‡¸å£³æ˜¾ç„¶æ˜¯è®© $f_i$ æ›´å°ã€‚</p><p>ä»¥ä¸Šé¢ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç”¨ $y=kx+bâ€‹$ çš„ç›´çº¿ä»ä¸‹é¢ç½‘ä¸Šæ‰«ï¼Œæ³¨æ„è¿™æ¡ç›´çº¿çš„æ–œç‡å°±æ˜¯ $kâ€‹$ ã€‚å¾ˆæ˜¾ç„¶å¦‚æœæˆ‘ä»¬ä»ä¸‹å¾€ä¸Šè¿™æ ·æ‰«è¶Šå¾€ä¸Šæ‰« $bâ€‹$ è¶Šå¤§(ä¸æ˜ç™½çš„ç”»ç”»å›¾)ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®çš„æ˜¯ä½¿å¾— $bâ€‹$ æœ€å°( $bâ€‹$ å°±æ˜¯ $f_iâ€‹$ ) ã€‚ä¸‹å‡¸å£³åŒ…å«äº†æœ€ä¸‹é¢çš„æ‰€æœ‰ç‚¹ï¼Œæ˜¾ç„¶ä¸æ˜¯ä¸‹å‡¸å£³ä¸Šçš„ç‚¹ä¸€å®šä¸èƒ½æˆä¸ºæœ€ä¼˜çš„ã€‚</p><h3 id="2-ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ"><a href="#2-ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ" class="headerlink" title="2.ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ"></a>2.ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ</h3><p>é¦–å…ˆç¬¬ä¸€ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*s[i]) ++head;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è®²äº†æˆ‘ä»¬éœ€è¦ä½¿å¾— $bâ€‹$ æœ€å°ï¼Œé‚£ä¹ˆæœ€ä¼˜çš„å†³ç­–ç‚¹åœ¨ç›´çº¿ä»ä¸‹å¾€ä¸Šæ‰«çš„è¿‡ç¨‹ä¸­è‚¯å®šæ˜¯æœ€å…ˆæ‰«åˆ°çš„ï¼Œå› ä¸ºé‚£æ ·å¯ä»¥ä¿è¯ $f_iâ€‹$ æœ€å°ã€‚å‡è®¾æœ€ä¼˜çš„ç‚¹ä¸º $iâ€‹$ ï¼Œä¸Šä¸€ä¸ªç‚¹ä¸º $jâ€‹$ ï¼Œä¸‹ä¸€ä¸ªç‚¹ä¸º $kâ€‹$ ï¼Œé‚£ä¹ˆ $iâ€‹$ ä¸€å®šä¿è¯ $jâ€‹$ åˆ° $iâ€‹$ çš„æ–œç‡å°äºç›´çº¿æ–œç‡å¹¶ä¸” $iâ€‹$ åˆ° $kâ€‹$ çš„æ–œç‡å¤§äºç›´çº¿æ–œç‡ã€‚</p><p>ç„¶åæˆ‘ä»¬ä¼šå‘ç°å¯¹äºå•è°ƒä¸Šå¢çš„éœ€è¦æ›´æ–°çš„ $iâ€‹$ ï¼Œå…¶ç›´çº¿çš„æ–œç‡ $kâ€‹$ ä¸€å®šæ˜¯å•è°ƒä¸Šå¢çš„ï¼Œå› ä¸ºå‰ç¼€å’Œæ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>æ‰€ä»¥å¯¹äºæ–œç‡å·²ç»ä¸æ»¡è¶³è¦æ±‚çš„ç‚¹ç›´æ¥è¸¢å‡ºé˜Ÿå°±å¥½äº†ã€‚</p><p>ç„¶ååº·åº·å‡ºé˜Ÿçš„è¿‡ç¨‹ã€‚å¦‚æœåœ¨çº¸ä¸Šç”»ç”»ä¼šå‘ç°ï¼Œå¦‚æœæ»¡è¶³ <code>slope(q[tail],i)&lt;slope(q[tail],q[tail-1])</code> ï¼Œé‚£ä¹ˆè¯´æ˜ $q[tail]$ å·²ç»ä¸å†ä¸‹å‡¸å£³ä¸­äº†ï¼æ²¡é”™å§ï¼Ÿé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ $q[tail]$ æ°¸è¿œä¹Ÿä¸å¯èƒ½æˆä¸ºæœ€ä¼˜çš„è½¬ç§»ç‚¹äº†ï¼Œç›´æ¥ä¸¢æ‰å³å¯ã€‚</p><hr><p>æœ€åæœ‰ä¸€äº›æ–œç‡ä¼˜åŒ–çš„å¥—è·¯æ€»ç»“(è‡ªå·±æ€»ç»“å‡ºæ¥çš„)ï¼š</p><ul><li>$\texttt{DP}$ æ–¹ç¨‹å– $\min$ å°±ç»´æŠ¤ä¸‹å‡¸å£³ï¼Œå– $\max$ å°±ç»´æŠ¤ä¸Šå‡¸å£³</li><li>$y=kx+bâ€‹$ ä¸­çš„ $kâ€‹$ ä¸€å®šè¦æ˜¯å¸¸é‡æˆ–è€…æ˜¯å®Œå…¨æ˜¯ $iâ€‹$ çš„é‡(ä¾‹å¦‚ $s_i,2\cdot g_i^2â€‹$ ç­‰)ï¼Œ$bâ€‹$ ä¸€å®šæ˜¯ä½ éœ€è¦è½¬ç§»çš„å¯¹è±¡(å°±æ˜¯ $f_iâ€‹$ )ï¼Œ$xâ€‹$ å’Œ $yâ€‹$ ä¸¤ä¸ªå€¼ä¸€å®šè¦åŒ…å«å’Œ $jâ€‹$ æœ‰å…³çš„å€¼ï¼Œè¦éš $jâ€‹$ çš„å˜åŒ–è€Œå˜åŒ–ã€‚</li><li>æç‚¼å‡ºæ¥çš„ $x,y$ æ”¾åˆ°åæ ‡ç³»ä¸Šä¹‹å‰è®°å¾—å»æ‰æ²¡ç”¨çš„å€¼ã€‚</li></ul><p>å·®ä¸å¤šå°±è¿™äº›å§ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯å®Œå…¨æ­£ç¡®ï¼Œè‡³å°‘è¿™ä¸ªå¥—è·¯è¿˜æ˜¯è¿‡äº†å‡ é“é¢˜ç›®çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å·®ä¸å¤šææ‡‚äº†æ–œç‡ä¼˜åŒ–å§â€¦â€¦è¯´å®è¯ç½‘ä¸Šçš„æ–‡ç« éƒ½å†™å¾—å¾ˆè¿·ï¼Œè¿˜å¥½æ‰¾åˆ°äº†ä¸€ä¸ªä¸é”™çš„æ–‡ç« ï¼š&lt;a href=&quot;https://www.cnblogs.com/yangsongyi/p/9630227.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è½¬é€é—¨æˆ³æˆ‘(ï¿£â–½ï¿£)~*&lt;/a&gt; ã€‚(ä¸ºä»€ä¹ˆçªç„¶å‘ç°è¿™é“é¢˜å’Œè¯—äººå°Gå¾ˆåƒå‘¢) &lt;/p&gt;
&lt;p&gt;è¿™ä¸ª $\texttt{DP}$ æ–¹ç¨‹è°éƒ½ä¼šè®¾ï¼šè®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªç©å…·çš„æœ€å°è´¹ç”¨ï¼Œè½¬ç§»æ˜¾ç„¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\min\limits_{j=1}^{i-1}\{f_j+(sum_i-sum_j+i-j-l)^2\}&lt;/script&gt;&lt;p&gt;(å…¶ä¸­ $sum$ æ˜¯å‰ç¼€å’Œ)ã€‚è¿™ä¸ªå¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ï¼Œè¿‡ä¸å»â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [APIO2010]ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ  æ–œç‡ä¼˜åŒ–DP  luoguP3628</title>
    <link href="http://qiulyblog.github.io/2019/04/24/%5B%E9%A2%98%E8%A7%A3%5DluoguP3628/"/>
    <id>http://qiulyblog.github.io/2019/04/24/[é¢˜è§£]luoguP3628/</id>
    <published>2019-04-23T16:00:00.000Z</published>
    <updated>2019-04-28T05:52:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¾æ—§æ˜¯æ–œç‡ä¼˜åŒ–çš„å¥—è·¯ã€‚</p><p>è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªå£«å…µçš„æœ€å¤§è´¡çŒ®ï¼Œè½¬ç§»æ˜¾ç„¶æ˜¯æšä¸¾ä¸€ä¸ª $j$ ï¼Œå°† $j+1$ åˆ° $i$ è¿™äº›å£«å…µç»„æˆç‰¹åˆ«è¡ŒåŠ¨é˜Ÿç®—è´¡çŒ®ï¼š</p><script type="math/tex; mode=display">f_i=\max\{f_j+a(s_i-s_j)^2+b(s_i-s_j)+c\}â€‹</script><p>å…¶ä¸­ $s_i$ ä¸ºæˆ˜æ–—åŠ›çš„å‰ç¼€å’Œã€‚è¿™ä¸ªæ–¹ç¨‹æ˜¯ $O(n^2)$ çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚å‘ç°è¿™ä¸ªè½¬ç§»å¼è²Œä¼¼ä¸æ»¡è¶³å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ¡ä»¶ï¼Œäºæ˜¯å°†ä¸­é—´çš„å¼å­æ‹†å¼€çœ‹çœ‹å¯ä¸å¯ä»¥æ–œç‡ä¼˜åŒ–ã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=\max\{f_j+a(s_i^2+s_j^2-2s_is_j)+b\cdot s_i-b\cdot s_j+c\}\\f_i=\max\{f_j+a\cdot s_i^2+a\cdot s_j^2-2a\cdot s_is_j)+b\cdot s_i-b\cdot s_j+c\}\\f_i=f_j+a\cdot s_i^2+a\cdot s_j^2-2a\cdot s_is_j+b\cdot s_i-b\cdot s_j+c\\f_j+a\cdot s_i^2+a\cdot s_j^2+b\cdot s_i-b\cdot s_j+c=2a\cdot s_i\cdot s_j +f_iâ€‹</script><p>è¯¶ï¼Œæ˜¯ $y=kx+b$ çš„å½¢å¼ï¼Œè€Œä¸”æ»¡è¶³æ–œç‡ä¼˜åŒ–çš„æ¡ä»¶è¯¶ã€‚ç»§ç»­å°† $x,y$ æ‰¾å‡ºæ¥æ”¾åˆ°åæ ‡ç³»ä¸Š( $x=s_j$,$y=f_j+a\cdot s_j^2-b\cdot s_j$) ã€‚</p><p>å› ä¸ºæ˜¯ $\maxâ€‹$ ï¼Œæ‰€ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸€ä¸‹ä¸Šå‡¸å£³ç„¶åè½¬ç§»å³å¯ï¼Œå¤æ‚åº¦ $O(n)â€‹$ ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) ((x)*(x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e6</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> n,a,b,c,head,tail;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> s[N],f[N],q[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">X</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> s[i];&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> f[i]+<span class="number">1l</span>l*S(s[i])*a<span class="number">-1l</span>l*s[i]*b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;<span class="keyword">return</span> (Y(j)-Y(i))/(X(j)-X(i));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    f[i]=f[j]+<span class="number">1l</span>l*S(s[i]-s[j])*a+<span class="number">1l</span>l*(s[i]-s[j])*b+c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(a),IN(b),IN(c);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(s[i]),s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&gt;<span class="number">2</span>*a*s[i]) ++head;</span><br><span class="line">        calc(i,q[head]);</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail],i)&gt;slope(q[tail],q[tail<span class="number">-1</span>])) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¾æ—§æ˜¯æ–œç‡ä¼˜åŒ–çš„å¥—è·¯ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªå£«å…µçš„æœ€å¤§è´¡çŒ®ï¼Œè½¬ç§»æ˜¾ç„¶æ˜¯æšä¸¾ä¸€ä¸ª $j$ ï¼Œå°† $j+1$ åˆ° $i$ è¿™äº›å£«å…µç»„æˆç‰¹åˆ«è¡ŒåŠ¨é˜Ÿç®—è´¡çŒ®ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\max\{f_j+a(s_i-s_j)^2+b(s_i-s_j)+c\}â€‹&lt;/script&gt;&lt;p&gt;å…¶ä¸­ $s_i$ ä¸ºæˆ˜æ–—åŠ›çš„å‰ç¼€å’Œã€‚è¿™ä¸ªæ–¹ç¨‹æ˜¯ $O(n^2)$ çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚å‘ç°è¿™ä¸ªè½¬ç§»å¼è²Œä¼¼ä¸æ»¡è¶³å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ¡ä»¶ï¼Œäºæ˜¯å°†ä¸­é—´çš„å¼å­æ‹†å¼€çœ‹çœ‹å¯ä¸å¯ä»¥æ–œç‡ä¼˜åŒ–ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SCOI2008]å¥–åŠ±å…³  çŠ¶å‹DP  luoguP2473</title>
    <link href="http://qiulyblog.github.io/2019/04/23/%5B%E9%A2%98%E8%A7%A3%5DluoguP2473/"/>
    <id>http://qiulyblog.github.io/2019/04/23/[é¢˜è§£]luoguP2473/</id>
    <published>2019-04-22T16:00:00.000Z</published>
    <updated>2019-04-24T07:47:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‘ç°æ•°æ®èŒƒå›´å¾ˆå°ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°â€é›†åˆâ€ï¼Œå¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ç”¨çŠ¶å‹ $\texttt{DP}$ ã€‚</p><p>è®¾ $f[i][j]$ è¡¨ç¤ºå·²ç»æŠ›å‡ºäº† $i$ æ¬¡å®ç‰©ï¼Œè·å¾—çš„å®ç‰©é›†åˆä¸º $j$ æ—¶çš„æœ€ä¼˜åˆ†å€¼ã€‚é‚£ä¹ˆè½¬ç§»çš„æ—¶å€™æšä¸¾æ¯ä¸€ä¸ªå®ç‰©ï¼Œåˆ†ä¸¤ç§æƒ…å†µå³å¯â€”â€”é€‰å½“å‰å®ç‰©æˆ–è€…ä¸é€‰ã€‚æ³¨æ„é€‰å½“å‰å®ç‰©çš„å‰ææ˜¯å¿…é¡»æ»¡è¶³å‰æï¼ŒæŒ‰ç…§æœ€ä¼˜æƒ…å†µé€‰å–å³å¯ã€‚æ³¨æ„æœ€åå°†æ‰€æœ‰çš„å®ç‰©çš„è´¡çŒ®åŠ ä¸Šåè¿˜éœ€è¦$/n$ ï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚çš„æ˜¯â€å¹³å‡â€ã€‚</p><a id="more"></a><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">double</span> f[<span class="number">101</span>][<span class="number">65540</span>];</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">18</span>],d[<span class="number">18</span>],v[<span class="number">18</span>],N,K;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">16</span>;++i) p[i]=<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;K,&amp;N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;v[i],&amp;x);</span><br><span class="line">        <span class="keyword">while</span>(x) &#123;d[i]|=p[x];<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=K;i;--i) <span class="comment">/*å€’ç€æšä¸¾ä¼šå¥½äº›*/</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=p[N+<span class="number">1</span>]<span class="number">-1</span>;++j) &#123;</span><br><span class="line">            <span class="comment">/*ä¸Šé¢ä¸¤é‡å¾ªç¯æšä¸¾çŠ¶æ€*/</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=N;++k)<span class="comment">/*æšä¸¾æ‰€æœ‰å®ç‰©å¹¶è®¡ç®—è´¡çŒ®*/</span></span><br><span class="line">                <span class="keyword">if</span>((d[k]&amp;j)==d[k]) <span class="comment">/*å¯ä»¥é€‰å–å½“å‰å®ç‰©*/</span></span><br><span class="line">                    f[i][j]+=max(f[i+<span class="number">1</span>][j],f[i+<span class="number">1</span>][j|p[k]]+v[k]);</span><br><span class="line">                    <span class="comment">/*æŒ‰ç…§æœ€ä¼˜é€‰å–*/</span></span><br><span class="line">                <span class="keyword">else</span> f[i][j]+=f[i+<span class="number">1</span>][j]; <span class="comment">/*ä¸èƒ½é€‰å–ç›´æ¥è½¬ç§»*/</span></span><br><span class="line">            f[i][j]/=N;<span class="comment">/*æ‰€è°“"å¹³å‡"*/</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.6f\n"</span>,f[<span class="number">1</span>][<span class="number">0</span>]);<span class="comment">/*æœ€ç»ˆç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç°æ•°æ®èŒƒå›´å¾ˆå°ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°â€é›†åˆâ€ï¼Œå¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ç”¨çŠ¶å‹ $\texttt{DP}$ ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f[i][j]$ è¡¨ç¤ºå·²ç»æŠ›å‡ºäº† $i$ æ¬¡å®ç‰©ï¼Œè·å¾—çš„å®ç‰©é›†åˆä¸º $j$ æ—¶çš„æœ€ä¼˜åˆ†å€¼ã€‚é‚£ä¹ˆè½¬ç§»çš„æ—¶å€™æšä¸¾æ¯ä¸€ä¸ªå®ç‰©ï¼Œåˆ†ä¸¤ç§æƒ…å†µå³å¯â€”â€”é€‰å½“å‰å®ç‰©æˆ–è€…ä¸é€‰ã€‚æ³¨æ„é€‰å½“å‰å®ç‰©çš„å‰ææ˜¯å¿…é¡»æ»¡è¶³å‰æï¼ŒæŒ‰ç…§æœ€ä¼˜æƒ…å†µé€‰å–å³å¯ã€‚æ³¨æ„æœ€åå°†æ‰€æœ‰çš„å®ç‰©çš„è´¡çŒ®åŠ ä¸Šåè¿˜éœ€è¦$/n$ ï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚çš„æ˜¯â€å¹³å‡â€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çŠ¶å‹DP" scheme="http://qiulyblog.github.io/tags/%E7%8A%B6%E5%8E%8BDP/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2011]Noiå˜‰å¹´å  å†³ç­–å•è°ƒæ€§ä¼˜åŒ–DP  luoguP1973</title>
    <link href="http://qiulyblog.github.io/2019/04/22/%5B%E9%A2%98%E8%A7%A3%5DluoguP1973/"/>
    <id>http://qiulyblog.github.io/2019/04/22/[é¢˜è§£]luoguP1973/</id>
    <published>2019-04-21T16:00:00.000Z</published>
    <updated>2019-04-23T00:42:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é“é¢˜ä¸€å…±æœ‰ä¸¤é—®ï¼Œç¬¬ä¸€é—®çæ $\texttt{DP}$ ï¼Œç¬¬äºŒé—®å¦‚æœç›´æ¥ $\texttt{DP}$ çš„è¯å¤æ‚åº¦æ˜¯ $O(n^4)$ çš„è¿‡ä¸å»ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨åˆ°å†³ç­–å•è°ƒæ€§ä¼˜åŒ–å¤æ‚åº¦å°±å¯ä»¥é™ä½è‡³ $O(n^3)$ ï¼Œè¿™æ ·å°±è¿‡äº†ã€‚æˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹ç¬¬ä¸€é—®çš„åšæ³•ã€‚</p><p>æ—¶é—´çš„èŒƒå›´å¤ªå¤§äº†ï¼Œæˆ‘ä»¬éœ€è¦ç¦»æ•£åŒ–ä¸€ä¸‹ã€‚ç¦»æ•£åŒ–åæ—¶é—´å°±æ§åˆ¶åœ¨ $0$ åˆ° $2n$ çš„èŒƒå›´å†…äº†ã€‚</p><p>é¦–å…ˆå¯ä»¥å‘ç°æœ€ç»ˆçš„ç­”æ¡ˆä¸€å®šå°±æ˜¯ä¸€æ®µä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸€æ®µæ—¶é—´å†…çš„æ´»åŠ¨éƒ½æ˜¯åœ¨åŒä¸€ä¸ªä¼šåœºä¸¾è¡Œã€‚æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†ä¸€ä¸ª $tot_{l,r}$ è¡¨ç¤ºå®Œå…¨åœ¨æ—¶é—´ $l,r$ ä¹‹å†…çš„æ´»åŠ¨æœ‰å¤šå°‘ä¸ªã€‚è®¡ç®—ç›´æ¥æš´åŠ›ï¼Œé¢„å¤„ç†çš„å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚</p><a id="more"></a><p>ç„¶åè®¾ä¸€ä¸ª $pre_{i,j}â€‹$ è¡¨ç¤º <strong>$1â€‹$ åˆ° $iâ€‹$ çš„æ—¶é—´ä¸€ä¸ªä¼šåœºçš„æ´»åŠ¨æ•°ä¸º $jâ€‹$ æ—¶å¦ä¸€ä¸ªä¼šåœºçš„æœ€å¤§æ´»åŠ¨æ•°</strong>ã€‚é‚£ä¹ˆè½¬ç§»çš„è¯æˆ‘ä»¬æšä¸¾ä¸€ä¸ªæ—¶é—´ $kâ€‹$ ï¼Œç„¶åè€ƒè™‘ $kâ€‹$ åˆ° $iâ€‹$ è¿™æ®µæ—¶é—´ä¸­çš„æ‰€æœ‰æ´»åŠ¨åˆ†é…ç»™å“ªä¸ªä¼šåœºå³å¯ã€‚å¯ä»¥å¾—åˆ°è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">pre_{i,j}=\max\limits_{k=1}^{i}\{pre_{k,j}+tot_{k,i},pre_{k,j-tot_{k,i}}\}â€‹</script><p>è¿™é‡Œæˆ‘ä»¬ $pre$ æ–¹ç¨‹çš„å®šä¹‰ä¸­â€ä¸€ä¸ªä¼šåœºâ€å°±æ˜¯ä¸€å·ä¼šåœºï¼Œâ€å¦ä¸€ä¸ªä¼šåœºâ€å°±æ˜¯äºŒå·ä¼šåœº$ã€‚pre_{k,j}+tot_{k,i}$ å°±æ˜¯å°† $k$ åˆ° $i$ è¿™æ®µæ—¶é—´ä¸­æ‰€æœ‰æ´»åŠ¨éƒ½åˆ†é…ç»™äº†äºŒå·ä¼šåœºï¼Œ$pre_{k,j-tot_{k,i}}$ å¾ˆæ˜¾ç„¶å°±æ˜¯åˆ†é…ç»™äº†ä¸€å·ä¼šåœºã€‚è®¡ç®—æ—¶æšä¸¾ $i,j,k$ ï¼Œå¤æ‚åº¦æ˜¯ $O(n^3)$ ã€‚(å…¶å®å‡†ç¡®çš„å¤æ‚åº¦å¸¦ä¸ªå¸¸æ•°ï¼Œå› ä¸º $i$ æšä¸¾çš„æ˜¯æ—¶é—´ï¼Œè€Œæ—¶é—´æœ€å¤§æ˜¯ $2n$ çš„) ã€‚</p><p>æˆ‘ä»¬è®¾ç¦»æ•£åŒ–åæ—¶é—´æ€»é•¿ä¸º $m$ ï¼Œé‚£ä¹ˆç­”æ¡ˆæ˜¾ç„¶ä¸º $\max\limits_{i=1}^m\{\min(pre_{m,i},i)\}$ ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è§£å†³ç¬¬äºŒé—®ã€‚</p><p>æˆ‘ä»¬çš„ $tot_{l,r}$ ç»Ÿè®¡çš„å°±æ˜¯å®Œå…¨åœ¨æ—¶é—´ $l,r$ çš„åŒºé—´æœ‰å¤šå°‘ä¸ªã€‚é‚£ä¹ˆå¯¹äºç¬¬ $i$ ä¸ªæ´»åŠ¨ï¼Œè®¾è¯¥æ´»åŠ¨çš„èµ·å§‹æ—¶é—´ä¸ç»ˆæ­¢æ—¶é—´åˆ†åˆ«ä¸º $s_i,t_i$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†è€ƒè™‘ä¸€å¯¹ $x,y \ \ (x\leq s_i,t_i\leq y)$ ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°†ç­”æ¡ˆè®¡ç®—ä¸Š $tot_{x,y}$ ï¼Œé‚£ä¹ˆä¹Ÿå°±é€‰æ‹©äº†ç¬¬ $i$ ä¸ªæ´»åŠ¨äº†ã€‚</p><p>æˆ‘ä»¬è®¾ $f_{i,j}$ è¡¨ç¤ºä¸€å·ä¼šåœºå¼ºåˆ¶é€‰æ‹© $i$ åˆ° $j$ æ—¶é—´ä¸­çš„æ‰€æœ‰æ´»åŠ¨æ—¶çš„æœ€ä¼˜ç­”æ¡ˆã€‚(æ³¨æ„è¿™é‡Œçš„æœ€ä¼˜ç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªä¼šåœºä¸­æ´»åŠ¨å°‘çš„ä¸€æ–¹çš„æœ€å¤§å€¼ï¼Œæˆ‘ä»¬åªæ˜¯è€ƒè™‘åœ¨ä¸€å·ä¼šåœº<strong>å¼ºåˆ¶é€‰æ‹©</strong> $i$ åˆ° $jâ€‹$ ä¸­çš„æ‰€æœ‰æ´»åŠ¨çš„æƒ…å†µä¸‹è€ƒè™‘æœ€ä¼˜çš„å…¨å±€ç­”æ¡ˆ) ã€‚</p><p>ç»§ç»­çœ‹å‘ä¸€å·ä¼šåœºï¼Œå‡è®¾åœ¨ $i$ å‰é¢çš„æ—¶é—´ä¸­ä¸€å·ä¼šåœºå·²ç»åˆæ³•ä¸¾åŠäº† $x$ åœºæ´»åŠ¨ï¼Œåœ¨ $j$ åé¢çš„æ—¶é—´ä¸­ä¹Ÿåˆæ³•ä¸¾åŠäº† $y$ åœºæ´»åŠ¨ã€‚é‚£ä¹ˆæˆ‘ä»¬æšä¸¾ $i,j,x,y$ ä¹Ÿå¯ä»¥å¾—åˆ°äºŒå·ä¼šåœºçš„æ´»åŠ¨æ•°ï¼š$i$ å‰é¢çš„æ—¶é—´ç§æœ‰ $pre_{i,x}$ åœºæ´»åŠ¨ï¼Œ$j$ åé¢çš„æ—¶é—´ä¸­æœ‰â€¦â€¦è¯¶è¿™é‡Œç”¨ $pre$ è²Œä¼¼ä¸æ˜¯å¾ˆå¥½è¡¨ç¤ºè¯¶ï¼Œäºæ˜¯æˆ‘ä»¬æ–°å®šä¹‰ä¸€ä¸ª $suf$ ï¼Œ$suf_{i,j}$ è¡¨ç¤º <strong>$i$ åˆ° $m$ çš„æ—¶é—´ä¸€ä¸ªä¼šåœºçš„æ´»åŠ¨æ•°ä¸º $j$ æ—¶å¦ä¸€ä¸ªä¼šåœºçš„æœ€å¤§æ´»åŠ¨æ•°</strong>ï¼Œ$suf$ çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹å’Œ $pre$ çš„åŒç†ã€‚</p><p>æšä¸¾ $i,j,x,y$ åå°±å¯ä»¥å¾—åˆ°ä¸¤ä¸ªä¼šåœºçš„æ´»åŠ¨ä¸ªæ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç®—ç­”æ¡ˆäº†ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\max\limits_{x=1}^{m}\max\limits_{y=1}^{m}\{\min(x+tot_{i,j}+y,pre_{i,x}+suf_{j,y})\}â€‹</script><p>ä½†æ˜¯è¿™æ ·å­çš„å¤æ‚åº¦æ˜¯ $O(n^4)â€‹$ çš„ï¼Œè¿‡ä¸äº†ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œ<strong>å¯¹äºå•è°ƒé€’å¢çš„ $x$ ï¼Œå¯¹åº”çš„æœ€ä¼˜çš„ $y$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„</strong> ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿé¦–å…ˆå¯¹äºä¸€ä¸ªå•è°ƒé€’å¢çš„ $i$ ï¼Œ$pre_{?_i},suf_{?_i}$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„( $?$ ä¸ºä»»æ„æ•°) ã€‚é‚£ä¹ˆå¦‚æœå¯¹äºå•è°ƒé€’å¢çš„ $x$ ï¼Œ$pre_{i,x}$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœ $y$ å•è°ƒé€’å¢ä¹Ÿå°±æ„å‘³ç€ $suf_{j,y}$ ä¼šå•è°ƒé€’å‡ï¼Œé‚£ä¹ˆ $x+tot_{i,j}+y$ å’Œ $pre_{i,x}+suf_{j,y}$ å°†ä¼šè¶Šæ‹‰è¶Šå¤§ï¼Œå¯¹äºç­”æ¡ˆæ˜¾ç„¶æ˜¯ä¸åˆ©çš„ã€‚åè¿‡æ¥ï¼Œå¦‚æœ $y$ æ˜¯å•è°ƒé€’å‡çš„ï¼Œé‚£ä¹ˆå°±ä¼šç›¸å¯¹æ¯”è¾ƒå‡è¡¡ã€‚(æ„Ÿæ€§ç†è§£ç†è§£â€¦â€¦)</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦æšä¸¾ $y$ äº†ï¼Œåªéœ€è¦æ‰«ä¸€æ‰«å°±å¥½äº†ï¼Œæœ€ç»ˆè®¡ç®— $f$ çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚</p><p>æœ€ç»ˆç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªæ´»åŠ¨ $i$ ï¼Œæˆ‘ä»¬çš„ç­”æ¡ˆæ˜¾ç„¶ä¸º $\max\limits_{x=1}^{s_i}\max\limits_{y=t_i}^{m}f_{x,y}$ ã€‚å¿…é¡»æ»¡è¶³ $x\leq s_i,t_i\leq y$ ï¼Œå› ä¸ºè¿™æ ·å°±ä¼šæ»¡è¶³ä¸€å®šä¼šé€‰æ‹©ç¬¬ $i$ ä¸ªæ´»åŠ¨ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> F(i,j,k) for((i)=(j);(i)&lt;=(k);++i)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R(i,j,k) for((i)=(j);(i)&gt;=(k);--i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">4e2</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,i,j,k,l,r,s[N],t[N],b[N];</span><br><span class="line"><span class="keyword">int</span> tot[N][N],pre[N][N],suf[N][N],f[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">IN</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;<span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> min(x+tot[l][r]+y,pre[l][x]+suf[r][y]);&#125;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n=IN();</span><br><span class="line">    F(i,<span class="number">1</span>,n) b[++m]=s[i]=IN(),b[++m]=t[i]=IN()+s[i];</span><br><span class="line">    sort(b+<span class="number">1</span>,b+<span class="number">1</span>+m),</span><br><span class="line">    m=unique(b+<span class="number">1</span>,b+<span class="number">1</span>+m)-b<span class="number">-1</span>;<span class="comment">/*ç¦»æ•£åŒ–å»é‡*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,n) &#123;</span><br><span class="line">        s[i]=lower_bound(b+<span class="number">1</span>,b+<span class="number">1</span>+m,s[i])-b;</span><br><span class="line">        t[i]=lower_bound(b+<span class="number">1</span>,b+<span class="number">1</span>+m,t[i])-b;</span><br><span class="line">        F(l,<span class="number">1</span>,s[i]) R(r,m,t[i]) ++tot[l][r];<span class="comment">/*è®¡ç®—å‡ºtot*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    F(i,<span class="number">1</span>,m) F(j,<span class="number">1</span>,n) pre[i][j]=suf[i][j]=-inf;<span class="comment">/*åˆå§‹åŒ–*/</span> </span><br><span class="line">    <span class="comment">/*----------è®¡ç®—å‡ºpreå’Œsuf----------*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,m) F(j,<span class="number">0</span>,tot[<span class="number">1</span>][i]) F(k,<span class="number">1</span>,i) &#123;</span><br><span class="line">        pre[i][j]=max(pre[i][j],pre[k][j]+tot[k][i]);</span><br><span class="line">        <span class="keyword">if</span>(j&gt;=tot[k][i]) pre[i][j]=max(pre[i][j],pre[k][j-tot[k][i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    R(i,m,<span class="number">1</span>) F(j,<span class="number">0</span>,tot[i][m]) F(k,i,m) &#123;</span><br><span class="line">        suf[i][j]=max(suf[i][j],suf[k][j]+tot[i][k]);</span><br><span class="line">        <span class="keyword">if</span>(j&gt;=tot[i][k]) suf[i][j]=max(suf[i][j],suf[k][j-tot[i][k]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è®¡ç®—f*/</span></span><br><span class="line">    F(l,<span class="number">1</span>,m) F(r,l+<span class="number">1</span>,m) <span class="keyword">for</span>(<span class="keyword">int</span> y=n,x=<span class="number">0</span>;x&lt;=n;++x) &#123;<span class="comment">/*yå½“åšæŒ‡é’ˆæ‰«ä¸€é*/</span></span><br><span class="line">        <span class="keyword">int</span> old_calc=calc(x,y),new_calc;</span><br><span class="line">        <span class="keyword">while</span>(y&amp;&amp;old_calc&lt;=(new_calc=calc(x,y<span class="number">-1</span>))) --y,old_calc=new_calc;</span><br><span class="line">        f[l][r]=max(f[l][r],calc(x,y));<span class="comment">/*è½¬ç§»*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¾“å‡ºç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    F(i,<span class="number">1</span>,n) ans=max(ans,min(pre[m][i],i));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);<span class="comment">/*ç¬¬ä¸€é—®*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,n) &#123;</span><br><span class="line">        ans=<span class="number">0</span>;</span><br><span class="line">        F(l,<span class="number">1</span>,s[i]) R(r,m,t[i]) ans=max(ans,f[l][r]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);<span class="comment">/*ç¬¬äºŒé—®*/</span></span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™é“é¢˜ä¸€å…±æœ‰ä¸¤é—®ï¼Œç¬¬ä¸€é—®çæ $\texttt{DP}$ ï¼Œç¬¬äºŒé—®å¦‚æœç›´æ¥ $\texttt{DP}$ çš„è¯å¤æ‚åº¦æ˜¯ $O(n^4)$ çš„è¿‡ä¸å»ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨åˆ°å†³ç­–å•è°ƒæ€§ä¼˜åŒ–å¤æ‚åº¦å°±å¯ä»¥é™ä½è‡³ $O(n^3)$ ï¼Œè¿™æ ·å°±è¿‡äº†ã€‚æˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹ç¬¬ä¸€é—®çš„åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´çš„èŒƒå›´å¤ªå¤§äº†ï¼Œæˆ‘ä»¬éœ€è¦ç¦»æ•£åŒ–ä¸€ä¸‹ã€‚ç¦»æ•£åŒ–åæ—¶é—´å°±æ§åˆ¶åœ¨ $0$ åˆ° $2n$ çš„èŒƒå›´å†…äº†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯ä»¥å‘ç°æœ€ç»ˆçš„ç­”æ¡ˆä¸€å®šå°±æ˜¯ä¸€æ®µä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸€æ®µæ—¶é—´å†…çš„æ´»åŠ¨éƒ½æ˜¯åœ¨åŒä¸€ä¸ªä¼šåœºä¸¾è¡Œã€‚æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†ä¸€ä¸ª $tot_{l,r}$ è¡¨ç¤ºå®Œå…¨åœ¨æ—¶é—´ $l,r$ ä¹‹å†…çš„æ´»åŠ¨æœ‰å¤šå°‘ä¸ªã€‚è®¡ç®—ç›´æ¥æš´åŠ›ï¼Œé¢„å¤„ç†çš„å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ã€æ¨¡æ¿ã€‘åŠ¨æ€DP  LCT+DP+çŸ©é˜µ  luoguP4751</title>
    <link href="http://qiulyblog.github.io/2019/04/19/%5B%E9%A2%98%E8%A7%A3%5DluoguP4751/"/>
    <id>http://qiulyblog.github.io/2019/04/19/[é¢˜è§£]luoguP4751/</id>
    <published>2019-04-18T16:00:00.000Z</published>
    <updated>2019-04-19T11:17:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>çœ‹æ‡‚äº†åå‘ç° $\texttt{DDP}$ å…¶å®ä¸éš¾å‘¢â€¦â€¦</p><p>å…¶å®ä¸»è¦æ€æƒ³å°±æ˜¯å°† $\texttt{DP}$ è½¬ç§»å¼æåˆ°çŸ©é˜µä¸Šï¼Œç„¶åå¦‚æœæ˜¯æ ‘å½¢ $\texttt{DP}$ çš„è¯å°±å¯ä»¥ç›´æ¥ä¸Šæ ‘å‰–æˆ–è€…æ˜¯ $LCT$ è¿›è¡Œç»´æŠ¤ï¼Œå½“ç„¶è¿˜å¯ä»¥ç”¨å…¨å±€å¹³è¡¡äºŒå‰æ ‘(ä¸è´¹) ã€‚å¦‚æœåªæ˜¯çº¿æ€§çš„è¯å¯ä»¥ç›´æ¥ç”¨çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„è¿›è¡Œç»´æŠ¤äº†ã€‚</p><p>æ³¨æ„è¿™é“æ¨¡æ¿æ ‘å‰–çš„å¤æ‚åº¦æ˜¯ $O(nlog^2n)$ ï¼Œè€Œ $LCT$ çš„å¤æ‚åº¦ä¸º $O(nlogn)$ ï¼Œäºæ˜¯çªé€‰æ‹©äº† $LCT$ ï¼Œè·‘çš„è¿˜æŒºå¿«ã€‚</p><a id="more"></a><p>å¼€å§‹åˆ†æé¢˜ç›®ï¼Œå¦‚æœæ²¡æœ‰â€åŠ¨æ€â€é™åˆ¶çš„è¯å°±æ˜¯ä¸€ä¸ªè£¸çš„â€æ²¡æœ‰ä¸Šå¸çš„èˆä¼šâ€ï¼Œè§£æ³•æ˜¾ç„¶æ˜¯è®¾ $f[u][0/1]â€‹$ è¡¨ç¤º $uâ€‹$ ä¸é€‰/é€‰ çš„æ—¶å€™å…¶å­æ ‘çš„æœ€å¤§ä»·å€¼ï¼Œè½¬ç§»æ˜¾ç„¶ä¸ºï¼š</p><script type="math/tex; mode=display">f[u][0]=\sum \max(f[v][0],f[v][1])\\f[u][1]=val[u]+\sum f[v][0]</script><p>å¯¹äºæ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ $u$ çš„æ‰€æœ‰å„¿å­ä¸­æœ‰ä¸ªé‡å„¿å­ï¼Œå…¶ä»–çš„å„¿å­å°±æ˜¯è½»å„¿å­ï¼Œæˆ‘ä»¬å°†é‡å„¿å­å’Œè½»å„¿å­çš„è´¡çŒ®åˆ†å¼€ç®—ã€‚è®¾ä¸€ä¸ª $g[u][0/1]$ ï¼Œå…¶å€¼ä¸ºï¼š</p><script type="math/tex; mode=display">g[u][0]=\sum\max(f[v][0],f[v][1])\\g[u][1]=val[u]+\sum f[v][0]</script><p>æ³¨æ„ä¸Šå¼ä¸­çš„ $v$ åªçš„æ˜¯è½»å„¿å­ï¼Œç„¶å $f$ çš„è½¬ç§»å°±å˜æˆäº†ä»¥ä¸‹å½¢å¼( $x$ ä¸ºé‡å„¿å­)ï¼š</p><script type="math/tex; mode=display">f[u][0]=\max(f[x][0],f[x][1])+g[u][0]\\f[u][1]=g[u][1]+f[x][0]</script><p>å…¶å®è¿™é‡Œçš„ $g$ å¾ˆå¥½ç»´æŠ¤ï¼Œæˆ‘ä»¬åœ¨ $Access$ çš„æ—¶å€™åªè¦è®¡ç®—å„¿å­å˜åŒ–æ—¶çš„è´¡çŒ®å°±å¥½äº†ã€‚</p><p>æ¥ç€æˆ‘ä»¬æ„é€ å‡ºè½¬ç§»çŸ©é˜µï¼š</p><script type="math/tex; mode=display">\begin{bmatrix}g[u][0] & g[u][0]\\g[u][1] & -inf\end{bmatrix}\cdot\begin{bmatrix}f[x][0] \\f[x][1]\end{bmatrix}=\begin{bmatrix}f[u][0]\\f[u][1]\end{bmatrix}</script><p>è¿™æ ·å­å°±å¯ä»¥ç›´æ¥æ›´æ–°äº†ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªçŸ©é˜µå³å¯ï¼Œä¸€ä¸ªå°±æ˜¯ä¸Šé¢ä¹˜æ³•ä¸­çš„ $g$ çŸ©é˜µï¼Œä¸€ä¸ªå°±æ˜¯ä¸Šé¢ä¹˜æ³•ä¸­çš„ $f$ çŸ©é˜µã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™æ˜¯å¹¿ä¹‰çŸ©é˜µä¹˜æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªçŸ©é˜µä¹˜æ³•çš„è¿ç®—è§„åˆ™ä¸ºï¼š</p><script type="math/tex; mode=display">c[i][j]=max(c[i][j],a[i][k]+b[k][j])</script><p>å¾ˆåƒ $floyd$ ï¼Œå¯ä»¥ç›´æ¥ç®—äº†ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">matrix</span> &#123;</span><span class="keyword">int</span> c[<span class="number">2</span>][<span class="number">2</span>];matrix()&#123;c[<span class="number">0</span>][<span class="number">0</span>]=c[<span class="number">0</span>][<span class="number">1</span>]=c[<span class="number">1</span>][<span class="number">0</span>]=c[<span class="number">1</span>][<span class="number">1</span>]=-inf;&#125;&#125;;</span><br><span class="line">matrix <span class="keyword">operator</span> * (matrix&amp;a,matrix&amp;b) &#123;</span><br><span class="line">    matrix ret;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;<span class="number">2</span>;++k)</span><br><span class="line">        ret.c[i][j]=max(ret.c[i][j],a.c[i][k]+b.c[k][j]);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v[N],dp[N][<span class="number">2</span>],head[N],nxt[N&lt;&lt;<span class="number">1</span>],to[N&lt;&lt;<span class="number">1</span>],cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;nxt[++cnt]=head[u],to[cnt]=v,head[u]=cnt;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">link_cut_tree</span> &#123;</span></span><br><span class="line">    matrix f[N],g[N];</span><br><span class="line">    <span class="keyword">int</span> ch[N][<span class="number">2</span>],fa[N];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> !((ch[fa[x]][<span class="number">0</span>]==x)||(ch[fa[x]][<span class="number">1</span>]==x));&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        f[x]=g[x];</span><br><span class="line">        <span class="keyword">if</span>(ch[x][<span class="number">0</span>]) f[x]=f[ch[x][<span class="number">0</span>]]*f[x];<span class="keyword">if</span>(ch[x][<span class="number">1</span>]) f[x]=f[x]*f[ch[x][<span class="number">1</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> y=fa[x],z=fa[y],k=ch[y][<span class="number">1</span>]==x,v=ch[x][!k];</span><br><span class="line">        <span class="keyword">if</span>(!isroot(y)) ch[z][ch[z][<span class="number">1</span>]==y]=x;ch[x][!k]=y,ch[y][k]=v;</span><br><span class="line">        <span class="keyword">if</span>(v) fa[v]=y;fa[y]=x,fa[x]=z;pushup(y);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(!isroot(x)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!isroot(fa[x]))</span><br><span class="line">                rotate((ch[fa[x]][<span class="number">0</span>]==x)^(ch[fa[fa[x]]][<span class="number">0</span>]==fa[x])?x:fa[x]);</span><br><span class="line">            rotate(x);</span><br><span class="line">        &#125;pushup(x);<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> y=<span class="number">0</span>;x;x=fa[y=x]) &#123;</span><br><span class="line">            Splay(x);</span><br><span class="line">            <span class="keyword">if</span>(ch[x][<span class="number">1</span>]) &#123;</span><br><span class="line">                g[x].c[<span class="number">0</span>][<span class="number">0</span>]+=max(f[ch[x][<span class="number">1</span>]].c[<span class="number">0</span>][<span class="number">0</span>],f[ch[x][<span class="number">1</span>]].c[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">                g[x].c[<span class="number">1</span>][<span class="number">0</span>]+=f[ch[x][<span class="number">1</span>]].c[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(y) &#123;</span><br><span class="line">                g[x].c[<span class="number">0</span>][<span class="number">0</span>]-=max(f[y].c[<span class="number">0</span>][<span class="number">0</span>],f[y].c[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">                g[x].c[<span class="number">1</span>][<span class="number">0</span>]-=f[y].c[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            g[x].c[<span class="number">0</span>][<span class="number">1</span>]=g[x].c[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">            ch[x][<span class="number">1</span>]=y,pushup(x);</span><br><span class="line">        &#125;<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        Access(x),Splay(x),g[x].c[<span class="number">1</span>][<span class="number">0</span>]-=v[x]-y;</span><br><span class="line">        pushup(x),v[x]=y;<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">        dp[u][<span class="number">1</span>]=v[u];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> v=to[i];<span class="keyword">if</span>(v!=fa[u]) &#123;</span><br><span class="line">                fa[v]=u,build(v);</span><br><span class="line">                dp[u][<span class="number">0</span>]+=max(dp[v][<span class="number">0</span>],dp[v][<span class="number">1</span>]);</span><br><span class="line">                dp[u][<span class="number">1</span>]+=dp[v][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        g[u].c[<span class="number">0</span>][<span class="number">0</span>]=g[u].c[<span class="number">0</span>][<span class="number">1</span>]=dp[u][<span class="number">0</span>];</span><br><span class="line">        g[u].c[<span class="number">1</span>][<span class="number">0</span>]=dp[u][<span class="number">1</span>];f[u]=g[u];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,m;IN(n),IN(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(v[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,u,v;i&lt;n;++i)IN(u),IN(v),add(u,v),add(v,u);</span><br><span class="line">    T.build(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span>(m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;IN(x),IN(y);</span><br><span class="line">        T.change(x,y),T.Splay(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,max(T.f[<span class="number">1</span>].c[<span class="number">0</span>][<span class="number">0</span>],T.f[<span class="number">1</span>].c[<span class="number">1</span>][<span class="number">0</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;çœ‹æ‡‚äº†åå‘ç° $\texttt{DDP}$ å…¶å®ä¸éš¾å‘¢â€¦â€¦&lt;/p&gt;
&lt;p&gt;å…¶å®ä¸»è¦æ€æƒ³å°±æ˜¯å°† $\texttt{DP}$ è½¬ç§»å¼æåˆ°çŸ©é˜µä¸Šï¼Œç„¶åå¦‚æœæ˜¯æ ‘å½¢ $\texttt{DP}$ çš„è¯å°±å¯ä»¥ç›´æ¥ä¸Šæ ‘å‰–æˆ–è€…æ˜¯ $LCT$ è¿›è¡Œç»´æŠ¤ï¼Œå½“ç„¶è¿˜å¯ä»¥ç”¨å…¨å±€å¹³è¡¡äºŒå‰æ ‘(ä¸è´¹) ã€‚å¦‚æœåªæ˜¯çº¿æ€§çš„è¯å¯ä»¥ç›´æ¥ç”¨çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„è¿›è¡Œç»´æŠ¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„è¿™é“æ¨¡æ¿æ ‘å‰–çš„å¤æ‚åº¦æ˜¯ $O(nlog^2n)$ ï¼Œè€Œ $LCT$ çš„å¤æ‚åº¦ä¸º $O(nlogn)$ ï¼Œäºæ˜¯çªé€‰æ‹©äº† $LCT$ ï¼Œè·‘çš„è¿˜æŒºå¿«ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LCT" scheme="http://qiulyblog.github.io/tags/LCT/"/>
    
      <category term="çŸ©é˜µ" scheme="http://qiulyblog.github.io/tags/%E7%9F%A9%E9%98%B5/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [åäºŒçœè”è€ƒ2019]æ˜¥èŠ‚åäºŒå“  å †+å¯å‘å¼åˆå¹¶  luoguP5290</title>
    <link href="http://qiulyblog.github.io/2019/04/19/%5B%E9%A2%98%E8%A7%A3%5DluoguP5290/"/>
    <id>http://qiulyblog.github.io/2019/04/19/[é¢˜è§£]luoguP5290/</id>
    <published>2019-04-18T16:00:00.000Z</published>
    <updated>2019-04-19T11:41:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦</p><p>[åäºŒçœè”è€ƒ2019]æ˜¥èŠ‚åäºŒå“ï¼Œå¯å‘å¼åˆå¹¶è£¸é¢˜ã€‚å¯¹äºæ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ $u$ ï¼Œä»å…¶å­æ ‘ä¸­é€‰æ‹©ä¸€æ®µçš„æ–¹å¼æ˜¾ç„¶åªèƒ½æ˜¯ä» $u$ çš„æ‰€æœ‰å­æ ‘ä¸­å„é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ã€‚äºæ˜¯æˆ‘ä»¬æ¯ä¸€ä¸ªèŠ‚ç‚¹å¼€ä¸€ä¸ªå †ï¼Œå­˜çš„å°±æ˜¯å…¶å­æ ‘ä¸­(åŒ…æ‹¬è‡ªå·±)çš„æ‰€æœ‰æ®µçš„å†…å­˜ã€‚</p><p>ç„¶åä»ä¸‹å¾€ä¸Šå¯å‘å¼åˆå¹¶å³å¯ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $O(nlogn)$ ã€‚</p><a id="more"></a><p>å¯å‘å¼åˆå¹¶çš„å…·ä½“ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(q[x].size()&lt;q[y].size()) swap(q[x],q[y]);</span><br><span class="line">    <span class="keyword">while</span>(!q[y].empty()) &#123;</span><br><span class="line">        hep.push_back(max(q[x].top(),q[y].top()));</span><br><span class="line">        q[x].pop(),q[y].pop();</span><br><span class="line">        <span class="comment">/*è´ªå¿ƒé€‰å–*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(hep.size()) q[x].push(hep.back()),hep.pop_back();</span><br><span class="line">    <span class="comment">/*æ›´æ–°èŠ‚ç‚¹*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,sz=G[x].size();i&lt;sz;++i)</span><br><span class="line">        solve(G[x][i]),merge(x,G[x][i]);<span class="comment">/*å°†å½“å‰å­æ ‘ä¸ä¹‹å‰æšä¸¾è¿‡çš„å­æ ‘åˆå¹¶*/</span></span><br><span class="line">    q[x].push(s[x]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åçš„æ€»ä»£ç é•¿åº¦ä¸è¶…è¿‡ $40$ è¡Œã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e5</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,f,s[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; hep,G[N];</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>&gt; q[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(q[x].size()&lt;q[y].size()) swap(q[x],q[y]);</span><br><span class="line">    <span class="keyword">while</span>(!q[y].empty()) &#123;</span><br><span class="line">        hep.push_back(max(q[x].top(),q[y].top()));</span><br><span class="line">        q[x].pop(),q[y].pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(hep.size()) q[x].push(hep.back()),hep.pop_back();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,sz=G[x].size();i&lt;sz;++i)</span><br><span class="line">        solve(G[x][i]),merge(x,G[x][i]);</span><br><span class="line">    q[x].push(s[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;s[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;f),G[f].push_back(i);</span><br><span class="line">    solve(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q[<span class="number">1</span>].empty()) ans+=q[<span class="number">1</span>].top(),q[<span class="number">1</span>].pop();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦&lt;/p&gt;
&lt;p&gt;[åäºŒçœè”è€ƒ2019]æ˜¥èŠ‚åäºŒå“ï¼Œå¯å‘å¼åˆå¹¶è£¸é¢˜ã€‚å¯¹äºæ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ $u$ ï¼Œä»å…¶å­æ ‘ä¸­é€‰æ‹©ä¸€æ®µçš„æ–¹å¼æ˜¾ç„¶åªèƒ½æ˜¯ä» $u$ çš„æ‰€æœ‰å­æ ‘ä¸­å„é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ã€‚äºæ˜¯æˆ‘ä»¬æ¯ä¸€ä¸ªèŠ‚ç‚¹å¼€ä¸€ä¸ªå †ï¼Œå­˜çš„å°±æ˜¯å…¶å­æ ‘ä¸­(åŒ…æ‹¬è‡ªå·±)çš„æ‰€æœ‰æ®µçš„å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä»ä¸‹å¾€ä¸Šå¯å‘å¼åˆå¹¶å³å¯ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $O(nlogn)$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å †" scheme="http://qiulyblog.github.io/tags/%E5%A0%86/"/>
    
      <category term="å¯å‘å¼åˆå¹¶" scheme="http://qiulyblog.github.io/tags/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­  å¯æŒä¹…åŒ–Trieæ ‘  luoguP5283</title>
    <link href="http://qiulyblog.github.io/2019/04/19/%5B%E9%A2%98%E8%A7%A3%5DluoguP5283/"/>
    <id>http://qiulyblog.github.io/2019/04/19/[é¢˜è§£]luoguP5283/</id>
    <published>2019-04-18T16:00:00.000Z</published>
    <updated>2019-04-19T11:34:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}â€‹$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦</p><p>[åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­ï¼Œå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘çš„æ¿å­é¢˜ï¼Œæ¯”æœ€å¤§å¼‚æˆ–å’Œè¿˜è¦æ¿å­äº›ã€‚ç›¸ä¿¡ $60â€‹$ åˆ†å…¥é—¨è€…éƒ½ä¼šåšï¼Œé‚£ä¹ˆ $100â€‹$ åˆ†çš„è¯æˆ‘ä»¬ä¸Šå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘ç»´æŠ¤å‰ç¼€å¼‚æˆ–å’Œï¼Œå—¯æ²¡é”™å°±åƒä¸»å¸­æ ‘é‚£æ ·ã€‚ç„¶åå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å¯æŒä¹…åŒ– $trieâ€‹$ æ ‘æˆ‘ä»¬å°†å…¶å½“æˆåŒºé—´å³ç«¯ç‚¹ï¼Œç„¶ååœ¨æ­¤ä½ç½®ä¸Šçš„ $trieâ€‹$ æ ‘ä¸­è´ªå¿ƒå¯»æ‰¾å·¦ç«¯ç‚¹å³å¯ã€‚</p><a id="more"></a><p>å¯»æ‰¾å‰ $K$ å¤§åŒºé—´çš„å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">    q.push(MKP(T.query(T.root[i],sum[i],qrank[i]=<span class="number">1</span>),i));</span><br><span class="line"><span class="comment">/*å¯¹äºæ¯ä¸€ä¸ªå³ç«¯ç‚¹ï¼Œæ‰¾ä¸€ä¸ªç¬¬ä¸€å¤§(æœ€ä¼˜)çš„å·¦ç«¯ç‚¹æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—*/</span></span><br><span class="line">ll ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(k--) &#123;</span><br><span class="line">    ll i=q.top().second;<span class="comment">/*å–å‡ºå½“å‰æœ€ä¼˜å…ƒç´ */</span></span><br><span class="line">    ans+=q.top().first;q.pop();</span><br><span class="line">    <span class="keyword">if</span>(qrank[i]!=i) q.push(MKP(T.query(T.root[i],sum[i],++qrank[i]),i));</span><br><span class="line">    <span class="comment">/*æ›´æ–°é˜Ÿåˆ—å…ƒç´ */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤æ‚åº¦å¤§çº¦æ˜¯ $O(nlogn)â€‹$ çº§åˆ«ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MKP make_pair</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ll N=<span class="number">5e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> ll logN=<span class="number">33</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll n,k,sum[N],qrank[N];</span><br><span class="line">priority_queue&lt;pair&lt;ll,ll&gt; &gt; q;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Trie</span> &#123;</span></span><br><span class="line">    ll ch[N*logN][<span class="number">2</span>],sum[N*logN],root[N],tot;</span><br><span class="line">    <span class="function">ll <span class="title">newnode</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">        ++tot,ch[tot][<span class="number">0</span>]=ch[x][<span class="number">0</span>],ch[tot][<span class="number">1</span>]=ch[x][<span class="number">1</span>];</span><br><span class="line">        sum[tot]=sum[x];<span class="keyword">return</span> tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(ll&amp;rt,ll val)</span> </span>&#123;</span><br><span class="line">        rt=newnode(rt),++sum[rt];</span><br><span class="line">        ll now=rt;</span><br><span class="line">        <span class="keyword">for</span>(ll i=<span class="number">31</span>;~i;--i) &#123;</span><br><span class="line">            <span class="keyword">bool</span> son=(val&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">            ch[now][son]=newnode(ch[now][son]);</span><br><span class="line">            now=ch[now][son],++sum[now];</span><br><span class="line">        &#125;<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(ll now,ll val,ll k)</span> </span>&#123;</span><br><span class="line">        ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll i=<span class="number">31</span>;~i;--i) &#123;</span><br><span class="line">            <span class="keyword">bool</span> son=!((val&gt;&gt;i)&amp;<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(k&lt;=sum[ch[now][son]]) now=ch[now][son],ans|=(<span class="number">1u</span>&lt;&lt;i);</span><br><span class="line">            <span class="keyword">else</span> k-=sum[ch[now][son]],now=ch[now][!son];</span><br><span class="line">        &#125;<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IN(n),IN(k);</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>,x;i&lt;=n;++i) IN(x),sum[i]=sum[i<span class="number">-1</span>]^x;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">0</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(i) T.root[i]=T.root[i<span class="number">-1</span>];</span><br><span class="line">        T.Insert(T.root[i],sum[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        q.push(MKP(T.query(T.root[i],sum[i],qrank[i]=<span class="number">1</span>),i));</span><br><span class="line">    ll ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(k--) &#123;</span><br><span class="line">        ll i=q.top().second;</span><br><span class="line">        ans+=q.top().first;q.pop();</span><br><span class="line">        <span class="keyword">if</span>(qrank[i]!=i) q.push(MKP(T.query(T.root[i],sum[i],++qrank[i]),i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}â€‹$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦&lt;/p&gt;
&lt;p&gt;[åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­ï¼Œå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘çš„æ¿å­é¢˜ï¼Œæ¯”æœ€å¤§å¼‚æˆ–å’Œè¿˜è¦æ¿å­äº›ã€‚ç›¸ä¿¡ $60â€‹$ åˆ†å…¥é—¨è€…éƒ½ä¼šåšï¼Œé‚£ä¹ˆ $100â€‹$ åˆ†çš„è¯æˆ‘ä»¬ä¸Šå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘ç»´æŠ¤å‰ç¼€å¼‚æˆ–å’Œï¼Œå—¯æ²¡é”™å°±åƒä¸»å¸­æ ‘é‚£æ ·ã€‚ç„¶åå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å¯æŒä¹…åŒ– $trieâ€‹$ æ ‘æˆ‘ä»¬å°†å…¶å½“æˆåŒºé—´å³ç«¯ç‚¹ï¼Œç„¶ååœ¨æ­¤ä½ç½®ä¸Šçš„ $trieâ€‹$ æ ‘ä¸­è´ªå¿ƒå¯»æ‰¾å·¦ç«¯ç‚¹å³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å¯æŒä¹…åŒ–Trieæ ‘" scheme="http://qiulyblog.github.io/tags/%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%96Trie%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[HNOI2019]ç™½å…”ä¹‹èˆ  å•ä½æ ¹åæ¼”+MTT  luoguP5293</title>
    <link href="http://qiulyblog.github.io/2019/04/17/%5B%E9%A2%98%E8%A7%A3%5DluoguP5293/"/>
    <id>http://qiulyblog.github.io/2019/04/17/[é¢˜è§£]luoguP5293/</id>
    <published>2019-04-16T16:00:00.000Z</published>
    <updated>2019-04-18T01:53:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>å•ä½æ ¹åæ¼”ä¸ä¼šå•Šæ€ä¹ˆæ $FFT$ å§ï¼Œè¿˜æ˜¯äº†è§£äº†å•ä½æ ¹åæ¼”åæ‰å¯ä»¥æçš„å¥½å§â€¦â€¦å±…ç„¶æœ‰äººåæ§½æˆ‘è¯´æˆ‘<strong>å­¦äº† $FFTâ€‹$ ä½†æ˜¯ä¸ä¼šè¿ç”¨ï¼Ÿï¼</strong>ï¼Œå˜¤å˜¤å˜¤æ‰“å‡»æœ‰äº›å¤§â€¦â€¦</p><p>å®é™…ä¸Šæ‰€è°“çš„å•ä½æ ¹åæ¼”å°±æ˜¯è¿™ä¸ªä¸œè¥¿ï¼š</p><script type="math/tex; mode=display">\frac{1}{n}\sum_{i=0}^{n-1}(\omega_n^d)^i=[n|d]</script><a id="more"></a><p>å›åˆ°é¢˜ç›®ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘æ­£è§£çš„ç®€åŒ–ç‰ˆâ€”â€” $n=1$ çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ $W=w[1][1]$ ã€‚</p><p>ç°åœ¨å¯¹äºæ¯ä¸€ä¸ª $t$ çš„ç­”æ¡ˆæ˜¾ç„¶ä¸º $\sum_{i=0}^{L}[i\% k=t] W^i (^L_i)$</p><p>è¿™ä¸ªå¼å­æ˜¾ç„¶ç­‰äº $\sum_{i=0}^{L}[k|(i-t)] w^i (^L_i)$ ã€‚ä¼šå‘ç° $[k|(i-t)]$ å’Œä¸Šé¢å•ä½æ ¹åæ¼”çš„ $[n|d]$ ä¸€æ ·ï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•å°†å•ä½æ ¹åæ¼”çš„å¼å­å¸¦è¿›å»ã€‚</p><script type="math/tex; mode=display">=\sum_{i=0}^{L}\frac{1}{k}\sum_{j=0}^{k-1}(\omega_k^{i-t})^j W^i \binom{L}{i}\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}\sum_{i=0}^{L} \omega_k^{ij} W^i \binom{L}{i}\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}\sum_{i=0}^{L} \binom{L}{i}(\omega_k^{j} W)^i\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}\sum_{i=0}^{L} \binom{L}{i}(\omega_k^{j} W)^i 1^{n-i}\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}(\omega_k^{j} W+1)^L</script><p>åé¢çš„ $(\omega_k^{j} W+1)^L$ æ˜¾ç„¶å¯ä»¥é¢„å¤„ç†ï¼Œè®°ä¸º $num_j$ ã€‚</p><p>ç„¶åå‘ç° $-tj=\binom{t}{2}+\binom{j}{2}-\binom{t+j}{2}$</p><script type="math/tex; mode=display">=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{\binom{t}{2}+\binom{j}{2}-\binom{t+j}{2}}num_j\\\\=\frac{1}{k}\omega_k^{\binom{t}{2}}\sum_{j=0}^{k-1}num_j\omega_k^{\binom{j}{2}}\cdot\omega_k^{-\binom{t+j}{2}}</script><p>åé¢çš„å¼å­å¯ä»¥ç”¨ $FFT$ åŠ é€Ÿï¼Œä½†æ˜¯å€¼åŸŸå¤ªå¤§è¿™é‡Œéœ€è¦ç”¨åˆ° $MTT$ ã€‚ç°åœ¨å°±æœ‰ $40$ åˆ†äº†ï¼Œæ¥ä¸‹æ¥è€ƒè™‘ $n&gt;1$ çš„æƒ…å†µã€‚</p><p>æˆ‘ä»¬å»ºçŸ©é˜µï¼Œç„¶åä¼šå‘ç° $n&gt;1$ ä»…ä¼šå¯¹ $num_j$ çš„è®¡ç®—æ–¹å¼æœ‰å˜åŒ–ã€‚</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª $begin$ çŸ©é˜µï¼Œè¯¥çŸ©é˜µåªæœ‰ $(0,x)$ ä½ç½®ä¸Šæœ‰å€¼ä¸”å€¼ä¸º $1$ ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ç™½å…”çš„èµ·ç‚¹ã€‚é‚£ä¹ˆæœ€åæˆ‘ä»¬éœ€è¦ç•™ä¸‹æ¥çš„ä¹Ÿå°±æ˜¯çŸ©é˜µçš„ $(0,y)$ ï¼Œå› ä¸ºåªæœ‰åœ¨ç¬¬äºŒç»´ä¸º $y$ æ˜¯æ‰ä¼šè®¡å…¥ç­”æ¡ˆã€‚</p><p>å—¯ï¼Œå·®ä¸å¤šå¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">begin.c[<span class="number">0</span>][x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) </span><br><span class="line">    num[i]=(begin*<span class="built_in">pow</span>(w*num[i]+I,n)).c[<span class="number">0</span>][y]%MOD;</span><br><span class="line"><span class="comment">/*wå°±æ˜¯ä¸Šæ–‡ä¸­çš„Wï¼Œä¸è¿‡è¿™é‡Œæ˜¯çŸ©é˜µ*/</span></span><br><span class="line"><span class="comment">/*Iæ˜¯çŸ©é˜µä¸­çš„å•ä½'1'*/</span></span><br></pre></td></tr></table></figure><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">65536</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI=<span class="built_in">acos</span>(<span class="number">-1</span>);   </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m,k,n,x,y,MOD,G,num[N],A[N&lt;&lt;<span class="number">2</span>],B[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> F(x,i,j) for((x)=(i);(x)&lt;=(j);++(x))</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">IN</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;ll x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;<span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">matrix</span> &#123;</span><span class="keyword">int</span> c[<span class="number">3</span>][<span class="number">3</span>];matrix()&#123;<span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span>(c));&#125;&#125;;</span><br><span class="line">    matrix <span class="keyword">operator</span> + (<span class="keyword">const</span> matrix&amp;a,<span class="keyword">const</span> matrix&amp;b) &#123;</span><br><span class="line">        matrix ans;<span class="keyword">int</span> i,j;F(i,<span class="number">0</span>,<span class="number">2</span>)F(j,<span class="number">0</span>,<span class="number">2</span>) &#123;</span><br><span class="line">            ans.c[i][j]=a.c[i][j]+b.c[i][j];</span><br><span class="line">            <span class="keyword">if</span>(ans.c[i][j]&gt;=MOD) ans.c[i][j]-=MOD;</span><br><span class="line">        &#125;<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> matrix&amp;a,<span class="keyword">const</span> matrix&amp;b) &#123;</span><br><span class="line">        matrix ans;<span class="keyword">int</span> i,j,k;F(i,<span class="number">0</span>,<span class="number">2</span>)F(j,<span class="number">0</span>,<span class="number">2</span>)F(k,<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">            ans.c[i][k]=(ans.c[i][k]+<span class="number">1l</span>l*a.c[i][j]*b.c[j][k])%MOD;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> matrix&amp;a,<span class="keyword">const</span> <span class="keyword">int</span>&amp;b) &#123;</span><br><span class="line">        matrix ans;<span class="keyword">int</span> i,j;F(i,<span class="number">0</span>,<span class="number">2</span>)F(j,<span class="number">0</span>,<span class="number">2</span>)ans.c[i][j]=<span class="number">1l</span>l*a.c[i][j]*b%MOD;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">complex</span>&#123;</span><span class="keyword">complex</span>(<span class="keyword">long</span> <span class="keyword">double</span> a=<span class="number">0</span>,<span class="keyword">long</span> <span class="keyword">double</span> b=<span class="number">0</span>)&#123;x=a,y=b;&#125;<span class="keyword">long</span> <span class="keyword">double</span> x,y;&#125;;</span><br><span class="line">    <span class="keyword">complex</span> <span class="keyword">operator</span> + (<span class="keyword">complex</span> a,<span class="keyword">complex</span> b)&#123;<span class="keyword">return</span> <span class="keyword">complex</span>(a.x+b.x,a.y+b.y);&#125;</span><br><span class="line">    <span class="keyword">complex</span> <span class="keyword">operator</span> - (<span class="keyword">complex</span> a,<span class="keyword">complex</span> b)&#123;<span class="keyword">return</span> <span class="keyword">complex</span>(a.x-b.x,a.y-b.y);&#125;</span><br><span class="line">    <span class="keyword">complex</span> <span class="keyword">operator</span> * (<span class="keyword">complex</span> a,<span class="keyword">complex</span> b)&#123;<span class="keyword">return</span> <span class="keyword">complex</span>(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);&#125;</span><br><span class="line">    matrix I;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pow</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">1</span>;<span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=<span class="number">1l</span>l*x*x%MOD) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=<span class="number">1l</span>l*res*x%MOD;</span><br><span class="line">        <span class="keyword">return</span> res%MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> matrix <span class="title">pow</span><span class="params">(matrix x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        matrix res=I;<span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=x*x) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=res*x;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> MTT &#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> BLOCK 32768</span></span><br><span class="line">    <span class="keyword">int</span> limit=<span class="number">1</span>,cnt=<span class="number">0</span>,filp[N&lt;&lt;<span class="number">2</span>],Ans[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">complex</span> A1[N&lt;&lt;<span class="number">2</span>],B1[N&lt;&lt;<span class="number">2</span>],A2[N&lt;&lt;<span class="number">2</span>],B2[N&lt;&lt;<span class="number">2</span>],X[N&lt;&lt;<span class="number">2</span>],omg[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fft</span><span class="params">(<span class="keyword">complex</span> *f,<span class="keyword">short</span> inv)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)<span class="keyword">if</span>(i&lt;filp[i])<span class="built_in">std</span>::swap(f[i],f[filp[i]]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> p=<span class="number">1</span>;p&lt;limit;p&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">complex</span> *a=f;a!=f+limit;a+=(p&lt;&lt;<span class="number">1</span>))</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">0</span>;l&lt;p;++l)&#123;</span><br><span class="line">                    <span class="keyword">complex</span> t=a[l+p]*omg[limit/(p&lt;&lt;<span class="number">1</span>)*l];</span><br><span class="line">                    a[l+p]=a[l]-t,a[l]=a[l]+t;</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">mtt</span><span class="params">(<span class="keyword">int</span> *A,<span class="keyword">int</span> *B)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(limit&lt;(k*<span class="number">3</span>+<span class="number">5</span>)) limit&lt;&lt;=<span class="number">1</span>,++cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) filp[i]=(filp[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(cnt<span class="number">-1</span>));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) A1[i].x=A[i]&amp;(BLOCK<span class="number">-1</span>),A2[i].x=A[i]&gt;&gt;<span class="number">15</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) B1[i].x=B[i]&amp;(BLOCK<span class="number">-1</span>),B2[i].x=B[i]&gt;&gt;<span class="number">15</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) omg[i]=(<span class="keyword">complex</span>)&#123;<span class="built_in">cos</span>(i*PI*<span class="number">2</span>/limit),<span class="built_in">sin</span>(i*PI*<span class="number">2</span>/limit)&#125;;</span><br><span class="line">        fft(A1,<span class="number">1</span>),fft(B1,<span class="number">1</span>);fft(A2,<span class="number">1</span>),fft(B2,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)&#123;</span><br><span class="line">            <span class="keyword">complex</span> a1=A1[i],a2=A2[i],b1=B1[i],b2=B2[i];</span><br><span class="line">            A1[i]=a1*b1,A2[i]=a2*b2,B1[i]=a1*b2,B2[i]=a2*b1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) omg[i]=(<span class="keyword">complex</span>)&#123;<span class="built_in">cos</span>(i*PI*<span class="number">2</span>/limit),-<span class="built_in">sin</span>(i*PI*<span class="number">2</span>/limit)&#125;;</span><br><span class="line">        fft(A1,<span class="number">-1</span>),fft(B1,<span class="number">-1</span>);fft(A2,<span class="number">-1</span>),fft(B2,<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)</span><br><span class="line">            A1[i].x/=limit,A2[i].x/=limit,B1[i].x/=limit,B2[i].x/=limit;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)</span><br><span class="line">            Ans[i]=((ll)(A1[i].x+<span class="number">0.5</span>)%MOD+<span class="number">1073741824l</span>l*((ll)(A2[i].x+<span class="number">0.5</span>)%MOD)%MOD+</span><br><span class="line">            <span class="number">32768l</span>l*((ll)(B1[i].x+<span class="number">0.5</span>)%MOD)%MOD+<span class="number">32768l</span>l*((ll)(B2[i].x+<span class="number">0.5</span>)%MOD)%MOD)%MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> MTT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> divisor[<span class="number">105</span>],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get_G</span><span class="params">()</span> </span>&#123;<span class="comment">/*è·å–åŸæ ¹*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>,S=MOD<span class="number">-1</span>;i&lt;=S;++i) </span><br><span class="line">        <span class="keyword">if</span>(S%i==<span class="number">0</span>) &#123;divisor[++tot]=i;<span class="keyword">while</span>(!(S%i)) S/=i;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> g=<span class="number">2</span>;;++g) &#123;</span><br><span class="line">        <span class="keyword">bool</span> ok=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=tot;++j) <span class="keyword">if</span>(<span class="built_in">pow</span>(g,(MOD<span class="number">-1</span>)/divisor[j])==<span class="number">1</span>) &#123;ok=<span class="literal">false</span>;<span class="keyword">break</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(ok) <span class="keyword">return</span> g;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">matrix w,s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    I.c[<span class="number">0</span>][<span class="number">0</span>]=I.c[<span class="number">1</span>][<span class="number">1</span>]=I.c[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">1</span>;</span><br><span class="line">    m=IN(),k=IN(),n=IN(),x=IN(),y=IN(),MOD=IN();--x,--y;</span><br><span class="line">    <span class="comment">/*numå…¶å®å°±æ˜¯ä¸Šæ–‡ä¸­çš„å•ä½æ ¹ï¼Œè¿™é‡Œé¢„å¤„ç†ä¸€ä¸‹è®¡ç®—æ–¹ä¾¿äº›*/</span></span><br><span class="line">    num[<span class="number">0</span>]=<span class="number">1</span>,num[<span class="number">1</span>]=<span class="built_in">pow</span>(G=get_G(),(MOD<span class="number">-1</span>)/k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;k;++i) num[i]=<span class="number">1l</span>l*num[<span class="number">1</span>]*num[i<span class="number">-1</span>]%MOD;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i) <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j) w.c[i][j]=IN();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);++i) A[i]=num[(k<span class="number">-1l</span>l*i*(i<span class="number">-1</span>)/<span class="number">2</span>%k)%k];</span><br><span class="line">    s.c[<span class="number">0</span>][x]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) B[i]=<span class="number">1l</span>l*num[<span class="number">1l</span>l*i*(i<span class="number">-1</span>)/<span class="number">2</span>%k]*(s*<span class="built_in">pow</span>(w*num[i]+I,n)).c[<span class="number">0</span>][y]%MOD;</span><br><span class="line">    <span class="comment">/*è®¡ç®—åé¢ä¸¤ä¸ªå¤šé¡¹å¼çš„å€¼*/</span></span><br><span class="line">    reverse(B,B+k+<span class="number">1</span>),mtt(A,B);</span><br><span class="line">    <span class="keyword">int</span> invk=<span class="built_in">pow</span>(k,MOD<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,<span class="number">1l</span>l*Ans[i+k]*invk%MOD*num[<span class="number">1l</span>l*i*(i<span class="number">-1</span>)/<span class="number">2</span>%k]%MOD);</span><br><span class="line">    <span class="comment">/*è®¡ç®—ç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å•ä½æ ¹åæ¼”ä¸ä¼šå•Šæ€ä¹ˆæ $FFT$ å§ï¼Œè¿˜æ˜¯äº†è§£äº†å•ä½æ ¹åæ¼”åæ‰å¯ä»¥æçš„å¥½å§â€¦â€¦å±…ç„¶æœ‰äººåæ§½æˆ‘è¯´æˆ‘&lt;strong&gt;å­¦äº† $FFTâ€‹$ ä½†æ˜¯ä¸ä¼šè¿ç”¨ï¼Ÿï¼&lt;/strong&gt;ï¼Œå˜¤å˜¤å˜¤æ‰“å‡»æœ‰äº›å¤§â€¦â€¦&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šæ‰€è°“çš„å•ä½æ ¹åæ¼”å°±æ˜¯è¿™ä¸ªä¸œè¥¿ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{1}{n}\sum_{i=0}^{n-1}(\omega_n^d)^i=[n|d]&lt;/script&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="FFT" scheme="http://qiulyblog.github.io/tags/FFT/"/>
    
      <category term="å•ä½æ ¹åæ¼”" scheme="http://qiulyblog.github.io/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/"/>
    
      <category term="MTT" scheme="http://qiulyblog.github.io/tags/MTT/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2019]æ ¡å›­æ—…è¡Œ ç”Ÿæˆæ ‘+DP luoguP5292</title>
    <link href="http://qiulyblog.github.io/2019/04/14/%5B%E9%A2%98%E8%A7%A3%5DluoguP5292/"/>
    <id>http://qiulyblog.github.io/2019/04/14/[é¢˜è§£]luoguP5292/</id>
    <published>2019-04-13T16:00:00.000Z</published>
    <updated>2019-04-18T01:59:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>$myy$ å‡ºçš„ç¥é¢˜â€¦â€¦è²Œä¼¼æ­£è§£å¹¶ä¸éš¾ä½†æ˜¯æ²¡æœ‰äººåˆ‡â€¦â€¦</p><p>$30$ åˆ†å¯ä»¥ç”¨ $DP$ ï¼Œè®¾ $f[i][j]$ è¡¨ç¤º $i$ åˆ° $j$ æ˜¯å¦æœ‰ä¸€æ¡æ»¡è¶³æ¡ä»¶çš„è·¯å¾„ã€‚å¯¹äºæœ‰ä¸€æ¡æ»¡è¶³æ¡ä»¶çš„è·¯å¾„çš„ $i,j$ ï¼Œæˆ‘ä»¬æšä¸¾è¿æ¥ $i$ çš„ç‚¹å’Œè¿æ¥ $j$ çš„ç‚¹ï¼Œå¦‚æœè¿™ä¸¤ä¸ªç‚¹çš„æ ‡è®°ç›¸åŒï¼Œé‚£ä¹ˆæ—¢ç„¶ $i,jâ€‹$ åˆæ³•ï¼Œè¿™ä¸¤ä¸ªç‚¹ä¹Ÿä¸€å®šåˆæ³•ã€‚</p><p>ä¸è¿‡è¿™æ ·çš„å¤æ‚åº¦æ˜¯ $O(m^2)$ çš„ï¼Œæ‰€ä»¥åªèƒ½è¿‡ $30$ åˆ†ã€‚</p><a id="more"></a><p>ç„¶åè€ƒè™‘ä¼˜åŒ–ï¼Œæˆ‘ä»¬å‘ç°æ‰€æœ‰çš„è¾¹ä¹Ÿå°±åªæœ‰ä¸‰ç§ï¼š</p><ul><li>è¯¥è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹çš„æ ‡è®°ç›¸åŒ<ul><li>ä¸¤ä¸ªç‚¹çš„æ ‡è®°éƒ½ä¸º $1$</li><li>ä¸¤ä¸ªç‚¹çš„æ ‡è®°éƒ½ä¸º $0â€‹$</li></ul></li><li>æ”¹è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹çš„æ ‡è®°ä¸åŒ</li></ul><p>ç„¶åæˆ‘ä»¬å¼€ $3$ ä¸ªå›¾ï¼Œå¯¹äºæ¯ä¸€æ¡è¯»å…¥è¿›æ¥çš„è¾¹ï¼Œå¦‚æœå±äºç¬¬ä¸€ç§å°±æ’å…¥åˆ°ç¬¬ä¸€ä¸ªå›¾ä¸­ï¼Œå…¶ä»–åŒç†ã€‚</p><p>ç„¶åä¼šå‘ç°è¿™ä¸‰ä¸ªå›¾éƒ½æ˜¯æœ‰è‹¥å¹²ä¸ªè¿é€šå—ç»„æˆçš„ï¼Œå¯ä»¥çŸ¥é“ï¼Œå¦‚æœæˆ‘ä»¬ç•™ä¸‹æ¥çš„ä»…æ˜¯è¯¥è¿é€šå—çš„ç”Ÿæˆæ ‘ä¹Ÿä¸ä¼šå¯¹ç­”æ¡ˆäº§ç”Ÿå½±å“ï¼Œä½†æ˜¯è¾¹æ•°å´å¤§å¤§å‡å°‘ï¼</p><p>ä½†æ˜¯ç›´æ¥å¯¹æ¯ä¸ªè¿é€šå—æ±‚ç”Ÿæˆæ ‘æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸º<strong>ç”Ÿæˆæ ‘ä¸Šä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·¯å¾„ç»è¿‡çš„è¾¹çš„æ¡æ•°çš„å¥‡å¶æ˜¯ç¡®å®šçš„</strong>ï¼Œå¹¶ä¸”åªæœ‰<strong>äºŒåˆ†å›¾</strong>æ»¡è¶³è¯¥æ¡ä»¶ï¼Œä¸è¿‡æˆ‘ä»¬æ— æ³•ä¿è¯è¿é€šå—æ˜¯äºŒåˆ†å›¾ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿é€šå—ä¸­çš„ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·¯å¾„ç»è¿‡çš„è¾¹çš„æ¡æ•°çš„å¥‡å¶æ˜¯ä¸ç¡®å®šçš„ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨éœ€è¦åšçš„å°±æ˜¯ï¼Œå¦‚ä½•ä½¿å¾—ä¸æ˜¯äºŒåˆ†å›¾çš„è¿é€šå—æ‰€æ±‚å‡ºçš„ç”Ÿæˆæ ‘å¯ä»¥æ»¡è¶³â€”â€”ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·¯å¾„ç»è¿‡çš„è¾¹çš„æ¡æ•°çš„å¥‡å¶æ˜¯ä¸ç¡®å®šçš„ã€‚</p><p>ä»”ç»†æƒ³æƒ³åå‘ç°å¹¶ä¸éš¾ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç”Ÿæˆæ ‘ä¸ŠåŠ ä¸Šä¸€ä¸ªå¥‡ç¯å°±å¥½äº†ï¼Œå½“ç„¶ä¹Ÿç­‰ä»·äºåœ¨ç”Ÿæˆæ ‘ä¸Šçš„æŸä¸€ä¸ªç‚¹ä¸ŠåŠ ä¸ªè‡ªç¯ã€‚</p><p>è¿™å°±å¾ˆå¥½åŠäº†ï¼Œç°åœ¨æˆ‘ä»¬çš„è¾¹æ•°å·²ç»å¤§å¤§å‡å°‘äº†ï¼Œè¿™ä¸ªæ—¶å€™å†è·‘åŸå…ˆçš„ $30$ åˆ†ç®—æ³•å°±å¯ä»¥è¿‡äº†ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MKP make_pair</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e3</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M=<span class="number">5e5</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,q,s[N],vis[N],f[N][N];</span><br><span class="line"><span class="keyword">int</span> flag,sta[N],top;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Graph</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> head[N],nxt[M&lt;&lt;<span class="number">1</span>],to[M&lt;&lt;<span class="number">1</span>],from[N],cnt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        ++cnt,nxt[cnt]=head[u],to[cnt]=v,head[u]=cnt;</span><br><span class="line">        ++cnt,nxt[cnt]=head[v],to[cnt]=u,head[v]=cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> col)</span> </span>&#123;</span><br><span class="line">        vis[u]=col,sta[++top]=u;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=nxt[i])</span><br><span class="line">            <span class="keyword">if</span>(!vis[to[i]]) from[to[i]]=u,check(to[i],<span class="number">3</span>-col);</span><br><span class="line">            <span class="keyword">else</span> flag|=(vis[to[i]]!=<span class="number">3</span>-col);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; q;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty()) q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][i]=<span class="number">1</span>,q.push(MKP(i,i));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=head[i];j;j=nxt[j])</span><br><span class="line">                <span class="keyword">if</span>(s[i]==s[to[j]]) f[i][to[j]]=<span class="number">1</span>,q.push(MKP(i,to[j]));</span><br><span class="line">        <span class="keyword">while</span>(!q.empty()) &#123;</span><br><span class="line">            <span class="keyword">int</span> x=q.front().first,y=q.front().second,u,v;</span><br><span class="line">            q.pop();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=nxt[i])</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=head[y];j;j=nxt[j]) </span><br><span class="line">                    <span class="keyword">if</span>(!f[u=to[i]][v=to[j]]&amp;&amp;s[u]==s[v])</span><br><span class="line">                        f[u][v]=f[v][u]=<span class="number">1</span>,q.push(MKP(u,v));</span><br><span class="line">        &#125;<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;G[<span class="number">3</span>],t;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(m),IN(q);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,str);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) s[i+<span class="number">1</span>]=str[i]-<span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;IN(x),IN(y);</span><br><span class="line">        <span class="keyword">if</span>(s[x]==s[y]) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[x]) G[<span class="number">0</span>].ins(x,y);</span><br><span class="line">            <span class="keyword">else</span> G[<span class="number">1</span>].ins(x,y);</span><br><span class="line">        &#125; <span class="keyword">else</span> G[<span class="number">2</span>].ins(x,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=<span class="number">2</span>;++k) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(!vis[i]) &#123;</span><br><span class="line">            flag=top=<span class="number">0</span>,G[k].check(i,<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span>(top) &#123;</span><br><span class="line">                <span class="keyword">int</span> x=sta[top];</span><br><span class="line">                <span class="keyword">if</span>(G[k].from[x]) t.ins(G[k].from[x],x);</span><br><span class="line">                --top;</span><br><span class="line">            &#125;<span class="keyword">if</span>(flag) t.ins(i,i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    t.solve();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,x,y;i&lt;=q;++i) </span><br><span class="line">        IN(x),IN(y),<span class="built_in">printf</span>(f[x][y]?<span class="string">"YES\n"</span>:<span class="string">"NO\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢â€¦â€¦å…¶å®è¿™ä»½ä»£ç åœ¨ $luogu$ ä¸Šä¼šè¢«å¡æˆ $70$ ï¼Œä¸è¿‡é‚£æ˜¯åœ¨æ²¡å¼€ $O2$ çš„æƒ…å†µä¸‹çš„ï¼Œå¼€äº† $O2$ é¡¿æ—¶é£èµ·ï¼(å¹¸å¥½è¿™é¢˜åœ¨è€ƒåœºä¸Šå°±æ˜¯å¼€ $O2$ çš„)ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;$myy$ å‡ºçš„ç¥é¢˜â€¦â€¦è²Œä¼¼æ­£è§£å¹¶ä¸éš¾ä½†æ˜¯æ²¡æœ‰äººåˆ‡â€¦â€¦&lt;/p&gt;
&lt;p&gt;$30$ åˆ†å¯ä»¥ç”¨ $DP$ ï¼Œè®¾ $f[i][j]$ è¡¨ç¤º $i$ åˆ° $j$ æ˜¯å¦æœ‰ä¸€æ¡æ»¡è¶³æ¡ä»¶çš„è·¯å¾„ã€‚å¯¹äºæœ‰ä¸€æ¡æ»¡è¶³æ¡ä»¶çš„è·¯å¾„çš„ $i,j$ ï¼Œæˆ‘ä»¬æšä¸¾è¿æ¥ $i$ çš„ç‚¹å’Œè¿æ¥ $j$ çš„ç‚¹ï¼Œå¦‚æœè¿™ä¸¤ä¸ªç‚¹çš„æ ‡è®°ç›¸åŒï¼Œé‚£ä¹ˆæ—¢ç„¶ $i,jâ€‹$ åˆæ³•ï¼Œè¿™ä¸¤ä¸ªç‚¹ä¹Ÿä¸€å®šåˆæ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡è¿™æ ·çš„å¤æ‚åº¦æ˜¯ $O(m^2)$ çš„ï¼Œæ‰€ä»¥åªèƒ½è¿‡ $30$ åˆ†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ç”Ÿæˆæ ‘" scheme="http://qiulyblog.github.io/tags/%E7%94%9F%E6%88%90%E6%A0%91/"/>
    
  </entry>
  
</feed>
