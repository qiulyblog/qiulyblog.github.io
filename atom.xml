<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Qiuly&#39;s blog!</title>
  
  <subtitle>A weak OIer from HN-YZ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://qiulyblog.github.io/"/>
  <updated>2019-05-07T02:42:18.017Z</updated>
  <id>http://qiulyblog.github.io/</id>
  
  <author>
    <name>Qiuly</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2009]åŒé€’å¢åºåˆ—  çº¿æ€§DP  luoguP4728</title>
    <link href="http://qiulyblog.github.io/2019/05/07/%5B%E9%A2%98%E8%A7%A3%5DluoguP4728/"/>
    <id>http://qiulyblog.github.io/2019/05/07/[é¢˜è§£]luoguP4728/</id>
    <published>2019-05-06T16:00:00.000Z</published>
    <updated>2019-05-07T02:42:18.017Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®è¿™é¢˜å¾ˆå®¹æ˜“è®¾å‡ºå››ç»´çš„ $\rm{DP}$ ï¼Œä¹Ÿå°±æ˜¯ç”¨ $dp_{i,j,x,y}$ è¡¨ç¤º<strong>ç¬¬ä¸€ä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $i$ ä¸”é•¿åº¦ä¸º $x$ï¼Œç¬¬äºŒä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $j$ ä¸”é•¿åº¦ä¸º $y$ æ˜¯å¦æˆç«‹</strong> ï¼Œç„¶åä¹Ÿå¾ˆå®¹æ˜“æƒ³åˆ°é™ç»´ï¼Œæšä¸¾å½“å‰åºåˆ—é•¿åº¦ $len$ çš„æ—¶å€™çŸ¥é“äº† $x$ å°±å·²ç»çŸ¥é“ $y$ äº†â€”â€” $y$ å°±æ˜¯ $len-x$ ã€‚ä¹Ÿå°±æ˜¯è¯´ç°åœ¨çš„ $DP$ æ˜¯ $O(n^3)$ çš„ï¼Œè¿˜éœ€è¦ä¼˜åŒ–ã€‚</p><a id="more"></a><p>è€ƒè™‘è®¾ $dp_{i,j}$ è¡¨ç¤ºç¬¬ä¸€ä¸ªåºåˆ—çš„æœ€ç»ˆä½ç½®ä¸º $i-1$ ä¸”é•¿åº¦ä¸º $j$ æ—¶ç¬¬äºŒä¸ªåºåˆ—çš„æœ€ç»ˆä½ç½®çš„æœ€å°å€¼ã€‚æšä¸¾å½“å‰æ•°å­— $i$ ï¼Œç„¶ååˆ†ä¸¤ç§æƒ…å†µè¿›è¡Œè½¬ç§»â€”â€”å°† $a_i$ æ”¾åˆ°ç¬¬ä¸€ä¸ªåºåˆ—æœ«å°¾ $\texttt{and}$ å°† $a_i$ æ”¾åˆ°ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾ã€‚</p><p>æ”¾åˆ°ç¬¬ä¸€ä¸ªåºåˆ—æœ«å°¾å¾ˆå¥½æƒ³ï¼šå› ä¸ºå½“å‰ç¬¬ä¸€ä¸ªåºåˆ—çš„ç»“å°¾å¤„å°±æ˜¯ $a_{i-1}$ ï¼Œæ¯”è¾ƒä¸€ä¸‹å¤§å°ç›´æ¥è½¬ç§»å°±å¥½äº†ï¼š</p><script type="math/tex; mode=display">dp_{i,j}=min(dp_{i,j},dp_{i-1,j-1}) \ \ \ (a_i>a_{i-1})</script><p>å› ä¸ºç¬¬äºŒä¸ªåºåˆ—çš„æœ«å°¾æ²¡å˜ï¼Œæ‰€æœ‰ç›´æ¥è½¬ç§»å°±å¥½ã€‚</p><p>æ¥ä¸‹æ¥è€ƒè™‘å°†ç¬¬ $i$ ä¸ªæ•°æ”¾åˆ°ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾çš„æƒ…å†µï¼Œå…¶å®ç¬¬ä¸€ä¸ªåºåˆ—å’Œç¬¬äºŒä¸ªåºåˆ—æ²¡åŒºåˆ«ï¼Œå½“ç„¶é™¤äº†åå­—ä¸Šæœ‰ä¸€ä¸ªå­—çš„å·®å¼‚ï¼Œå‡è®¾ç¬¬ $i-1$ ä¸ªæ•°æ˜¯ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾ï¼Œå½“å‰ç¬¬ä¸€ä¸ªåºåˆ—çš„é•¿åº¦ä¸º $j-1$ ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªåºåˆ—çš„é•¿åº¦å› è¯¥å°±æ˜¯ $(i-1)-(j-1)$ äº†ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾äº†ç¬¬ $i-1$ ä¸ªæ•°æ˜¯ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾ï¼Œé‚£ä¹ˆ $dp_{i-1,i-j}$ åˆå¯ä»¥è¢«è§£é‡Šä¸º<strong>ç¬¬äºŒä¸ªåºåˆ—çš„æœ«å°¾ä¸º $i-1$ ä¸ªæ•°ä¸”ç¬¬äºŒä¸ªåºåˆ—çš„é•¿åº¦ä¸º $i-j$ çš„æ—¶å€™ç¬¬ä¸€ä¸ªåºåˆ—çš„æœ«å°¾çš„æœ€å°å€¼</strong> ï¼Œå¦‚æœè¿™ä¸ªæœ€å°å€¼å°äº $a_i$ ï¼Œè¯´æ˜ $a_i$ å¯ä»¥æ¥åˆ°ç¬¬ä¸€ä¸ªåºåˆ—å‰é¢ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¬¬äºŒä¸ªåºåˆ—çš„æœ«å°¾ä¸º $a_{i-1}$ ï¼Œæ˜¾ç„¶åˆæœ‰è½¬ç§»ï¼š</p><script type="math/tex; mode=display">dp_{i,j}=min(dp_{i,j},a_{i-1}) \ \ \ (a_i>dp_{i-1,i-j})</script><p>å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬å°† $dp$ æ•°ç»„èµ‹æˆæå¤§å€¼ï¼Œç„¶åæœ€ååˆ¤æ–­ä¸€ä¸‹ $dp_{n,n/2}$ è¿™ä¸ªçŠ¶æ€å˜å°æ²¡æœ‰å°±å¥½ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e3</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N],f[N][N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;IN(n);</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    a[<span class="number">0</span>]=f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        f[i][<span class="number">0</span>]=a[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i&amp;&amp;j&lt;=n/<span class="number">2</span>;++j) &#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i]&gt;a[i<span class="number">-1</span>]) f[i][j]=min(f[i][j],f[i<span class="number">-1</span>][j<span class="number">-1</span>]);</span><br><span class="line">            <span class="keyword">if</span>(a[i]&gt;f[i<span class="number">-1</span>][i-j]) f[i][j]=min(f[i][j],a[i<span class="number">-1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">return</span> f[n][n/<span class="number">2</span>]&lt;<span class="number">0x3f3f3f3f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;IN(T);</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">puts</span>(solve()?<span class="string">"Yes!"</span>:<span class="string">"No!"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰è¿™é“é¢˜çš„ç¡®å¾ˆç»•â€¦â€¦=ã€‚=</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®è¿™é¢˜å¾ˆå®¹æ˜“è®¾å‡ºå››ç»´çš„ $\rm{DP}$ ï¼Œä¹Ÿå°±æ˜¯ç”¨ $dp_{i,j,x,y}$ è¡¨ç¤º&lt;strong&gt;ç¬¬ä¸€ä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $i$ ä¸”é•¿åº¦ä¸º $x$ï¼Œç¬¬äºŒä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $j$ ä¸”é•¿åº¦ä¸º $y$ æ˜¯å¦æˆç«‹&lt;/strong&gt; ï¼Œç„¶åä¹Ÿå¾ˆå®¹æ˜“æƒ³åˆ°é™ç»´ï¼Œæšä¸¾å½“å‰åºåˆ—é•¿åº¦ $len$ çš„æ—¶å€™çŸ¥é“äº† $x$ å°±å·²ç»çŸ¥é“ $y$ äº†â€”â€” $y$ å°±æ˜¯ $len-x$ ã€‚ä¹Ÿå°±æ˜¯è¯´ç°åœ¨çš„ $DP$ æ˜¯ $O(n^3)$ çš„ï¼Œè¿˜éœ€è¦ä¼˜åŒ–ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HEOI2013]SAO  ç»„åˆæ•°å­¦+æ ‘å½¢DP  luoguP4099</title>
    <link href="http://qiulyblog.github.io/2019/05/06/%5B%E9%A2%98%E8%A7%A3%5DluoguP4099/"/>
    <id>http://qiulyblog.github.io/2019/05/06/[é¢˜è§£]luoguP4099/</id>
    <published>2019-05-05T16:00:00.000Z</published>
    <updated>2019-05-06T10:07:38.445Z</updated>
    
    <content type="html"><![CDATA[<p>$loj$ ä¸Šæ²¡æœ‰æ­¤é¢˜ï¼Œ$bzoj$ ä¸Šæ˜¯æƒé™é¢˜ï¼Œå¯¹äºä¸ä¸Š $yzoj$ çš„æˆ‘æ¥è¯´åªèƒ½å»æ´›è°·åšé¢˜äº†ï¼š<a href="https://www.luogu.org/problemnew/show/P4099" target="_blank" rel="noopener">è½¬é€é—¨ğŸ˜„</a> ã€‚</p><p>æˆ‘ä»¬å…ˆä¸è€ƒè™‘è¾¹çš„æƒå€¼(&lt;ä¸&gt;)ï¼Œè¿™æ ·å­ $n-1$ æ¡è¾¹ç»„æˆçš„å°±æ˜¯æ ‘äº†ï¼Œå¾ˆæ˜¾ç„¶æ˜¯éœ€è¦æˆ‘ä»¬æ±‚å‡ºè¿™æ£µæ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„ä¸ªæ•°ï¼Œè€ƒè™‘ä½¿ç”¨ $\rm{DP}$ ï¼Œå¯¹äºè¾¹çš„æ–¹å‘(å³&lt;,&gt;) ï¼Œæˆ‘ä»¬åˆ†ç±»è®¨è®ºå³å¯ã€‚</p><p>é¦–å…ˆçš„ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è®¾ $f_u$ è¡¨ç¤ºç‚¹ $u$ çš„å­æ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„æ€»æ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å¦‚ä½•è®¡ç®—å‘¢<a id="more"></a>ï¼Œå¯¹äºä¸€ä¸ª $u$ çš„å„¿å­ $v$ ï¼Œæˆ‘ä»¬è™½ç„¶çŸ¥é“ $u$ å’Œ $v$ çš„æ”»å…‹çš„å‰åå…³ç³»ï¼Œä½†æ˜¯åˆå¹¶ç­”æ¡ˆè²Œä¼¼å¹¶ä¸å¥½åˆå¹¶ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¢åŠ ä¸€ç»´ $j$ ï¼Œ$f_{u,j}$ è¡¨ç¤º $u$ çš„å­æ ‘çš„æ‰€æœ‰åˆæ³•æ‹“æ‰‘åºä¸­ $u$ åœ¨ç¬¬ $j$ ä½ä¸Šçš„æ€»çŠ¶æ€æ•°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªå¿…é¡»åœ¨ $u$ å‰é¢æ”»å…‹çš„å…³å¡ $v$ ï¼Œæˆ‘ä»¬è€ƒè™‘æšä¸¾ä¸€ä¸ª $j$ ï¼Œ$v$ å­æ ‘ä¸­ $j$ ä¸ªç»“ç‚¹åœ¨åˆå¹¶ $u,v$ åæ”¾åˆ° $u$ å‰é¢ï¼Œå¦å¤– $sz_v-j$ ä¸ªæ”¾åˆ° $u$ åé¢ï¼Œç„¶åæšä¸¾ä¸€ä¸ª $k$ ï¼Œè¡¨ç¤ºå½“å‰çš„ $v$ æ’åœ¨ $v$ å­æ ‘çš„æ‹“æ‰‘åºä¸­çš„ç¬¬ $k$ ä½ï¼Œåªæœ‰ $k\leq j$ çš„æ—¶å€™ $v$ æ‰å¯ä»¥è½¬ç§» $u$ ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ $v$ åœ¨ $u$ å‰é¢ã€‚</p><p>ç°åœ¨å†æ¥è€ƒè™‘$â€œ$ $j$ ä¸ªç»“ç‚¹æ”¾åœ¨ $u$ å‰é¢ $â€$ çš„æ–¹æ¡ˆæ•°å’Œ$â€œ$ $sz_v-j$ ä¸ªç»“ç‚¹æ”¾åœ¨ $u$ åé¢çš„æ–¹æ¡ˆæ•°$â€$ï¼Œè¿™ä¸ªæ˜¾ç„¶å¯ä»¥ç”¨ç»„åˆæ•°ç®—ï¼Œåˆå¹¶ $v$ çš„å­æ ‘åï¼Œ$u$ çš„æ’åä» $i$ å˜æˆäº† $i+j$ ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦å°† $j$ ä¸ªä¹±åºæ’å…¥åˆ° $u$ å‰é¢ $i+j-1$ ä¸ªæ•°ä¸­ï¼Œæ–¹æ¡ˆæ•°æ˜¾ç„¶ä¸º $C_{i+j-1}^{j}$ ï¼Œé‚£ä¹ˆç°åœ¨æ€»èŠ‚ç‚¹æ•°æ˜¾ç„¶ä¸º $sz_u+sz_v$ (ç°åœ¨ $sz_u$ å’Œ $sz_v$ è¿˜æ²¡æœ‰å¹¶åœ¨ä¸€èµ·) ï¼Œ$u$ åé¢ç†æ‰€å½“ç„¶æœ‰ $sz_u+sz_v-i-j$ ä¸ªä½ç½®ï¼Œå°† $sz_v-j$ ä¸ªæ•°æ’è¿›å»çš„æ–¹æ¡ˆæ•°æ˜¾ç„¶ä¸º $C_{sz_u+sz_v-i-j}^{sz_v-j}$ ä¸ªï¼Œè¿™ä¸¤ä¸ªæ•°å†ä¹˜ä¸Š $f_{u,i}$ å’Œ $f_{v,k}$ å°±å¥½äº†ï¼Œè¿™ä¸€æ¬¡åˆå¹¶å $u$ çš„ä½ç½®æ˜¾ç„¶åˆ°äº† $i+j$ ï¼Œæ‰€ä»¥ $f_{u,i+j}$ æ˜¾ç„¶è¦åŠ ä¸Šè¿™ä¸€ç»„è´¡çŒ®ã€‚</p><p>ç»æ•´ç†åçš„è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">pls(f_{u,i+j},f_{u,i}\cdot f_{v,k}\cdot C_{i+j-1}^{j}\cdot C_{sz_u+sz_v-i-j}^{sz_v-j})</script><p>ä»£ç å°±æ˜¯è¿™æ ·å†™ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i=<span class="number">1</span> to sz[u]</span><br><span class="line">    <span class="keyword">for</span> j=<span class="number">1</span> to sz[v]</span><br><span class="line">        <span class="keyword">for</span> k=<span class="number">1</span> to j</span><br><span class="line">            pls(f[u][i+j],f[u][i]*f[v][k]*C[i+j<span class="number">-1</span>][j]*C[sz[u]+sz[v]-i-j][sz[v]-j])</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ $n^3$ çš„ï¼Œè¿‡ä¸å»ã€‚è€ƒè™‘å‰ç¼€å’Œä¼˜åŒ–ï¼Œå‡ ä¸‹ $f_v$ çš„å‰ç¼€å’Œï¼Œæœ€åçš„ä¸€å±‚å¾ªç¯å°±å¯ä»¥ç›´æ¥ä¸¢æ‰äº†ã€‚</p><p>è¿™ä¸ªå°±æ˜¯ $v$ è¦åœ¨ $u$ å‰é¢çš„æƒ…å†µï¼Œ$u$ åœ¨ $v$ å‰é¢çš„æƒ…å†µå’Œè¿™ä¸ªå·®ä¸å¤šï¼Œä¸è¿‡è½¬ç§»çš„æ—¶å€™ $j$ å°±è¦ä» $0$ å¼€å§‹äº†ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™ $u$ å‰é¢æ˜¯å¯ä»¥ä¸å¤šæ”¾ä»»ä½•ä¸œè¥¿çš„ï¼Œè¿˜æœ‰å°±æ˜¯ $u$ åœ¨ $v$ å‰é¢çš„æ—¶å€™æ³¨æ„ $k\geq j$ æ—¶æ‰å¯ä»¥è½¬ç§» !</p><p>æœ€åçš„ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{i=1}^{n} f_{1,i}$ å•¦ã€‚</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e3</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[N],cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to,val;&#125;G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> C[N][N],f[N][N],pre[N][N],suf[N][N],sz[N],g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[u],v,w&#125;,head[u]=cnt;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[v],u,w^<span class="number">1</span>&#125;,head[v]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(<span class="keyword">int</span>&amp;x,<span class="keyword">int</span> y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;=mod)x-=mod;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sz[u]=f[u][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l=head[u];l;l=G[l].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> v=G[l].to,w=G[l].val;</span><br><span class="line">        <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v,u);</span><br><span class="line">        <span class="built_in">memset</span>(g,<span class="number">0</span>,<span class="keyword">sizeof</span>(g));</span><br><span class="line">        <span class="keyword">if</span>(w) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=sz[v];++j)</span><br><span class="line">                    pls(g[i+j],<span class="number">1l</span>l*f[u][i]*pre[v][j]%mod*C[i+j<span class="number">-1</span>][j]%mod</span><br><span class="line">                    *C[sz[u]+sz[v]-i-j][sz[v]-j]%mod);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=sz[v];++j)</span><br><span class="line">                    pls(g[i+j],<span class="number">1l</span>l*f[u][i]*suf[v][j+<span class="number">1</span>]%mod*C[i+j<span class="number">-1</span>][j]%mod</span><br><span class="line">                    *C[sz[u]+sz[v]-i-j][sz[v]-j]%mod);</span><br><span class="line">        &#125;</span><br><span class="line">        sz[u]+=sz[v];</span><br><span class="line">        <span class="built_in">memcpy</span>(f[u],g,<span class="keyword">sizeof</span>(g));</span><br><span class="line">    &#125;</span><br><span class="line">    pre[u][<span class="number">0</span>]=suf[u][sz[u]+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i) pre[u][i]=(pre[u][i<span class="number">-1</span>]+f[u][i])%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=sz[u];i&gt;=<span class="number">1</span>;--i) suf[u][i]=(suf[u][i+<span class="number">1</span>]+f[u][i])%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head)),cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">int</span> n;IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u,v;<span class="keyword">char</span> sign;</span><br><span class="line">        IN(u),sign=getchar(),IN(v);</span><br><span class="line">        add(u+<span class="number">1</span>,v+<span class="number">1</span>,sign==<span class="string">'&lt;'</span>?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) pls(ans,f[<span class="number">1</span>][i]);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*é¢„å¤„ç†ç»„åˆæ•°*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=N<span class="number">-2</span>;++i) C[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N<span class="number">-2</span>;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=N<span class="number">-2</span>;++j)</span><br><span class="line">            C[i][j]=(C[i<span class="number">-1</span>][j]+C[i<span class="number">-1</span>][j<span class="number">-1</span>])%mod;</span><br><span class="line">    <span class="keyword">int</span> T;IN(T);</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯èƒ½æœ‰äººä¼šé—®ï¼Œå¦‚æœ $u$ çš„å„¿å­ $v$ ä¸‹é¢çš„è¾¹å…¨éƒ½æ˜¯ $&gt;$ ï¼Œå¹¶ä¸” $u$ è¿å‘ $v$ çš„è¾¹ä¹Ÿæ˜¯ $&gt;$ ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ $v$ ä»¥åŠå…¶å­æ ‘çš„æ‰€æœ‰ç‚¹éƒ½å¿…é¡»åœ¨ $u$ å‰é¢å®Œæˆï¼Œåœ¨è½¬ç§»çš„æ—¶å€™ä¸ºä»€ä¹ˆå¯ä»¥ $â€œ$ æå‡º $j$ ä¸ªç»“ç‚¹æ”¾åˆ° $u$ å‰é¢ $â€$ å‘¢ï¼Ÿ</p><p>å…¶å®æƒ³æƒ³å°±å¯ä»¥æ˜ç™½ï¼Œåœ¨å‘ä¸Šç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™å¯¹äºä¸€ä¸ª $v$ çš„å„¿å­ $a$ ï¼Œæˆ‘ä»¬åªç»Ÿè®¡äº†åˆå¹¶å $a$ åœ¨ $v$ å‰é¢çš„æƒ…å†µï¼ŒåŒæ ·åœ¨ $u$ ç»Ÿè®¡ $v$ æ—¶ä¹Ÿåªæ˜¯ç»Ÿè®¡äº†åˆå¹¶å $v$ åœ¨ $u$ å‰é¢çš„æƒ…å†µï¼Œæ‰€æœ‰æˆ‘ä»¬ä¹Ÿåªæ˜¯ç»Ÿè®¡äº† $â€œ$ $a$ åœ¨ $v$ å‰é¢ä¸” $v$ åœ¨ $u$ å‰é¢ $â€$ çš„æƒ…å†µï¼Œæ‰€æœ‰è¢«ç»Ÿè®¡çš„æƒ…å†µä¸€å®šæ˜¯åˆæ³•çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;$loj$ ä¸Šæ²¡æœ‰æ­¤é¢˜ï¼Œ$bzoj$ ä¸Šæ˜¯æƒé™é¢˜ï¼Œå¯¹äºä¸ä¸Š $yzoj$ çš„æˆ‘æ¥è¯´åªèƒ½å»æ´›è°·åšé¢˜äº†ï¼š&lt;a href=&quot;https://www.luogu.org/problemnew/show/P4099&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è½¬é€é—¨ğŸ˜„&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä¸è€ƒè™‘è¾¹çš„æƒå€¼(&amp;lt;ä¸&amp;gt;)ï¼Œè¿™æ ·å­ $n-1$ æ¡è¾¹ç»„æˆçš„å°±æ˜¯æ ‘äº†ï¼Œå¾ˆæ˜¾ç„¶æ˜¯éœ€è¦æˆ‘ä»¬æ±‚å‡ºè¿™æ£µæ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„ä¸ªæ•°ï¼Œè€ƒè™‘ä½¿ç”¨ $\rm{DP}$ ï¼Œå¯¹äºè¾¹çš„æ–¹å‘(å³&amp;lt;,&amp;gt;) ï¼Œæˆ‘ä»¬åˆ†ç±»è®¨è®ºå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆçš„ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è®¾ $f_u$ è¡¨ç¤ºç‚¹ $u$ çš„å­æ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„æ€»æ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å¦‚ä½•è®¡ç®—å‘¢&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ç»„åˆæ•°å­¦" scheme="http://qiulyblog.github.io/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"/>
    
      <category term="æ ‘å½¢DP" scheme="http://qiulyblog.github.io/tags/%E6%A0%91%E5%BD%A2DP/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘  [HAOI2018]è‹¹æœæ ‘  ç»„åˆæ•°å­¦  loj2526</title>
    <link href="http://qiulyblog.github.io/2019/05/05/%5B%E9%A2%98%E8%A7%A3%5Dloj2526/"/>
    <id>http://qiulyblog.github.io/2019/05/05/[é¢˜è§£]loj2526/</id>
    <published>2019-05-04T16:00:00.000Z</published>
    <updated>2019-05-06T05:23:46.830Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰è¶£çš„é¢˜ç›®ï¼Œå¯çˆ±çš„ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2526" target="_blank" rel="noopener">æˆ³è¿™å‘¢=ï¿£Ï‰ï¿£=</a></p><p>åˆšå¼€å§‹å¾€æ¦‚ç‡ $\rm{DP}$ æƒ³äº†ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç‚¹çš„æ¦‚ç‡æ˜¯å¥½ç®—ï¼Œä½†æ˜¯å¦‚æœæ±‚è´¡çŒ®çš„è¯å°±ä¼šå¾ˆéš¾åŠã€‚æœ€åä¸‡èˆ¬æ— èµ–çš„ç‚¹å¼€äº†é¢˜è§£ï¼Œå‘ç°å±…ç„¶æ˜¯â€¦â€¦ç»„åˆæ•°å­¦ï¼Ÿå…¶å®å’Œ $\rm{DP}$ æ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ $i$ ï¼Œæˆ‘ä»¬æšä¸¾å…¶å­æ ‘å¤§å° $j$ ã€‚ç°åœ¨è€ƒè™‘æœ€ç»ˆæœ‰å¤šå°‘ç§åˆæ³•çš„æƒ…å†µå¯ä»¥ä½¿å¾— $i$ çš„å­æ ‘å¤§å°æ°å¥½ä¸º $j$ ã€‚</p><a id="more"></a><p>æ˜“çŸ¥èŠ‚ç‚¹æ•°ä¸º $n$ çš„äºŒå‰æ ‘çš„æ€»å½¢æ€æ•°ä¸º $n!$ ï¼Œè€Œä¸” $i$ å­æ ‘ä¸‹çš„æ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·ä¸€å®šè¦å¤§äº $i$ ï¼Œæˆ‘ä»¬è€ƒè™‘â€å…ˆå°† $i$ å­æ ‘æ„é€ å‡ºæ¥å†å¡«å…¥èŠ‚ç‚¹â€çš„è¿‡ç¨‹ï¼Œå­æ ‘çš„å½¢æ€æ•°æ˜¾ç„¶ä¸º $j!$ ï¼Œç„¶åæˆ‘ä»¬åªèƒ½é€‰å‰©ä¸‹çš„ $n-i$ ä¸ªèŠ‚ç‚¹(ç¼–å·è¦æ¯” $i$ å¤§) ï¼Œå¡«å…¥å‰©ä¸‹çš„ $j-1$ ä¸ªä½ç½®( $i$ å äº†ä¸€ä¸ªä½ç½®) ï¼Œæ˜¾ç„¶è¿™æ ·çš„æ–¹æ¡ˆæ•°ä¸º $C_{n-i}^{j-1}$ ã€‚</p><p>è¿™æ ·çš„ä¸€ä¸ª $i$ ï¼Œå…¶å­æ ‘å¤§å°ä¸º $j$ ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥åšå‡ºå¤šå°‘è´¡çŒ®å‘¢ï¼Ÿè€ƒè™‘ $fa_i \Rightarrow i$ è¿™æ¡è¾¹ä¼šç»è¿‡å¤šå°‘æ¬¡ï¼Œæ˜¾ç„¶æ˜¯ $j\cdot(n-j)$ æ¬¡( $j$ ä¸ºå­æ ‘èŠ‚ç‚¹ä¸ªæ•°ï¼Œ$n-j$ ä¸ºä¸Šé¢çš„èŠ‚ç‚¹ä¸ªæ•°) ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ ·çš„æ–¹æ¡ˆå¯ä»¥é€ æˆ $j\cdot (n-j)$ çš„è´¡çŒ®ã€‚</p><p>é‚£ä¹ˆç°åœ¨ $i$ çš„å­æ ‘å¾—åˆ°ç¡®å®šäº†ï¼Œæˆ‘ä»¬å°† $i$ ä»¥åŠå…¶å­æ ‘çœ‹åšä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è€ƒè™‘ $1$ åˆ° $i$ è¿™äº›èŠ‚ç‚¹ï¼Œå®ƒä»¬å¯ä»¥ä»¥ä»»æ„å½¢æ€ç»„æˆä¸€æ£µæ ‘ï¼Œæ–¹æ¡ˆæ•°æ˜¯ $i!$ ã€‚</p><p>æ¥ç€æˆ‘ä»¬éœ€è¦å°†å‰©ä¸‹çš„ $n-j-(i-1)$ ä¸ªèŠ‚ç‚¹æŒ‚åˆ°æ ‘ä¸Šå»ã€‚å¯¹äºç¬¬ $i$ ä¸ªæŒ‚åˆ°æ ‘ä¸Šçš„ç‚¹ï¼Œå®ƒæœ‰ $i$ ä¸ªä½ç½®å¯ä»¥æŒ‚ã€‚ä½†æ˜¯å› ä¸º $i$ ä¸€å®šè¦å ä¸€ä¸ªä½ç½®ï¼Œæ‰€ä»¥è¿™ä¸ªèŠ‚ç‚¹åªæœ‰ $i-1$ ä¸ªä½ç½®å¯ä»¥æŒ‚äº†ï¼Œç¬¬äºŒä¸ªå¤šå‡ºæ¥çš„èŠ‚ç‚¹å°±æœ‰ $i$ ä¸ªä½ç½®å¯ä»¥æŒ‚â€¦â€¦ç¬¬ $k$ ä¸ªæ˜¾ç„¶æœ‰ $i-2+k$ ä¸ªä½ç½®å¯ä»¥æŒ‚ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™äº›ç‚¹æŒ‚ä¸Šå»çš„æ€»æ–¹æ¡ˆæ•°ä¸º $\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)$ ã€‚</p><p>å°†ä¸Šé¢çš„ä¹˜èµ·æ¥å°±æ˜¯è¿™ä¸€ç»„ $i,j$ å¯¹ç­”æ¡ˆé€ æˆçš„è´¡çŒ®äº†ï¼š</p><script type="math/tex; mode=display">j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i!\cdot\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)</script><p>$\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)$ æ¯”è¾ƒä¸å¥½è®¡ç®—ï¼Œä½†æ˜¯ç®€å•çš„å˜åŒ–åå‘ç°è¿™ä¸ªæ˜¯å’Œ $(n-j-1)!/(i-2)!$ ç­‰ä»·çš„ï¼Œæˆ‘ä»¬å¸¦è¿›åŸå¼å­ã€‚</p><script type="math/tex; mode=display">j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i!\cdot(n-j-1)!/(i-2)!\\\\=j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i\cdot (i-1)\cdot(n-j-1)!\\\\=j!\cdot C_{n-i}^{j-1}\cdot j\cdot i\cdot (i-1)\cdot (n-j)!</script><p>è¿™æ ·å°±å¾ˆå¥½ç®—äº†ï¼Œæˆ‘ä»¬é¢„å¤„ç†ç»„åˆæ•°å’Œé˜¶ä¹˜ï¼Œä¸Šé¢çš„å¼å­ $O(1)$ ç®—~</p><p>ä»£ç å¾ˆçŸ­ã€‚</p><h3 id="Codeï¼š"><a href="#Codeï¼š" class="headerlink" title="Codeï¼š"></a>Codeï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e3</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,p,ans,fac[N],C[N][N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(<span class="keyword">int</span>&amp;x,<span class="keyword">int</span> y)</span> </span>&#123;x+=y;x%=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(p);</span><br><span class="line">    fac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) fac[i]=<span class="number">1l</span>l*fac[i<span class="number">-1</span>]*i%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) C[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i;++j)</span><br><span class="line">            C[i][j]=(C[i<span class="number">-1</span>][j]+C[i<span class="number">-1</span>][j<span class="number">-1</span>])%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n-i+<span class="number">1</span>;++j)</span><br><span class="line">            pls(ans,(ll)fac[j]*fac[n-j]%p*C[n-i][j<span class="number">-1</span>]%p*(i*(i<span class="number">-1</span>))%p*j%p);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ‰è¶£çš„é¢˜ç›®ï¼Œå¯çˆ±çš„ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2526&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ³è¿™å‘¢=ï¿£Ï‰ï¿£=&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹å¾€æ¦‚ç‡ $\rm{DP}$ æƒ³äº†ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç‚¹çš„æ¦‚ç‡æ˜¯å¥½ç®—ï¼Œä½†æ˜¯å¦‚æœæ±‚è´¡çŒ®çš„è¯å°±ä¼šå¾ˆéš¾åŠã€‚æœ€åä¸‡èˆ¬æ— èµ–çš„ç‚¹å¼€äº†é¢˜è§£ï¼Œå‘ç°å±…ç„¶æ˜¯â€¦â€¦ç»„åˆæ•°å­¦ï¼Ÿå…¶å®å’Œ $\rm{DP}$ æ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ $i$ ï¼Œæˆ‘ä»¬æšä¸¾å…¶å­æ ‘å¤§å° $j$ ã€‚ç°åœ¨è€ƒè™‘æœ€ç»ˆæœ‰å¤šå°‘ç§åˆæ³•çš„æƒ…å†µå¯ä»¥ä½¿å¾— $i$ çš„å­æ ‘å¤§å°æ°å¥½ä¸º $j$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ç»„åˆæ•°å­¦" scheme="http://qiulyblog.github.io/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [å…­çœè”è€ƒ2017]åˆ†æ‰‹æ˜¯ç¥æ„¿  æ¦‚ç‡DP  loj2145</title>
    <link href="http://qiulyblog.github.io/2019/05/05/%5B%E9%A2%98%E8%A7%A3%5Dloj2145/"/>
    <id>http://qiulyblog.github.io/2019/05/05/[é¢˜è§£]loj2145/</id>
    <published>2019-05-04T16:00:00.000Z</published>
    <updated>2019-05-05T02:43:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ¦‚ç‡ç¥ä»™é¢˜çš„ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2145" target="_blank" rel="noopener"><del>åˆ«æˆ³åäº†</del></a></p><p>è®¾ $f_i$ è¡¨ç¤ºè¿˜å‰©ä¸‹ $i$ ç›ç¯äº®åˆ°è¿˜å‰©ä¸‹ $i-1$ ç›ç¯äº®çš„æœŸæœ›æ“ä½œæ¬¡æ•°ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ $\frac{i}{n}$ çš„æ¦‚ç‡æŒ‰ä¸­äº®çš„ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‰ä¸­äº®çš„çš„è¯å°±åªèƒ½é€€åˆ° $f_{i+1}$ ã€‚ä¸éš¾åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_i=\frac{i}{n}+(1-\frac{i}{n})\cdot (1+f_i+f_{i+1})</script><p>å› ä¸ºè½¬ç§»å¼ä¸­æœ‰ä¸ª $f_i$ ï¼Œæœ‰äº›ä¸å¥½åŠâ€¦â€¦æ¨ä¸€æ¨å¼å­åº·åº·ã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=\frac{i}{n}+1\cdot (1+f_i+f_{i+1})-\frac{i}{n}\cdot (1+f_i+f_{i+1})\\\\f_i=\frac{i}{n}+1+f_i+f_{i+1}-\frac{i}{n}-\frac{i}{n}f_i-\frac{i}{n}f_{i+1}\\\\f_i=1+f_i+f_{i+1}-\frac{i}{n}f_i-\frac{i}{n}f_{i+1}\\\\\frac{i}{n}f_i=1+f_{i+1}-\frac{i}{n}f_{i+1}\\\\f_i=\frac{1+f_{i+1}-\frac{i}{n}f_{i+1}}{\frac{i}{n}}\\\\f_i=\frac{n\cdot(1+f_{i+1})-i\cdot f_{i+1}}{i}\\\\f_i=\frac{n+(n-i)\cdot f_{i+1}}{i}\\\\f_i=1+\frac{(n-i)\cdot (f_{i+1}+1)}{i}</script><p>é¢„å¤„ç†é€†å…ƒå°±å¯ä»¥ç›´æ¥è®¡ç®—äº†ï¼Œè®°å¾—æœ€åä¹˜ä¸Š $n!$ ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p=<span class="number">100003</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,k,step,a[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans,f[N],inv[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(k);</span><br><span class="line">    inv[<span class="number">0</span>]=<span class="number">0</span>,inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) inv[i]=(<span class="keyword">long</span> <span class="keyword">long</span>)(p-p/i)*inv[p%i]%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;=n;j+=i) g[j].push_back(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;--i) <span class="keyword">if</span>(a[i]) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;g[i].size();++j) a[g[i][j]]^=<span class="number">1</span>;</span><br><span class="line">        ++step;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(step&lt;=k) ans=step;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        f[n]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;<span class="number">1</span>;--i) f[i]=(<span class="number">1l</span>l+(<span class="number">1l</span>l*n-i)*(f[i+<span class="number">1</span>]+<span class="number">1</span>)*inv[i])%p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=step;i&gt;k;--i) ans=(ans+f[i])%p;</span><br><span class="line">        ans=(ans+k)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans=(<span class="number">1l</span>l*i*ans)%p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¦‚ç‡ç¥ä»™é¢˜çš„ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2145&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;del&gt;åˆ«æˆ³åäº†&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºè¿˜å‰©ä¸‹ $i$ ç›ç¯äº®åˆ°è¿˜å‰©ä¸‹ $i-1$ ç›ç¯äº®çš„æœŸæœ›æ“ä½œæ¬¡æ•°ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ $\frac{i}{n}$ çš„æ¦‚ç‡æŒ‰ä¸­äº®çš„ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‰ä¸­äº®çš„çš„è¯å°±åªèƒ½é€€åˆ° $f_{i+1}$ ã€‚ä¸éš¾åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\frac{i}{n}+(1-\frac{i}{n})\cdot (1+f_i+f_{i+1})&lt;/script&gt;&lt;p&gt;å› ä¸ºè½¬ç§»å¼ä¸­æœ‰ä¸ª $f_i$ ï¼Œæœ‰äº›ä¸å¥½åŠâ€¦â€¦æ¨ä¸€æ¨å¼å­åº·åº·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SCOI2014]æ–¹ä¼¯ä¼¯çš„ç‰ç±³ç”°  æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–DP  luoguP3287</title>
    <link href="http://qiulyblog.github.io/2019/05/04/%5B%E9%A2%98%E8%A7%A3%5DluoguP3287/"/>
    <id>http://qiulyblog.github.io/2019/05/04/[é¢˜è§£]luoguP3287/</id>
    <published>2019-05-03T16:00:00.000Z</published>
    <updated>2019-05-05T02:25:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥åä¸è¦è¢«è¿™ç§å‚»é€¼é¢˜ç»™è’™éª—äº†ã€‚ä¼ é€é—¨ï¼š<a href="https://www.luogu.org/problemnew/show/P3287" target="_blank" rel="noopener">æ–¹ä¼¯ä¼¯çš„ä¼ é€é—¨=ã€‚=</a></p><p>é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼Œæ¯ä¸€æ¬¡æ‹”é«˜çš„å³ç«¯ç‚¹ä¸€å®šæ˜¯ $n$ ï¼Œå¦‚æœæ˜¯åªæ‹”é«˜ä¸­é—´éƒ¨åˆ†ï¼Œå³è¾¹çš„åˆè¦å°½å¯èƒ½å¤§äºä¸­é—´éƒ¨åˆ†ï¼Œç´¢æ€§ä¸€èµ·æ‹”äº†ï¼Œè¿™ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚</p><p>è®¾ $f_{i,j}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªç‰ç±³è¢«æ‹”é«˜äº† $j$ æ¬¡æ—¶ä»¥ $i$ ç»“å°¾çš„æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é•¿åº¦ï¼Œå®¹æ˜“å¾—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><a id="more"></a><script type="math/tex; mode=display">f_{i,j}=\max\{f_{k,l}+1\} \ \ (k<i,l\leq j,h_i+j\geq h_k+l)</script><p>å¯èƒ½æœ‰äººä¼šé—®ä¸ºä»€ä¹ˆ $l\leq j$ ï¼Œå¾ˆæ˜¾ç„¶å°±æ˜¯ä¸Šé¢çš„é“ç†ï¼Œè¶Šå¤§çš„ $i$ ä¸€å®šæ‹”é«˜æ¬¡æ•°æ˜¯å•è°ƒä¸å‡çš„ã€‚</p><p>å‘ç°ä¸Šé¢çš„è½¬ç§»å…¶å®æ˜¯ $O(n^2k^2)$ çš„ï¼Œä¸‡æ¶çš„å‡ºé¢˜äººä¸ä¼šç»™è¿™ä¸ªå¤æ‚åº¦ä¸€ä¸ç‚¹åˆ†â€¦â€¦è¿™ä¸ªæ—¶å€™ç”¨æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–è½¬ç§»ï¼Œå‘ç°ä¸Šé¢æœ‰ä¸‰ä¸ªé™åˆ¶æ¡ä»¶ï¼Œæˆ‘ä»¬æ­£ç€æšä¸¾ $i$ ï¼Œå°±å·²ç»æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶äº†ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™æ ‘çŠ¶æ•°ç»„ä¸­çš„éƒ½æ˜¯å°äº $i$ çš„ $k$ ã€‚ç„¶åå°†æ¯ä¸ªç‚¹æŒ‰ç…§ $(j+1,h_i+j)$ æ”¾åˆ°å¹³é¢ä¸Šï¼Œç„¶åæ ‘çŠ¶æ•°ç»„ç»Ÿè®¡ç­”æ¡ˆå³å¯ã€‚</p><p>æ ‘çŠ¶æ•°ç»„ç»´æŠ¤çš„æ˜¯ $\max$  ï¼Œä¸æ˜¯å’Œã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e4</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K=<span class="number">5e2</span>+<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N],n,k,mx;</span><br><span class="line"><span class="keyword">namespace</span> BIT&#123;</span><br><span class="line">    <span class="keyword">int</span> c[N][<span class="number">5009</span>+K];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">const</span> <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(;x&lt;=mx+k;x+=(x&amp;-x))<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i&lt;=k+<span class="number">1</span>;i+=(i&amp;-i))</span><br><span class="line">                c[x][i]=max(c[x][i],v); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(;x;x-=(x&amp;-x))<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i;i-=(i&amp;-i))</span><br><span class="line">                ans=max(ans,c[x][i]);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> BIT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]),mx=max(mx,a[i]);</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)   </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=k;~j;--j) &#123;</span><br><span class="line">            <span class="keyword">int</span> res=query(a[i]+j,j+<span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line">            ans=max(ans,res),update(a[i]+j,j+<span class="number">1</span>,res);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»¥åä¸è¦è¢«è¿™ç§å‚»é€¼é¢˜ç»™è’™éª—äº†ã€‚ä¼ é€é—¨ï¼š&lt;a href=&quot;https://www.luogu.org/problemnew/show/P3287&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ–¹ä¼¯ä¼¯çš„ä¼ é€é—¨=ã€‚=&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼Œæ¯ä¸€æ¬¡æ‹”é«˜çš„å³ç«¯ç‚¹ä¸€å®šæ˜¯ $n$ ï¼Œå¦‚æœæ˜¯åªæ‹”é«˜ä¸­é—´éƒ¨åˆ†ï¼Œå³è¾¹çš„åˆè¦å°½å¯èƒ½å¤§äºä¸­é—´éƒ¨åˆ†ï¼Œç´¢æ€§ä¸€èµ·æ‹”äº†ï¼Œè¿™ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f_{i,j}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªç‰ç±³è¢«æ‹”é«˜äº† $j$ æ¬¡æ—¶ä»¥ $i$ ç»“å°¾çš„æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é•¿åº¦ï¼Œå®¹æ˜“å¾—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ ‘çŠ¶æ•°ç»„" scheme="http://qiulyblog.github.io/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
      <category term="äºŒç»´æ ‘çŠ¶æ•°ç»„" scheme="http://qiulyblog.github.io/tags/%E4%BA%8C%E7%BB%B4%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SHOI2014]æ¦‚ç‡å……ç”µå™¨  æ¦‚ç‡DP  loj2192</title>
    <link href="http://qiulyblog.github.io/2019/05/02/%5B%E9%A2%98%E8%A7%A3%5Dloj2192/"/>
    <id>http://qiulyblog.github.io/2019/05/02/[é¢˜è§£]loj2192/</id>
    <published>2019-05-01T16:00:00.000Z</published>
    <updated>2019-05-05T02:07:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¼ é€é—¨åœ¨è¿™ï¼š<a href="https://loj.ac/problem/2192" target="_blank" rel="noopener">æˆ‘æ˜¯ä¼ é€é—¨$QwQ$</a></p><p>å…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦ç®—çš„å°±æ˜¯ $\sum a_i$ (å…¶ä¸­ $a_i$ ä¸ºç‚¹ $i$ çš„é€šç”µæ¦‚ç‡) ã€‚æˆ‘ä»¬éœ€è¦ç®—å‡ºæ¯ä¸ªç‚¹çš„é€šç”µæ¦‚ç‡å³å¯ã€‚å› ä¸ºæœ‰äº›ç‚¹å¯ä»¥è‡ªå·±å‘ç”µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è€ƒè™‘çˆ¶äº²å’Œå„¿å­çš„é€šç”µæƒ…å†µã€‚</p><p>å› ä¸ºç›´æ¥è®¾é€šç”µæ¦‚ç‡æœ‰äº›æ£˜æ‰‹ï¼Œæˆ‘ä»¬è®¾ $f_i$ è¡¨ç¤ºç‚¹ $i$ çš„å„¿å­æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç®—ï¼Œæˆ‘ä»¬é¡ºå¸¦ç®—ä¸Šç‚¹ $i$ è‡ªå·±å‘ç”µçš„æ¦‚ç‡ã€‚</p><a id="more"></a><p>æšä¸¾æ¯ä¸€ä¸ªå„¿å­ï¼Œå¯¹äºè¿™ä¸ªå„¿å­åªæœ‰ä¸¤ç§æƒ…å†µï¼šè¯¥å„¿å­æ²¡æœ‰é€šä¸Šç”µï¼Œè¯¥å„¿å­é€šä¸Šç”µäº†ä¸”ä¼ é€å¤±è´¥ã€‚ä¸¤ç§æƒ…å†µçš„æ¦‚ç‡éƒ½å¾ˆå¥½ç®—ã€‚æˆ‘ä»¬å¯ä»¥åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_u=(1-q_u)\cdot \prod (f_v+(1-f_v)\cdot(1-G_i.p))</script><p>å…¶ä¸­ $(1-q_u)$ æ˜¾ç„¶ä¸ºè¯¥ç‚¹æœ¬èº«ä¸é€šç”µçš„æ¦‚ç‡ï¼Œç„¶åæšä¸¾å„¿å­ $v$ ï¼Œ$f_v$ å°±æ˜¯è¯¥å„¿å­æœ¬æ¥å°±æ²¡æœ‰é€šä¸Šç”µçš„æ¦‚ç‡ï¼Œ$(1-f_v)\cdot(1-G_i.p)$ å°±æ˜¯é€šä¸Šç”µçš„ä¼ é€å¤±è´¥(æ³¨ï¼š$G_i.p$ æ˜¯å½“å‰è¿æ¥ $u,v$ çš„è¾¹çš„é€šç”µæ¦‚ç‡) ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è®¡ç®—çˆ¶äº²ä¼ æ¥çš„ç”µå‘¢ï¼Ÿè®¾ $g_i$ è¡¨ç¤ºç‚¹ $i$ çš„çˆ¶äº²æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ã€‚è®¡ç®—ä¸€ä¸‹çˆ¶èŠ‚ç‚¹ä¸é€šç”µçš„æ¦‚ç‡ï¼Œæ³¨æ„ä¸è¦è®¡ç®—ä¸Šè¯¥å„¿å­çš„è´¡çŒ®ï¼Œä¸ç„¶ä¼šä¹±ã€‚è®¡ç®—å®Œä¸é€šç”µçš„æ¦‚ç‡ååˆ†ä¸Šé¢ä¸¤ç§æƒ…å†µè®¨è®ºå³å¯ã€‚</p><script type="math/tex; mode=display">res=g_u\cdot f_v / (f_v+(1-f_v)\cdot(1-G_i.p))\\\\g_v=res+(1-res)\cdot(1-G_i.p)</script><p>ä¸¤è¾¹ $dfs$ å°±å¯ä»¥æå®šã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> ans,f[N],g[N],q[N];</span><br><span class="line"><span class="keyword">int</span> head[N],cnt,n,tot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to;<span class="keyword">double</span> p;&#125;G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">double</span> p)</span> </span>&#123;G[++cnt]=(Edge)&#123;head[x],y,p&#125;,head[x]=cnt;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[u]=<span class="number">1</span>-q[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u],v;i;i=G[i].nxt) </span><br><span class="line">        <span class="keyword">if</span>((v=G[i].to)!=fa)</span><br><span class="line">            dfs1(v,u),f[u]*=(f[v]+(<span class="number">1</span>-f[v])*(<span class="number">1</span>-G[i].p));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u],v;i;i=G[i].nxt) </span><br><span class="line">        <span class="keyword">if</span>((v=G[i].to)!=fa) &#123;</span><br><span class="line">            <span class="keyword">double</span> res=g[u]*f[u]/(f[v]+(<span class="number">1</span>-f[v])*(<span class="number">1</span>-G[i].p));</span><br><span class="line">            g[v]=res+(<span class="number">1</span>-res)*(<span class="number">1</span>-G[i].p);dfs2(v,u);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y,p;IN(x),IN(y),IN(p);</span><br><span class="line">        add(x,y,p/<span class="number">100.0</span>),add(y,x,p/<span class="number">100.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,x;i&lt;=n;++i) IN(x),q[i]=x/<span class="number">100.0</span>;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    g[<span class="number">1</span>]=<span class="number">1.0</span>,dfs2(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans+=<span class="number">1</span>-f[i]*g[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.6f\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¼ é€é—¨åœ¨è¿™ï¼š&lt;a href=&quot;https://loj.ac/problem/2192&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ‘æ˜¯ä¼ é€é—¨$QwQ$&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦ç®—çš„å°±æ˜¯ $\sum a_i$ (å…¶ä¸­ $a_i$ ä¸ºç‚¹ $i$ çš„é€šç”µæ¦‚ç‡) ã€‚æˆ‘ä»¬éœ€è¦ç®—å‡ºæ¯ä¸ªç‚¹çš„é€šç”µæ¦‚ç‡å³å¯ã€‚å› ä¸ºæœ‰äº›ç‚¹å¯ä»¥è‡ªå·±å‘ç”µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è€ƒè™‘çˆ¶äº²å’Œå„¿å­çš„é€šç”µæƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºç›´æ¥è®¾é€šç”µæ¦‚ç‡æœ‰äº›æ£˜æ‰‹ï¼Œæˆ‘ä»¬è®¾ $f_i$ è¡¨ç¤ºç‚¹ $i$ çš„å„¿å­æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç®—ï¼Œæˆ‘ä»¬é¡ºå¸¦ç®—ä¸Šç‚¹ $i$ è‡ªå·±å‘ç”µçš„æ¦‚ç‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2015]å¯¿å¸æ™šå®´  çŠ¶å‹DP  loj2131</title>
    <link href="http://qiulyblog.github.io/2019/05/01/%5B%E9%A2%98%E8%A7%A3%5Dloj2131/"/>
    <id>http://qiulyblog.github.io/2019/05/01/[é¢˜è§£]loj2131/</id>
    <published>2019-04-30T16:00:00.000Z</published>
    <updated>2019-05-05T01:22:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œä¸¤ä¸ªæ•°ä¸äº’è´¨åŒç†äºä¸¤ä¸ªæ•°çš„è´¨å› å­é›†åˆæ²¡æœ‰äº¤é›†ã€‚è€ƒè™‘ä¸€ä¸‹ $n\leq 30$ çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°è¿™é‡Œé¢çš„è´¨æ•°ä¹Ÿåªæœ‰ $10$ ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ¯ä¸€ä¸ªå¯¿å¸åˆ†è§£è´¨å› æ•°ï¼Œç„¶åå°†è´¨å› å­å‹æˆä¸€ä¸ªçŠ¶æ€ã€‚</p><p>è®¾ $f[s1][s2]$ è¡¨ç¤ºå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œå° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™æšä¸¾å¯¿å¸ï¼Œåˆ†åˆ«åˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦èƒ½åƒç„¶åè½¬ç§»å³å¯ã€‚</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mul=<span class="number">1024</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n,s[N];ll p,f[<span class="number">2</span>][mul][mul];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(ll&amp;x,ll&amp;y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;p)x-=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("1.in","r",stdin);</span></span><br><span class="line">    <span class="comment">// freopen("1.out","w",stdout);</span></span><br><span class="line">    IN(n),IN(p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">10</span>;++j)</span><br><span class="line">            <span class="keyword">if</span>(!(i%pri[j])) s[i]|=<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>);</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> now=i&amp;<span class="number">1</span>,lst=!now;</span><br><span class="line">        <span class="built_in">memcpy</span>(f[now],f[lst],<span class="keyword">sizeof</span>(f[lst]));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;mul;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;mul;++s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!f[lst][s1][s2]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;s[i])) pls(f[now][s1|s[i]][s2],f[lst][s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;s[i])) pls(f[now][s1][s2|s[i]],f[lst][s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;mul;++s1)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;mul;++s2) pls(ans,f[n&amp;<span class="number">1</span>][s1][s2]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>å¯ä»¥çŸ¥é“ $n\leq 500$ çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªæ•°æœ€å¤šå¸¦ä¸Šä¸€ä¸ªå¤§äºç­‰äº $23$ çš„è´¨å› å­ã€‚æˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰çš„å¯¿å¸åˆ†ä¸ºä¸¤ç±»ï¼šå¸¦äº†å¤§äºç­‰äº $23$ çš„è´¨å› å­çš„å’Œæ²¡å¸¦çš„ã€‚</p><p>æ²¡å¸¦çš„æ˜¾ç„¶å¯ä»¥å‘ä¸Šé¢é‚£æ ·è½¬ç§»ã€‚é‚£ä¹ˆå¸¦äº†çš„å‘¢ï¼Ÿè¿™ä¸ªæ˜¾ç„¶ä¸èƒ½å‹ç¼©å§ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘å°†å¸¦äº†åŒæ ·çš„å¤§äºç­‰äº $23$ çš„è´¨å› å­çš„åˆ†æˆä¸€ç»„ï¼Œè¿™ä¸€ç»„è¦ä¸å° $\rm{G}$ åƒå° $\rm{W}$ ä¸åƒï¼Œè¦ä¸å° $\rm{W}$ åƒå° $G$ ä¸åƒã€‚åˆ†åˆ«è®¨è®ºå³å¯ã€‚</p><p>è®¾ $f1[s1][s2]$ è¡¨ç¤ºè¿™ä¸€ç»„æ˜¯å° $\rm{G}$ åƒæ—¶ï¼Œå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œ å° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚åŒç†ï¼Œè®¾ $f2[s1][s2]$ è¡¨ç¤ºè¿™ä¸€ç»„æ˜¯å° $\rm{W}$ åƒæ—¶ï¼Œå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œ å° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚åˆ†åˆ«è½¬ç§»å°±å¥½äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=pos+<span class="number">1</span>;i&lt;=n;++i) &#123; <span class="comment">/*æšä¸¾è¿™äº›å¯¿å¸*/</span></span><br><span class="line">    <span class="keyword">if</span>(a[i].t!=a[i<span class="number">-1</span>].t) <span class="comment">/*å¤§è´¨å› å­ä¸åŒäº†*/</span></span><br><span class="line">        <span class="built_in">memcpy</span>(f1,f,<span class="keyword">sizeof</span>(f)),<span class="built_in">memcpy</span>(f2,f,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">        <span class="comment">/*å€’ç€æšä¸¾æ‰€ä»¥æ²¡ç”¨æ»šåŠ¨æ•°ç»„*/</span></span><br><span class="line">        <span class="comment">/*æ‰€è°“çš„åˆ†åˆ«è½¬ç§»*/</span></span><br><span class="line">        <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f1[s1|a[i].s][s2],f1[s1][s2]);</span><br><span class="line">        <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f2[s1][s2|a[i].s],f2[s1][s2]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¿™ä¸€ç»„ç»“æŸäº†ï¼Œéœ€è¦åˆå¹¶ç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">if</span>(a[i].t!=a[i+<span class="number">1</span>].t||i==n)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2)</span><br><span class="line">            <span class="comment">/*å› ä¸ºf1[s1][s2]å’Œf2[s1][s2]éƒ½é‡å¤ç®—äº†ä¸€éåŸæ¥çš„</span></span><br><span class="line"><span class="comment">            f[s1][s2]ï¼Œæ‰€ä»¥å‡æ‰åå†å–è†œ*/</span></span><br><span class="line">            f[s1][s2]=(f1[s1][s2]+f2[s1][s2]-f[s1][s2]+p)%p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M=<span class="number">256</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>&#125;;</span><br><span class="line">ll p,f[M][M],f1[M][M],f2[M][M];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span><span class="keyword">int</span> t,s;&#125;a[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Node a,Node b)</span> </span>&#123;<span class="keyword">return</span> a.t&lt;b.t;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(ll&amp;x,ll&amp;y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;=p)x%=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;IN(n),IN(p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        a[i].t=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">8</span>;++j)<span class="keyword">if</span>(!(i%pri[j])) &#123;</span><br><span class="line">            a[i].s|=<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>),a[i].t/=pri[j];</span><br><span class="line">            <span class="keyword">while</span>(!(a[i].t%pri[j])) a[i].t/=pri[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    sort(a+<span class="number">2</span>,a+n+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">int</span> pos=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span>(a[pos].t==<span class="number">1</span>) ++pos;--pos;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=pos;++i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f[s1|a[i].s][s2],f[s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f[s1][s2|a[i].s],f[s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=pos+<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i].t!=a[i<span class="number">-1</span>].t)</span><br><span class="line">            <span class="built_in">memcpy</span>(f1,f,<span class="keyword">sizeof</span>(f)),<span class="built_in">memcpy</span>(f2,f,<span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f1[s1|a[i].s][s2],f1[s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f2[s1][s2|a[i].s],f2[s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a[i].t!=a[i+<span class="number">1</span>].t||i==n)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2)</span><br><span class="line">                f[s1][s2]=(f1[s1][s2]+f2[s1][s2]-f[s1][s2]+p)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2) pls(ans,f[s1][s2]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(ans+p)%p);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¦–å…ˆï¼Œä¸¤ä¸ªæ•°ä¸äº’è´¨åŒç†äºä¸¤ä¸ªæ•°çš„è´¨å› å­é›†åˆæ²¡æœ‰äº¤é›†ã€‚è€ƒè™‘ä¸€ä¸‹ $n\leq 30$ çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°è¿™é‡Œé¢çš„è´¨æ•°ä¹Ÿåªæœ‰ $10$ ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ¯ä¸€ä¸ªå¯¿å¸åˆ†è§£è´¨å› æ•°ï¼Œç„¶åå°†è´¨å› å­å‹æˆä¸€ä¸ªçŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f[s1][s2]$ è¡¨ç¤ºå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œå° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™æšä¸¾å¯¿å¸ï¼Œåˆ†åˆ«åˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦èƒ½åƒç„¶åè½¬ç§»å³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çŠ¶æ€å‹ç¼©" scheme="http://qiulyblog.github.io/tags/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [JSOI2016]ç¯å¡”  å†³ç­–å•è°ƒæ€§&amp;DP  loj2074</title>
    <link href="http://qiulyblog.github.io/2019/04/30/%5B%E9%A2%98%E8%A7%A3%5Dloj2047/"/>
    <id>http://qiulyblog.github.io/2019/04/30/[é¢˜è§£]loj2047/</id>
    <published>2019-04-29T16:00:00.000Z</published>
    <updated>2019-05-05T01:22:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®è¿™é“é¢˜æ˜¯ $\rm{POI}$ çš„åŸé¢˜ï¼Œ$loj$ ä¼ é€é—¨é“¾æ¥ï¼š<a href="https://loj.ac/problem/2074" target="_blank" rel="noopener">åœ¨è¿™å‘¢o(ï¿£ï¸¶ï¿£)o</a></p><p>åˆšå¼€å§‹è‚¯å®šè¿˜æ˜¯çœ‹ä¸å‡ºè¿™é¢˜æ˜¯ä»€ä¹ˆ $\rm{DP}$ ï¼Œæ„Ÿè§‰å¾ˆè¯¡å¼‚ï¼Œä½†æ˜¯æ¨ä¸€æ¨è‡ªç„¶å°±å‡ºæ¥äº†ï¼š</p><script type="math/tex; mode=display">h_j \leq h_i+p-\sqrt{|iâˆ’j|}\\\\p\geq h_j-h_i +\sqrt{|iâˆ’j|}\\\\p=\max\{ h_j-h_i +\sqrt{|iâˆ’j|}\}</script><p>è®¾ $f_i$ è¡¨ç¤º $i$ çš„ $p$ å€¼ï¼Œé‚£ä¹ˆç»§ç»­ï¼š</p><a id="more"></a><script type="math/tex; mode=display">f_i=\max\{ h_j +\sqrt{|iâˆ’j|}\}-h_i</script><p>å‘ç°ç»å¯¹å€¼å¾ˆçƒ¦äººï¼Œå°†ç»å¯¹å€¼æ‹†å¼€ã€‚</p><script type="math/tex; mode=display">f_i=\max(\max\limits_{j=1}^{i}\{h_j +\sqrt{iâˆ’j}\},\max\limits_{j=i}^{n}\{h_j +\sqrt{j-i}\})-h_i</script><p>åŸåºåˆ—ç¿»è½¬ä¸€ä¸‹å°±å¯ä»¥ç›´æ¥è®¡ç®—åé¢çš„å¼å­ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦è€ƒè™‘ç¬¬ä¸€ä¸ªï¼š</p><script type="math/tex; mode=display">f_i=\max\limits_{j=1}^{i}\{h_j +\sqrt{iâˆ’j}\}-h_i</script><p>å‡è®¾å¯¹äº $i$ æ¥è¯´ $j$ æ˜¯æœ€ä¼˜çš„å†³ç­–ï¼Œé‚£ä¹ˆå¦‚æœå­˜åœ¨ä¸€ä¸ªå°äº $j$ çš„ $k$ ï¼Œæ˜¯å¦åœ¨è½¬ç§»ä¸€ä¸ªå¤§äº $i$ çš„ $l$ ä¼šæ›´ä¼˜å‘¢ï¼Ÿæ˜¾ç„¶ä¸ä¼šï¼Œå¯ä»¥çŸ¥é“ $i-k$ æ˜¾ç„¶æ˜¯å¤§äº $i-j$ çš„ï¼Œè€Œä¸”æ ¹å·æ˜¯å¢é•¿çš„è¶Šæ¥è¶Šæ…¢çš„ã€‚æ‰€ä»¥å¦‚æœåœ¨ $i$ æ—¶ $k$ å°±æ²¡æœ‰ $j$ ä¼˜äº†ï¼Œé‚£ä¹ˆåœ¨ä»¥åæ‰€ä»¥å¤§äº $i$ çš„ $l$ è½¬ç§»æ—¶ $k$ ä¹Ÿä¸å¯èƒ½æ¯” $j$ ä¼˜ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ä¸Šé¢çš„å¼å­æ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ $O(n\log n)$ æ„‰å¿«æ±‚å‡ºäº†ã€‚</p><p>è¿™é‡Œè¯´æ˜ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ul><li><strong>1.</strong> å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸‰å…ƒç»„ï¼Œä¸‰å…ƒç»„åŒ…å« $v$ (å†³ç­–ç‚¹ $v$) ï¼Œ$l$ (å†³ç­–ç‚¹ $v$ ä½œä¸ºæœ€ä¼˜å†³ç­–ç‚¹çš„æœ€å·¦ç«¯ç‚¹) ï¼Œ$r$ (å†³ç­–ç‚¹ $v$ ä½œä¸ºæœ€ä¼˜å†³ç­–ç‚¹çš„æœ€å³ç«¯ç‚¹) ï¼Œæ¯ä¸€æ¬¡æ’é™¤æ‰æœ€å³ç«¯ç‚¹å°äº $i$ çš„å…ƒç´ (å› ä¸ºè¯¥å…ƒç´ å·²ç»æ²¡ç”¨äº†) ï¼Œæ’å…¥é˜Ÿåˆ—çš„æ—¶å€™å»æ‰å®Œå…¨åŠ£äº $i$ çš„ï¼Œç„¶åå¯¹äºæŠ˜ä¸­çš„äºŒåˆ†å³å¯ã€‚(å…·ä½“å‚è§è¯—äººå° $\rm{G}$ çš„é¢˜è§£) ã€‚</li><li><strong>2.</strong> åˆ†æ²»è®¡ç®—ç­”æ¡ˆã€‚è®¾ $slove(al,ar,vl,vr)$ è¡¨ç¤ºåœ¨åŸæ•°ç»„ $al$ åˆ° $ar$ è¿™æ®µåŒºé—´çš„æœ€ä¼˜å†³ç­–ç‚¹ä½äº $vl$ åˆ° $vr$ åŒºé—´ã€‚æˆ‘ä»¬æ¯ä¸€æ¬¡æ‰¾åˆ° $al$ åˆ° $ar$ çš„ä¸­é—´ç‚¹ï¼Œä¹Ÿå°±æ˜¯ $mid$ ï¼Œç„¶ååœ¨ $vl$ åˆ° $vr$ å¯»æ‰¾æœ€ä¼˜çš„å†³ç­–ç‚¹æ›´æ–° $f_{mid}$ ( $\rm{DP}$ æ•°ç»„)ï¼Œè®¾è¿™ä¸ªæœ€ä¼˜ç‚¹ä¸º $g$ ã€‚å› ä¸ºæ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œ$al$ åˆ° $mid-1$ çš„æ‰€æœ‰ç‚¹çš„æœ€ä¼˜å†³ç­–ç‚¹ä¸€å®šåœ¨ $vl$ åˆ° $g$ ä¹‹é—´ï¼Œå³è¾¹ $mid+1$ åˆ° $ar$ çš„ä¹ŸåŒç†ï¼Œå°±è¿™ä¹ˆåˆ†æ²»ä¸‹å»å³å¯ã€‚</li></ul><p>å®é™…è¿ç”¨ä¸­åˆ†æ²»çš„æ•ˆç‡ä¸å¦‚ä¸‰å…ƒç»„ï¼Œä½†æ˜¯ä»£ç å´å¥½å†™å¾—å¤šï¼Œå¾ˆçŸ­ï¼Œå¹¶ä¸”è°ƒè¯•éš¾åº¦ä¹Ÿå¤§å¤§é™ä½ï¼Œæ‰€ä»¥æœ€ç»ˆæˆ‘é€‰æ‹©äº†åˆ†æ²»â€¦â€¦åˆ†æ²»çš„å…·ä½“ç»†èŠ‚çœ‹ä»£ç ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">6e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;ll a[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">double</span> f1[N],f2[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_f1</span><span class="params">(<span class="keyword">int</span> al,<span class="keyword">int</span> ar,<span class="keyword">int</span> vl,<span class="keyword">int</span> vr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(al&gt;ar) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(al+ar)&gt;&gt;<span class="number">1</span>,g=<span class="number">0</span>;</span><br><span class="line">    f1[mid]=a[mid];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=vl;i&lt;=min(vr,mid);++i) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> calc=a[i]+<span class="built_in">sqrt</span>(<span class="keyword">double</span>(mid-i));</span><br><span class="line">        <span class="keyword">if</span>(calc&gt;f1[mid]) f1[mid]=calc,g=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!g) g=mid;f1[mid]-=a[mid];</span><br><span class="line">    solve_f1(al,mid<span class="number">-1</span>,vl,g),solve_f1(mid+<span class="number">1</span>,ar,g,vr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_f2</span><span class="params">(<span class="keyword">int</span> al,<span class="keyword">int</span> ar,<span class="keyword">int</span> vl,<span class="keyword">int</span> vr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(al&gt;ar) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(al+ar)&gt;&gt;<span class="number">1</span>,g=<span class="number">0</span>;</span><br><span class="line">    f2[mid]=a[mid];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=vr;i&gt;=max(vl,mid);--i) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> calc=a[i]+<span class="built_in">sqrt</span>(<span class="keyword">double</span>(i-mid));</span><br><span class="line">        <span class="keyword">if</span>(calc&gt;f2[mid]) f2[mid]=calc,g=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!g) g=mid;f2[mid]-=a[mid];</span><br><span class="line">    solve_f2(al,mid<span class="number">-1</span>,vl,g),solve_f2(mid+<span class="number">1</span>,ar,g,vr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    solve_f1(<span class="number">1</span>,n,<span class="number">1</span>,n),solve_f2(<span class="number">1</span>,n,<span class="number">1</span>,n);</span><br><span class="line">    <span class="comment">/*æœ€ç»ˆæ²¡æœ‰ç¿»è½¬åºåˆ—ï¼Œè€Œæ˜¯é€‰æ‹©åšä¸¤éåˆ†æ²»*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(ll)<span class="built_in">ceil</span>(max(f1[i],f2[i])));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®è¿™é“é¢˜æ˜¯ $\rm{POI}$ çš„åŸé¢˜ï¼Œ$loj$ ä¼ é€é—¨é“¾æ¥ï¼š&lt;a href=&quot;https://loj.ac/problem/2074&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åœ¨è¿™å‘¢o(ï¿£ï¸¶ï¿£)o&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹è‚¯å®šè¿˜æ˜¯çœ‹ä¸å‡ºè¿™é¢˜æ˜¯ä»€ä¹ˆ $\rm{DP}$ ï¼Œæ„Ÿè§‰å¾ˆè¯¡å¼‚ï¼Œä½†æ˜¯æ¨ä¸€æ¨è‡ªç„¶å°±å‡ºæ¥äº†ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;h_j \leq h_i+p-\sqrt{|iâˆ’j|}\\\\p\geq h_j-h_i +\sqrt{|iâˆ’j|}\\\\p=\max\{ h_j-h_i +\sqrt{|iâˆ’j|}\}&lt;/script&gt;&lt;p&gt;è®¾ $f_i$ è¡¨ç¤º $i$ çš„ $p$ å€¼ï¼Œé‚£ä¹ˆç»§ç»­ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
      <category term="åˆ†æ²»" scheme="http://qiulyblog.github.io/tags/%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2016]å›½ç‹é¥®æ°´è®°  æ–œç‡ä¼˜åŒ–DP  loj2087</title>
    <link href="http://qiulyblog.github.io/2019/04/29/%5B%E9%A2%98%E8%A7%A3%5Dloj2087/"/>
    <id>http://qiulyblog.github.io/2019/04/29/[é¢˜è§£]loj2087/</id>
    <published>2019-04-28T16:00:00.000Z</published>
    <updated>2019-04-29T13:20:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¯çˆ±çš„é¢˜ç›®ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2087" target="_blank" rel="noopener">æˆ³æˆ‘æˆ³æˆ‘Â·(<em>â•¹â–½â•¹</em>)Â·</a></p><p>è¯´å®è¯è¿™é“é¢˜å¦‚æœå•çœ‹æ–œç‡ä¼˜åŒ– $\texttt{DP}$ ï¼Œä½†æ˜¯å¦‚æœæ²¡çŒœåˆ°é‚£ä¹ˆå¤šç»“è®ºï¼Œä½ æ˜¯æ€ä¹ˆä¹Ÿæƒ³ä¸åˆ°â€æ–œç‡ä¼˜åŒ–â€æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹çŒœç»“è®ºå§â€¦â€¦</p><ul><li><strong>1.</strong> åˆå§‹æ°´ä½å°äº $h_1$ çš„æ²¡æœ‰ç”¨ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ã€‚</p><a id="more"></a><ul><li><strong>2.</strong> å¦‚æœ $n\leq k$ ï¼Œé‚£ä¹ˆåªéœ€è¦å°†æ‰€ä»¥å¤§äº $h_1$ çš„è·Ÿ $1$ åŸå¸‚è¿å°±å¥½äº†ã€‚</li></ul><p>æ¯æ¬¡è¿æ¥çš„åŸå¸‚æ•°è¶Šå°‘è´¡çŒ®è¶Šå¤§ï¼Œé‚£ä¹ˆæ¯ä¸ªé€ä¸€è¿ä¸€æ¬¡ä¸€å®šæ˜¯æœ€ä¼˜æ–¹æ¡ˆã€‚</p><ul><li><strong>3.</strong> æ¯æ¬¡æ“ä½œå¿…ç„¶è·Ÿ $1$ åŸå¸‚æœ‰å…³ç³»ã€‚</li></ul><p>ä¸ç„¶æ²¡è´¡çŒ®ã€‚</p><ul><li><strong>4.</strong> é™¤äº† $1$ å·åŸå¸‚ï¼Œå…¶ä»–æ¯ä¸ªåŸå¸‚æœ€å¤šè¿ä¸€æ¬¡ã€‚</li></ul><p>å› ä¸ºè¿è¿‡ä¸€æ¬¡çš„åŸå¸‚çš„æ°´ä½å·²ç»å’Œ $1$ åŸå¸‚ä¸€æ ·äº†ï¼Œç®€å•ç‚¹è¯´è‚¯å®šå°±æ˜¯åºŸäº†ã€‚</p><ul><li><strong>5.</strong> æ¯æ¬¡è¿çš„æ‰€æœ‰åŸå¸‚ä¸­æœ€å°çš„ $h_i$ å¿…ç„¶å¤§äºä¸Šä¸€æ¬¡é“¾æ¥çš„æœ€å¤§çš„ $h_i$ ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ï¼Œä¸ç„¶ä¸æ»¡è¶³æœ€ä¼˜æ–¹æ¡ˆã€‚</p><ul><li><strong>6.</strong> å°†æ‰€ä»¥åŸå¸‚æŒ‰æ°´ä½æ’åºåï¼Œæ¯æ¬¡é€‰æ‹©çš„å¿…ç„¶æ˜¯è¿ç»­ä¸€æ®µåŒºé—´ã€‚</li></ul><p>å’Œä¸Šä¸€ä¸ªå·®ä¸å¤šã€‚</p><ul><li><strong>7.</strong> æ¯æ¬¡é€‰æ‹©çš„åŒºé—´å¿…ç„¶å’Œä¸Šä¸€æ¬¡çš„é€‰æ‹©åŒºé—´æ¥è§¦ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ã€‚</p><ul><li><strong>8.</strong> æ¯æ¬¡é€‰æ‹©çš„åŒºé—´çš„é•¿åº¦å¿…å®šå•è°ƒä¸å¢ã€‚</li></ul><p>æ»¡è¶³æœ€ä¼˜ï¼Œéƒ½è¯´äº†æ¯æ¬¡è¿æ¥çš„åŸå¸‚è¶Šå°‘è´¡çŒ®è¶Šå¤§ã€‚</p><hr><p>é‚£ä¹ˆæ˜¾ç„¶å°±å˜æˆäº†ä¸€ä¸ªåŒºé—´é—®é¢˜äº†ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªåŒºé—´åˆ†æˆè‹¥å¹²å—ã€‚</p><p>è®¾ $f_{i,j}$ è¡¨ç¤ºæ’åºåå‰ $i$ ä¸ªåŸå¸‚è”é€šäº† $j$ æ¬¡å $1$ å·åŸå¸‚çš„æœ€å¤§æ°´ä½é«˜åº¦ã€‚é‚£ä¹ˆè½¬ç§»ç›´æ¥æšä¸¾ä¸€ä¸ª $k$ ï¼Œåœ¨æ–°çš„ä¸€æ¬¡è¿æ¥ä¸­è¿æ¥äº† $k+1$ åˆ° $i$ è¿™äº›åŸå¸‚ã€‚è½¬ç§»æ–¹ç¨‹æ˜¾ç„¶ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\frac{f_{k,j-1}+(s_i-s_k)}{i-k+1}</script><p>*æ³¨ï¼š$s_i$ ä¸ºå‰ç¼€å’Œã€‚</p><p>ä¸Šå¼çš„å¤æ‚åº¦ä¸º $O(n^2k)$  ï¼Œè‚¯å®šçˆ†ç‚¸ã€‚ä½†æ˜¯è¿™ä¸ªæ˜¯å¯ä»¥<strong>æ–œç‡ä¼˜åŒ–</strong>çš„ï¼š</p><script type="math/tex; mode=display">\frac{f_{k,j-1}+(s_i-s_k)}{i-k+1} =\frac{s_i-(s_k-f_{k,j-1})}{i-(k-1)}\Rightarrow \frac{Y(i)-Y(k)}{X(i)-X(k)}</script><p>ç„¶åé€šè¿‡ç¬¬ $8$ æ¡æ€§è´¨å¯ä»¥å¾—çŸ¥ $\texttt{DP}$ æ˜¯æœ‰<strong>å†³ç­–å•è°ƒæ€§</strong>çš„ï¼Œæ•…å¤æ‚åº¦ä¸º $O(nk)$ ã€‚å› ä¸ºæ¶å¿ƒçš„é«˜ç²¾åº¦å°æ•°çš„è¿ç®—è¿˜éœ€è¦ $O(p)$ çš„å¤æ‚åº¦ï¼Œæ‰€ä»¥æœ€ç»ˆæ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(nkp)$ ã€‚</p><p>æˆ‘ä»¬å‘ç° $k$ æœ‰ $10^9$ ï¼Œæ‰€ä»¥å¤æ‚åº¦å¸¦ $k$ çš„ä¸€å®šå‡æ‰äº†ã€‚</p><p>é‚£ä¹ˆè§‚å¯Ÿç¬¬ $2$ æ¡æ€§è´¨ä¼šå‘ç°ï¼Œå¦‚æœ $k$ å¤§äº $n$ äº†ç›´æ¥å°† $k$ è®¾ä¸º $n$ å°±å¥½äº†ã€‚ä¹Ÿå°±æ˜¯è¯´å¤æ‚åº¦åº”è¯¥ä¸º $O(n^2p)$ ï¼Œè¿™æ ·å°±æ˜¯ $86$ åˆ†ï¼Œé€šè¿‡æ•°æ®æ¥çœ‹ä¼šå‘ç°è¿™ä¸ªå€¾å‘äºå¤§ä¼—åˆ†ï¼Œä¸€è½¦å¢çš„äººéƒ½æ˜¯è¿™ä¸ªåˆ†æ•°ã€‚</p><p>é‚£ä¹ˆå¦‚æœæƒ³è¦ $\texttt{AC}$ çš„è¯éœ€è¦æœ€åä¸€æ¡å¾ˆè¿·çš„æ€§è´¨ï¼š</p><ul><li><strong>9.</strong> å› ä¸º $h$ å„ä¸åŒï¼Œé€‰æ‹©çš„åŒºé—´æœ€å¤šåªæœ‰ $14$ ä¸ªåŒºé—´é•¿åº¦å¤§äº $1$ ï¼Œå…¶ä»–çš„åŒºé—´å‡ç­‰äº $1$ ã€‚</li></ul><p>å¾ˆè¿·ï¼Œå‡†ç¡®çš„è¯´è¿™æ ·çš„åŒºé—´æ˜¯ $O(\log\frac{nh}{\min_i\{h_i-h_{i-1}\}})$ ä¸ªã€‚</p><p>è¯æ˜ä¸ä¼šâ€¦â€¦ä½†æ˜¯è¿™é‡Œå†™äº†è¯æ˜(å”¯ä¸€çš„ä¸”å¾ˆè¿·çš„è¯æ˜)ï¼š<a href="https://github.com/qiulyblog/image/blob/master/[NOI2016]%E5%9B%BD%E7%8E%8B%E9%A5%AE%E6%B0%B4%E8%AE%B0%E9%A2%98%E8%A7%A3.pdf?raw=true" target="_blank" rel="noopener">å“ˆå“ˆæˆ‘æ˜¯ä¼ é€é—¨O(âˆ©_âˆ©)O</a></p><p>é‚£ä¹ˆå°±ä¸¢ä»£ç äº†ï¼Œå®é™…ä¸Šæ˜¯éœ€è¦é«˜ç²¾å°æ•°çš„ï¼Œè¿™é‡Œå…ˆç»™å‡ºä¸€ä¸ªé™¤å»é«˜ç²¾å°æ•°æ¿å­çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">8e3</span>+<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">Decimal ans;</span><br><span class="line"><span class="keyword">int</span> n,k,p,lim,h[N],s[N],pre[N][<span class="number">16</span>],tot;</span><br><span class="line"><span class="keyword">int</span> q[N],head,tail;</span><br><span class="line"><span class="keyword">double</span> f[N][<span class="number">16</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span>&#123;</span><span class="keyword">double</span> x,y;&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(point a,point b)</span> </span>&#123;<span class="keyword">return</span> (a.y-b.y)/(a.x-b.x);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Decimal <span class="title">solve</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!j) <span class="keyword">return</span> h[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> (solve(pre[i][j],j<span class="number">-1</span>)+s[i]-s[pre[i][j]])/(i-pre[i][j]+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;k,&amp;p,&amp;h[tot=<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d\n"</span>,&amp;h[i]);</span><br><span class="line">        <span class="keyword">if</span>(h[i]&gt;h[<span class="number">1</span>]) h[++tot]=h[i];</span><br><span class="line">    &#125;</span><br><span class="line">    n=tot;sort(&amp;h[<span class="number">1</span>],&amp;h[n+<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][<span class="number">0</span>]=h[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]=s[i<span class="number">-1</span>]+h[i];</span><br><span class="line">    k=min(k,n),lim=min(k,<span class="number">14</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=lim;++j) &#123;</span><br><span class="line">        q[head=tail=<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) t[i]=(point)&#123;i<span class="number">-1</span>,s[i]-f[i][j<span class="number">-1</span>]&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            point now=(point)&#123;i,s[i]&#125;;</span><br><span class="line">            <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(now,t[q[head]])&lt;slope(now,t[q[head+<span class="number">1</span>]])) ++head;</span><br><span class="line">            f[i][j]=(f[q[head]][j<span class="number">-1</span>]+s[i]-s[q[head]])/(i-q[head]+<span class="number">1</span>);</span><br><span class="line">            pre[i][j]=q[head];</span><br><span class="line">            <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(t[q[tail]],t[q[tail<span class="number">-1</span>]])&gt;slope(t[q[tail]],t[i])) --tail;</span><br><span class="line">            q[++tail]=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m=n-k+lim,pos;</span><br><span class="line">    <span class="keyword">double</span> mx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=lim;++i) </span><br><span class="line">        <span class="keyword">if</span>(f[m][i]&gt;mx) mx=f[m][i],pos=i;</span><br><span class="line">    ans=solve(m,pos);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=m+<span class="number">1</span>;i&lt;=n;++i) ans=(ans+h[i])/<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans.to_string(p&lt;&lt;<span class="number">1</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆé«˜ç²¾åº¦å°æ•°æ¿å­çš„ä¸‹è½½é“¾æ¥å°±è´´è¿™äº†ï¼š<a href="https://loj.ac/problem/2087/download/additional_file" target="_blank" rel="noopener">$loj$ çš„ä¸‹è½½åœ°å€ä¼ é€ä»¬(ï½ï¿£â–½ï¿£)ï½</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯çˆ±çš„é¢˜ç›®ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2087&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ³æˆ‘æˆ³æˆ‘Â·(&lt;em&gt;â•¹â–½â•¹&lt;/em&gt;)Â·&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯´å®è¯è¿™é“é¢˜å¦‚æœå•çœ‹æ–œç‡ä¼˜åŒ– $\texttt{DP}$ ï¼Œä½†æ˜¯å¦‚æœæ²¡çŒœåˆ°é‚£ä¹ˆå¤šç»“è®ºï¼Œä½ æ˜¯æ€ä¹ˆä¹Ÿæƒ³ä¸åˆ°â€æ–œç‡ä¼˜åŒ–â€æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹çŒœç»“è®ºå§â€¦â€¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;1.&lt;/strong&gt; åˆå§‹æ°´ä½å°äº $h_1$ çš„æ²¡æœ‰ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™å¾ˆæ˜¾ç„¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç®—æ³•ã€‘ å°è°ˆæ–œç‡ä¼˜åŒ–</title>
    <link href="http://qiulyblog.github.io/2019/04/28/%5B%E7%AE%97%E6%B3%95%5D%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    <id>http://qiulyblog.github.io/2019/04/28/[ç®—æ³•]æ–œç‡ä¼˜åŒ–/</id>
    <published>2019-04-27T16:00:00.000Z</published>
    <updated>2019-05-06T05:42:53.964Z</updated>
    
    <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="å†æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡" />    <label for="pass">å†æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡ä¸ºåŠ å¯†æ–‡ç« ï¼Œé˜…è¯»æœ¬æ–‡éœ€è¦è¾“å…¥å¯†ç ã€‚
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="ç®—æ³•" scheme="http://qiulyblog.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2015]äºšç‘Ÿç‹  æ¦‚ç‡DP  loj2112</title>
    <link href="http://qiulyblog.github.io/2019/04/28/%5B%E9%A2%98%E8%A7%A3%5Dloj2112/"/>
    <id>http://qiulyblog.github.io/2019/04/28/[é¢˜è§£]loj2112/</id>
    <published>2019-04-27T16:00:00.000Z</published>
    <updated>2019-04-29T13:18:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‘ç° <a href="https://loj.ac" target="_blank" rel="noopener">$loj$</a> çœŸçš„å¥½ç”¨â€¦â€¦æ¯” $luogu$ ä¸çŸ¥é“æ¸…çˆ½åˆ°å“ªé‡Œå»äº†ï¼Œæ›´ä½•å†µ $loj$ çš„é¢˜ç›®ä¹Ÿæ›´å¤šï¼Œè€Œä¸”æä¾›æ•°æ®å’Œä»£ç ï¼Œæ›´åŠ å¼€æ”¾ã€‚ä¼°è®¡ä»¥åéƒ½ä¼šåœ¨ $loj$ ä¸Šå¤šé€›é€›ã€‚( $bzoj$ æ˜¯çœŸçš„ä¸‘ï¼Œé™¤éæ˜¯åš $bzoj$ çš„åŸåˆ›é¢˜ä¸ç„¶æˆ‘ä¸ä¼šä¸Š $bzoj$ çš„) ã€‚</p><p>é¡ºä¾¿è´´ä¸€ä¸‹é¢˜ç›®ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2112" target="_blank" rel="noopener">$loj$çš„ä¼ é€é—¨å°±æˆ³æˆ‘å•¦(ï½ï¿£â–½ï¿£)ï½</a></p><p>æ¦‚ç‡ $\texttt{DP}$ ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºæ‰“äº†å‰ $i$ å¼ ç‰Œï¼Œè¿˜æœ‰ $j$ è½®æ²¡æœ‰æ‰“å‡ºç‰Œçš„æ¦‚ç‡ã€‚æˆ‘ä»¬æšä¸¾ç¬¬ $i+1$ å¼ ç‰Œï¼Œåˆ†åˆ«è®¨è®ºä¸€ä¸‹è¯¥ç‰Œæ‰“å‡ºä¸ä¸æ‰“å‡ºçš„æƒ…å†µå³å¯ã€‚</p><a id="more"></a><p>ç¬¬ä¸€ç§æƒ…å†µï¼š$j$ è½®ä¸­éƒ½æ²¡æœ‰æ‰“å‡ºç¬¬ $i+1$ å¼ ç‰Œï¼Œç”±äºä¸€è½®ä¸­ä¸æ‰“å‡ºç¬¬ $i+1$ å¼ ç‰Œçš„æ¦‚ç‡ä¸º $1-p_i$ ï¼Œé‚£ä¹ˆ $j$ è½®éƒ½ä¸æ‰“å‡ºè¯¥ç‰Œçš„æ¦‚ç‡æ˜¾ç„¶ä¸º $(1-p_i)^j$ ã€‚è½¬ç§»æ–¹ç¨‹æ˜¾ç„¶ï¼š</p><script type="math/tex; mode=display">f_{i+1,j}+=f_{i,j}\cdot (1-p_i)^jâ€‹</script><p>å› ä¸º $f_{i+1,j}$ å¯èƒ½ä»å¤šæ–¹å‘è½¬ç§»è¿‡æ¥ï¼Œæ‰€ä»¥æ˜¯ $+=$ ã€‚</p><p>ç¬¬äºŒç§æƒ…å†µï¼š$j$ è½®ä¸­è‡³å°‘æœ‰ä¸€è½®æ‰“å‡ºäº†ç¬¬ $i+1$ å¼ ç‰Œï¼Œæ¦‚ç‡æ˜¾ç„¶ä¸º $1-(1-p_i)^j$ ï¼Œè½¬ç§»ä¹Ÿå°±å¾ˆæ˜¾ç„¶äº†ï¼š</p><script type="math/tex; mode=display">f_{i+1,j-1}+=f_{i,j}\cdot ï¼ˆ1-(1-p_i)^jï¼‰</script><p>å¦‚æœæˆ‘ä»¬æ‰“å‡ºäº†ç¬¬ $i+1$ å¼ ç‰Œï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯è¦è®¡ç®—è´¡çŒ®çš„ï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥ç”¨è¿™ä¸ªæ¦‚ç‡ç®—è´¡çŒ®å°±å¥½äº†ã€‚</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> T,n,r,d[N];</span><br><span class="line"><span class="keyword">double</span> f[N][N],p[N],pw[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;r);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%lf%d"</span>,&amp;p[i],&amp;d[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            pw[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=r;++j) pw[i][j]=pw[i][j<span class="number">-1</span>]*(<span class="number">1</span>-p[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        f[<span class="number">0</span>][r]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=r;++j) &#123;</span><br><span class="line">                f[i+<span class="number">1</span>][j]+=f[i][j]*pw[i+<span class="number">1</span>][j];</span><br><span class="line">                <span class="keyword">if</span>(j) &#123;</span><br><span class="line">                    <span class="keyword">double</span> calc=f[i][j]*(<span class="number">1</span>-pw[i+<span class="number">1</span>][j]);</span><br><span class="line">                    f[i+<span class="number">1</span>][j<span class="number">-1</span>]+=calc,ans+=calc*d[i+<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.10f\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç° &lt;a href=&quot;https://loj.ac&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;$loj$&lt;/a&gt; çœŸçš„å¥½ç”¨â€¦â€¦æ¯” $luogu$ ä¸çŸ¥é“æ¸…çˆ½åˆ°å“ªé‡Œå»äº†ï¼Œæ›´ä½•å†µ $loj$ çš„é¢˜ç›®ä¹Ÿæ›´å¤šï¼Œè€Œä¸”æä¾›æ•°æ®å’Œä»£ç ï¼Œæ›´åŠ å¼€æ”¾ã€‚ä¼°è®¡ä»¥åéƒ½ä¼šåœ¨ $loj$ ä¸Šå¤šé€›é€›ã€‚( $bzoj$ æ˜¯çœŸçš„ä¸‘ï¼Œé™¤éæ˜¯åš $bzoj$ çš„åŸåˆ›é¢˜ä¸ç„¶æˆ‘ä¸ä¼šä¸Š $bzoj$ çš„) ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºä¾¿è´´ä¸€ä¸‹é¢˜ç›®ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2112&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;$loj$çš„ä¼ é€é—¨å°±æˆ³æˆ‘å•¦(ï½ï¿£â–½ï¿£)ï½&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¦‚ç‡ $\texttt{DP}$ ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºæ‰“äº†å‰ $i$ å¼ ç‰Œï¼Œè¿˜æœ‰ $j$ è½®æ²¡æœ‰æ‰“å‡ºç‰Œçš„æ¦‚ç‡ã€‚æˆ‘ä»¬æšä¸¾ç¬¬ $i+1$ å¼ ç‰Œï¼Œåˆ†åˆ«è®¨è®ºä¸€ä¸‹è¯¥ç‰Œæ‰“å‡ºä¸ä¸æ‰“å‡ºçš„æƒ…å†µå³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [CEOI2017]Building Bridges æ–œç‡ä¼˜åŒ–DP loj2483</title>
    <link href="http://qiulyblog.github.io/2019/04/27/%5B%E9%A2%98%E8%A7%A3%5Dloj2483/"/>
    <id>http://qiulyblog.github.io/2019/04/27/[é¢˜è§£]loj2483/</id>
    <published>2019-04-26T16:00:00.000Z</published>
    <updated>2019-04-29T13:17:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ„‰å¿«çš„æ¨å¼å­å§(ï¾‰â‰§âˆ€â‰¦)ï¾‰ï¼</p><p>è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ æ ¹æŸ±å­å®Œå·¥åçš„æœ€å°ä»£ä»·ã€‚æšä¸¾ä¸€ä¸ªå°äº $i$ çš„ $j$ ï¼Œè¡¨ç¤ºä¸ºä» $j$ å‘ $i$ è¿äº†ä¸€åº§æ¡¥ï¼Œä¸­é—´çš„æŸ±å­å½“ç„¶å…¨éƒ¨æ¨æ‰ï¼Œè®¡ç®—ä¸€ä¸‹å°±å¥½ï¼š</p><script type="math/tex; mode=display">f_i=\min\{f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\}</script><p>*å…¶ä¸­ $s$ ä¸º $w$ çš„å‰ç¼€å’Œã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\\\\f_i=f_j+s_{i-1}-s_j+h_i^2+h_j^2-2h_ih_j\\\\f_j+s_{i-1}-s_j+h_i^2+h_j^2=2h_ih_j+f_i</script><p>äºæ˜¯æœ€ç»ˆå¼å­å˜æˆäº† $y=kx+b$ çš„å½¢å¼ï¼Œæ–œç‡ä¼˜åŒ–ï¼</p><p>ä½†æ˜¯â€¦â€¦æ³¨æ„è¿™ä¸ªå¼å­çš„ $k$ ä¸æ˜¯å•è°ƒé€’å¢çš„ï¼Œå¹¶ä¸” $x$ ä¹Ÿä¸æ˜¯å•è°ƒé€’å¢çš„ï¼é‚£ä¹ˆæˆ‘ä»¬ä¸èƒ½ç”¨æœ´ç´ åšæ³•äº†ï¼Œä¹Ÿä¸èƒ½ç”¨äºŒåˆ†â€¦â€¦éš¾é“ç”¨ $Splay$ ï¼Ÿ(ç é‡å·¨å¤§) ã€‚</p><p>ä¸ï¼Œç”¨ $CDQ$ åˆ†æ²»ã€‚</p><p>å¯¹äºä¸€ä¸ª $i$ ï¼Œå¯èƒ½å¯ä»¥å¯¹ $i$ åšå‡ºè´¡çŒ®çš„åªæœ‰æ‰€æœ‰å°äº $i$ çš„ $j$ ã€‚ä¸ºäº†ä¿è¯ $x$ å•è°ƒæˆ‘ä»¬å…ˆå¤§åŠ›å°†åŸæ¥çš„æ•°ç»„æŒ‰ç…§ $x$ ä»å°åˆ°å¤§æ’ä¸ªåºï¼Œç„¶å $CDQ$ çš„æ—¶å€™åˆ†å·¦å³ä¸¤è¾¹ï¼Œå·¦è¾¹çš„æ‰€æœ‰å…ƒç´ åœ¨åˆå§‹æ•°ç»„çš„ä½ç½®éƒ½å°äºå³è¾¹çš„å·¦å³å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç›´æ¥ç”¨å·¦è¾¹å…ƒç´ å¯¹å³è¾¹å…ƒç´ åšå‡ºè´¡çŒ®ã€‚</p><p>åŒæ—¶è¿™é‡Œä¹Ÿä¿è¯äº†å·¦å³ä¸¤è¾¹çš„ $x$ ä¸€å®šæ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ï¼Œæ‰«ä¸€éå·¦è¾¹çš„å…ƒç´ ï¼Œç•™ä¸‹èƒ½åšè´¡çŒ®çš„ç‚¹(ä¸‹å‡¸å£³ä¸Šçš„ç‚¹)ï¼Œè¿™æ—¶å€™å·¦è¾¹çš„æ‰€æœ‰å…ƒç´ å¯ä»¥ä¿è¯ $x$ å’Œæ–œç‡éƒ½æ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>å³è¾¹å‘¢ï¼Ÿå› ä¸ºç›´çº¿çš„æ–œç‡æ˜¯ $2x$ ï¼Œè€Œå³è¾¹çš„ $x$ ä¹Ÿæ˜¯å•è°ƒä¸Šå¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„‰å¿«çš„åšæœ´ç´ çš„å•è°ƒé˜Ÿåˆ—äº†ã€‚</p><p>$CDQ$ åˆ†æ²»éƒ¨åˆ†çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;<span class="comment">/*ä¸€ä¸ªç‚¹çš„æ—¶å€™ç›´æ¥è®¡ç®—yå€¼*/</span></span><br><span class="line">        a[l].y=f[a[l].id]-s[a[l].id]+S(a[l].x);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(a[i].id&lt;=mid) b[c1++]=a[i]; <span class="comment">/*ç¼–å·å°çš„å·¦è¾¹å»*/</span></span><br><span class="line">        <span class="keyword">else</span> b[c2++]=a[i]; <span class="comment">/*ç¼–å·å¤§äº›çš„å³è¾¹å»*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    CDQ(l,mid); <span class="comment">/*è®¡ç®—å‡ºå·¦è¾¹æ‰€æœ‰å…ƒç´ çš„ f*/</span></span><br><span class="line">    <span class="keyword">int</span> head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=mid;++i) &#123; <span class="comment">/*å¤„ç†å‡ºå·¦è¾¹æ‰€æœ‰å…ƒç´ ç»„æˆçš„ä¸‹å‡¸å£³*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail<span class="number">-1</span>],q[tail])&gt;slope(q[tail],i)) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=mid+<span class="number">1</span>;i&lt;=r;++i) &#123; <span class="comment">/*è®¡ç®—å·¦è¾¹å…ƒç´ å¯¹å³è¾¹å…ƒç´ äº§ç”Ÿçš„è´¡çŒ®*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*a[i].x) ++head; <span class="comment">/*ç»´æŠ¤é˜Ÿåˆ—*/</span></span><br><span class="line">        <span class="keyword">int</span> x=a[i].id,y=a[q[head]].id;</span><br><span class="line">        f[x]=min(f[x],f[y]+s[x<span class="number">-1</span>]-s[y]+S(a[i].x-a[q[head]].x));</span><br><span class="line">        <span class="comment">/*å¯èƒ½è®¡ç®—å¤šæ¬¡æ‰€ä»¥è¦å–min*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i)  <span class="comment">/*è¿˜åŸaæ•°ç»„è‡³åˆå§‹çŠ¶æ€*/</span></span><br><span class="line">        <span class="keyword">if</span>(c2&gt;r||(c1&lt;=mid&amp;&amp;a[c1].x&lt;a[c2].x)) b[i]=a[c1++];</span><br><span class="line">        <span class="keyword">else</span> b[i]=a[c2++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//mainå‡½æ•°ä¸­</span></span><br><span class="line">sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n,cmp),CDQ(<span class="number">1</span>,n); <span class="comment">/*æ’åºåCDQå¼€å§‹*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]); <span class="comment">/*è¾“å‡º*/</span></span><br></pre></td></tr></table></figure><p>æœ€åå› ä¸ºå­˜åœ¨ $0$ ï¼Œåœ¨è®¡ç®—æ–œç‡çš„æ—¶å€™éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚è¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹ $long\ long$ çš„é—®é¢˜ï¼Œè®°å¾—å°† $f$ æ•°ç»„åˆå§‹åŒ–ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf=<span class="number">1e18</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span><span class="keyword">int</span> x,id;ll y;&#125;a[N],b[N];</span><br><span class="line">ll s[N],w[N],f[N];<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll x)</span> </span>&#123;<span class="keyword">return</span> x*x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(point x,point y)</span> </span>&#123;<span class="keyword">return</span> x.x&lt;y.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a[i].x==a[j].x) &#123;</span><br><span class="line">        <span class="keyword">return</span> a[i].y&lt;a[j].y?inf:-inf;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="keyword">double</span>(a[i].y-a[j].y)/<span class="keyword">double</span>(a[i].x-a[j].x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;a[l].y=f[a[l].id]-s[a[l].id]+S(a[l].x);<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(a[i].id&lt;=mid) b[c1++]=a[i];</span><br><span class="line">        <span class="keyword">else</span> b[c2++]=a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    CDQ(l,mid);</span><br><span class="line">    <span class="keyword">int</span> head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=mid;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail<span class="number">-1</span>],q[tail])&gt;slope(q[tail],i)) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=mid+<span class="number">1</span>;i&lt;=r;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*a[i].x) ++head;</span><br><span class="line">        <span class="keyword">int</span> x=a[i].id,y=a[q[head]].id;</span><br><span class="line">        f[x]=min(f[x],f[y]+s[x<span class="number">-1</span>]-s[y]+S(a[i].x-a[q[head]].x));</span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(c2&gt;r||(c1&lt;=mid&amp;&amp;a[c1].x&lt;a[c2].x)) b[i]=a[c1++];</span><br><span class="line">        <span class="keyword">else</span> b[i]=a[c2++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        IN(a[i].x),a[i].id=i,f[i]=inf;</span><br><span class="line">    f[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(w[i]),s[i]=s[i<span class="number">-1</span>]+w[i];</span><br><span class="line">    sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n,cmp),CDQ(<span class="number">1</span>,n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ„‰å¿«çš„æ¨å¼å­å§(ï¾‰â‰§âˆ€â‰¦)ï¾‰ï¼&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ æ ¹æŸ±å­å®Œå·¥åçš„æœ€å°ä»£ä»·ã€‚æšä¸¾ä¸€ä¸ªå°äº $i$ çš„ $j$ ï¼Œè¡¨ç¤ºä¸ºä» $j$ å‘ $i$ è¿äº†ä¸€åº§æ¡¥ï¼Œä¸­é—´çš„æŸ±å­å½“ç„¶å…¨éƒ¨æ¨æ‰ï¼Œè®¡ç®—ä¸€ä¸‹å°±å¥½ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\min\{f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\}&lt;/script&gt;&lt;p&gt;*å…¶ä¸­ $s$ ä¸º $w$ çš„å‰ç¼€å’Œã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [APIO2010]ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ  æ–œç‡ä¼˜åŒ–DP  luoguP3628</title>
    <link href="http://qiulyblog.github.io/2019/04/24/%5B%E9%A2%98%E8%A7%A3%5DluoguP3628/"/>
    <id>http://qiulyblog.github.io/2019/04/24/[é¢˜è§£]luoguP3628/</id>
    <published>2019-04-23T16:00:00.000Z</published>
    <updated>2019-04-28T05:52:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¾æ—§æ˜¯æ–œç‡ä¼˜åŒ–çš„å¥—è·¯ã€‚</p><p>è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªå£«å…µçš„æœ€å¤§è´¡çŒ®ï¼Œè½¬ç§»æ˜¾ç„¶æ˜¯æšä¸¾ä¸€ä¸ª $j$ ï¼Œå°† $j+1$ åˆ° $i$ è¿™äº›å£«å…µç»„æˆç‰¹åˆ«è¡ŒåŠ¨é˜Ÿç®—è´¡çŒ®ï¼š</p><script type="math/tex; mode=display">f_i=\max\{f_j+a(s_i-s_j)^2+b(s_i-s_j)+c\}â€‹</script><p>å…¶ä¸­ $s_i$ ä¸ºæˆ˜æ–—åŠ›çš„å‰ç¼€å’Œã€‚è¿™ä¸ªæ–¹ç¨‹æ˜¯ $O(n^2)$ çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚å‘ç°è¿™ä¸ªè½¬ç§»å¼è²Œä¼¼ä¸æ»¡è¶³å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ¡ä»¶ï¼Œäºæ˜¯å°†ä¸­é—´çš„å¼å­æ‹†å¼€çœ‹çœ‹å¯ä¸å¯ä»¥æ–œç‡ä¼˜åŒ–ã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=\max\{f_j+a(s_i^2+s_j^2-2s_is_j)+b\cdot s_i-b\cdot s_j+c\}\\f_i=\max\{f_j+a\cdot s_i^2+a\cdot s_j^2-2a\cdot s_is_j)+b\cdot s_i-b\cdot s_j+c\}\\f_i=f_j+a\cdot s_i^2+a\cdot s_j^2-2a\cdot s_is_j+b\cdot s_i-b\cdot s_j+c\\f_j+a\cdot s_i^2+a\cdot s_j^2+b\cdot s_i-b\cdot s_j+c=2a\cdot s_i\cdot s_j +f_iâ€‹</script><p>è¯¶ï¼Œæ˜¯ $y=kx+b$ çš„å½¢å¼ï¼Œè€Œä¸”æ»¡è¶³æ–œç‡ä¼˜åŒ–çš„æ¡ä»¶è¯¶ã€‚ç»§ç»­å°† $x,y$ æ‰¾å‡ºæ¥æ”¾åˆ°åæ ‡ç³»ä¸Š( $x=s_j$,$y=f_j+a\cdot s_j^2-b\cdot s_j$) ã€‚</p><p>å› ä¸ºæ˜¯ $\maxâ€‹$ ï¼Œæ‰€ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸€ä¸‹ä¸Šå‡¸å£³ç„¶åè½¬ç§»å³å¯ï¼Œå¤æ‚åº¦ $O(n)â€‹$ ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) ((x)*(x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e6</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> n,a,b,c,head,tail;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> s[N],f[N],q[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">X</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> s[i];&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> f[i]+<span class="number">1l</span>l*S(s[i])*a<span class="number">-1l</span>l*s[i]*b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;<span class="keyword">return</span> (Y(j)-Y(i))/(X(j)-X(i));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    f[i]=f[j]+<span class="number">1l</span>l*S(s[i]-s[j])*a+<span class="number">1l</span>l*(s[i]-s[j])*b+c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(a),IN(b),IN(c);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(s[i]),s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&gt;<span class="number">2</span>*a*s[i]) ++head;</span><br><span class="line">        calc(i,q[head]);</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail],i)&gt;slope(q[tail],q[tail<span class="number">-1</span>])) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¾æ—§æ˜¯æ–œç‡ä¼˜åŒ–çš„å¥—è·¯ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªå£«å…µçš„æœ€å¤§è´¡çŒ®ï¼Œè½¬ç§»æ˜¾ç„¶æ˜¯æšä¸¾ä¸€ä¸ª $j$ ï¼Œå°† $j+1$ åˆ° $i$ è¿™äº›å£«å…µç»„æˆç‰¹åˆ«è¡ŒåŠ¨é˜Ÿç®—è´¡çŒ®ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\max\{f_j+a(s_i-s_j)^2+b(s_i-s_j)+c\}â€‹&lt;/script&gt;&lt;p&gt;å…¶ä¸­ $s_i$ ä¸ºæˆ˜æ–—åŠ›çš„å‰ç¼€å’Œã€‚è¿™ä¸ªæ–¹ç¨‹æ˜¯ $O(n^2)$ çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚å‘ç°è¿™ä¸ªè½¬ç§»å¼è²Œä¼¼ä¸æ»¡è¶³å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ¡ä»¶ï¼Œäºæ˜¯å°†ä¸­é—´çš„å¼å­æ‹†å¼€çœ‹çœ‹å¯ä¸å¯ä»¥æ–œç‡ä¼˜åŒ–ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2008]ç©å…·è£…ç®±TOY  æ–œç‡ä¼˜åŒ–DP  luoguP3195</title>
    <link href="http://qiulyblog.github.io/2019/04/24/%5B%E9%A2%98%E8%A7%A3%5DluoguP3195/"/>
    <id>http://qiulyblog.github.io/2019/04/24/[é¢˜è§£]luoguP3195/</id>
    <published>2019-04-23T16:00:00.000Z</published>
    <updated>2019-04-28T05:51:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>å·®ä¸å¤šææ‡‚äº†æ–œç‡ä¼˜åŒ–å§â€¦â€¦è¯´å®è¯ç½‘ä¸Šçš„æ–‡ç« éƒ½å†™å¾—å¾ˆè¿·ï¼Œè¿˜å¥½æ‰¾åˆ°äº†ä¸€ä¸ªä¸é”™çš„æ–‡ç« ï¼š<a href="https://www.cnblogs.com/yangsongyi/p/9630227.html" target="_blank" rel="noopener">è½¬é€é—¨æˆ³æˆ‘(ï¿£â–½ï¿£)~*</a> ã€‚(ä¸ºä»€ä¹ˆçªç„¶å‘ç°è¿™é“é¢˜å’Œè¯—äººå°Gå¾ˆåƒå‘¢) </p><p>è¿™ä¸ª $\texttt{DP}$ æ–¹ç¨‹è°éƒ½ä¼šè®¾ï¼šè®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªç©å…·çš„æœ€å°è´¹ç”¨ï¼Œè½¬ç§»æ˜¾ç„¶å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f_i=\min\limits_{j=1}^{i-1}\{f_j+(sum_i-sum_j+i-j-l)^2\}</script><p>(å…¶ä¸­ $sum$ æ˜¯å‰ç¼€å’Œ)ã€‚è¿™ä¸ªå¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ï¼Œè¿‡ä¸å»â€¦â€¦</p><a id="more"></a><p>ç»§ç»­æ¨å¼å­ï¼š</p><script type="math/tex; mode=display">f_i=\min\limits_{j=1}^{i-1}\{f_j+[(sum_i+i)-(sum_j+j)-l]^2\}</script><p>è®¾ $s_i=sum_i+i$ ï¼Œæˆ‘ä»¬å‡è®¾ $j$ ä¸ºæœ€ä¼˜å†³ç­–ï¼Œå°† $\min$ å»æ‰ã€‚</p><script type="math/tex; mode=display">f_i=f_j+(s_i-s_j-l)^2\\f_i=f_j+s_i^2+(s_j+l)^2-2\cdot s_i\cdot(s_j+l)\\f_j+s_i^2+(s_j+l)^2=2\cdot s_i\cdot(s_j+l)+f_iâ€‹</script><p>äºæ˜¯ä¸Šé¢çš„å¼å­å˜æˆäº† $y=kx+b$ çš„å½¢å¼ï¼Œå…¶ä¸­ $y=f_j+s_i^2+(s_j+l)^2$ ï¼Œ$k=2\cdot s_i$ ï¼Œ$x=s_j+l$ ï¼Œ$b=f_i$ ã€‚</p><p>ç„¶åå°† $x,y$ ä¸¤ä¸ªå€¼ä½œä¸ºç‚¹ $(x,y)$ æ”¾åˆ°å¹³é¢ä¸Šå³å¯ï¼Œå› ä¸ºæœ€ç»ˆç­”æ¡ˆæ˜¯å– $min$ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»´æŠ¤çš„æ˜¯ä¸‹å‡¸å£³ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ç®—æ–œç‡çš„æ—¶å€™å¯ä»¥å°†æ¯ä¸ªç‚¹çš„å¸¸æ•°é¡¹æˆ–è€…åªå’Œ $i$ æœ‰å…³çš„é¡¹å»æ‰ï¼Œå› ä¸ºç®—æ–œç‡æ˜¯ç›¸å‡çš„ï¼Œå‡çš„æ—¶å€™è¿™äº›é¡¹åŒæ ·ä¹Ÿæ²¡äº†ã€‚</p><p>ä¸Šé¢çš„ $x$ ä¸­çš„ $l$ æ˜¯å¸¸æ•°é¡¹äºæ˜¯å¯ä»¥çœç•¥ï¼Œ$y$ ä¸­çš„ $s_i^2$ åªå’Œ $i$ æœ‰å…³ï¼Œäºæ˜¯ä¹Ÿçœç•¥æ‰ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) ((x)*(x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> n,l,head,tail;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[N],s[N],q[N];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">X</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> s[i];&#125;<span class="comment">/*æ¯ä¸ªç‚¹çš„xåæ ‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> f[i]+S(s[i]+l);&#125;<span class="comment">/*æ¯ä¸ªç‚¹çš„yåæ ‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;<span class="keyword">return</span> (Y(j)-Y(i))/(X(j)-X(i));&#125;<span class="comment">/*ç®—æ–œç‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;s[i]),s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]+=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*s[i]) ++head;</span><br><span class="line">        f[i]=f[q[head]]+S(s[i]-s[q[head]]-l<span class="number">-1</span>);<span class="comment">/*è½¬ç§»*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail],i)&lt;slope(q[tail],q[tail<span class="number">-1</span>])) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ¥è§£é‡Šä¸€äº›é—®é¢˜ã€‚</p><h3 id="1-ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³"><a href="#1-ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³" class="headerlink" title="1.ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³"></a>1.ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³</h3><p>å› ä¸ºæˆ‘ä»¬çš„ $\texttt{DP}$ æ–¹ç¨‹æ˜¯åœ¨å– $\min$ ï¼Œå¦‚æœæ˜¯ $\max$ çš„è¯åˆ™ç»´æŠ¤ä¸Šå‡¸å£³ã€‚è€Œä¸”ç»´æŠ¤ä¸‹å‡¸å£³æ˜¾ç„¶æ˜¯è®© $f_i$ æ›´å°ã€‚</p><p>ä»¥ä¸Šé¢ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç”¨ $y=kx+bâ€‹$ çš„ç›´çº¿ä»ä¸‹é¢ç½‘ä¸Šæ‰«ï¼Œæ³¨æ„è¿™æ¡ç›´çº¿çš„æ–œç‡å°±æ˜¯ $kâ€‹$ ã€‚å¾ˆæ˜¾ç„¶å¦‚æœæˆ‘ä»¬ä»ä¸‹å¾€ä¸Šè¿™æ ·æ‰«è¶Šå¾€ä¸Šæ‰« $bâ€‹$ è¶Šå¤§(ä¸æ˜ç™½çš„ç”»ç”»å›¾)ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®çš„æ˜¯ä½¿å¾— $bâ€‹$ æœ€å°( $bâ€‹$ å°±æ˜¯ $f_iâ€‹$ ) ã€‚ä¸‹å‡¸å£³åŒ…å«äº†æœ€ä¸‹é¢çš„æ‰€æœ‰ç‚¹ï¼Œæ˜¾ç„¶ä¸æ˜¯ä¸‹å‡¸å£³ä¸Šçš„ç‚¹ä¸€å®šä¸èƒ½æˆä¸ºæœ€ä¼˜çš„ã€‚</p><h3 id="2-ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ"><a href="#2-ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ" class="headerlink" title="2.ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ"></a>2.ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ</h3><p>é¦–å…ˆç¬¬ä¸€ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*s[i]) ++head;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è®²äº†æˆ‘ä»¬éœ€è¦ä½¿å¾— $bâ€‹$ æœ€å°ï¼Œé‚£ä¹ˆæœ€ä¼˜çš„å†³ç­–ç‚¹åœ¨ç›´çº¿ä»ä¸‹å¾€ä¸Šæ‰«çš„è¿‡ç¨‹ä¸­è‚¯å®šæ˜¯æœ€å…ˆæ‰«åˆ°çš„ï¼Œå› ä¸ºé‚£æ ·å¯ä»¥ä¿è¯ $f_iâ€‹$ æœ€å°ã€‚å‡è®¾æœ€ä¼˜çš„ç‚¹ä¸º $iâ€‹$ ï¼Œä¸Šä¸€ä¸ªç‚¹ä¸º $jâ€‹$ ï¼Œä¸‹ä¸€ä¸ªç‚¹ä¸º $kâ€‹$ ï¼Œé‚£ä¹ˆ $iâ€‹$ ä¸€å®šä¿è¯ $jâ€‹$ åˆ° $iâ€‹$ çš„æ–œç‡å°äºç›´çº¿æ–œç‡å¹¶ä¸” $iâ€‹$ åˆ° $kâ€‹$ çš„æ–œç‡å¤§äºç›´çº¿æ–œç‡ã€‚</p><p>ç„¶åæˆ‘ä»¬ä¼šå‘ç°å¯¹äºå•è°ƒä¸Šå¢çš„éœ€è¦æ›´æ–°çš„ $iâ€‹$ ï¼Œå…¶ç›´çº¿çš„æ–œç‡ $kâ€‹$ ä¸€å®šæ˜¯å•è°ƒä¸Šå¢çš„ï¼Œå› ä¸ºå‰ç¼€å’Œæ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>æ‰€ä»¥å¯¹äºæ–œç‡å·²ç»ä¸æ»¡è¶³è¦æ±‚çš„ç‚¹ç›´æ¥è¸¢å‡ºé˜Ÿå°±å¥½äº†ã€‚</p><p>ç„¶ååº·åº·å‡ºé˜Ÿçš„è¿‡ç¨‹ã€‚å¦‚æœåœ¨çº¸ä¸Šç”»ç”»ä¼šå‘ç°ï¼Œå¦‚æœæ»¡è¶³ <code>slope(q[tail],i)&lt;slope(q[tail],q[tail-1])</code> ï¼Œé‚£ä¹ˆè¯´æ˜ $q[tail]$ å·²ç»ä¸å†ä¸‹å‡¸å£³ä¸­äº†ï¼æ²¡é”™å§ï¼Ÿé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ $q[tail]$ æ°¸è¿œä¹Ÿä¸å¯èƒ½æˆä¸ºæœ€ä¼˜çš„è½¬ç§»ç‚¹äº†ï¼Œç›´æ¥ä¸¢æ‰å³å¯ã€‚</p><hr><p>æœ€åæœ‰ä¸€äº›æ–œç‡ä¼˜åŒ–çš„å¥—è·¯æ€»ç»“(è‡ªå·±æ€»ç»“å‡ºæ¥çš„)ï¼š</p><ul><li>$\texttt{DP}$ æ–¹ç¨‹å– $\min$ å°±ç»´æŠ¤ä¸‹å‡¸å£³ï¼Œå– $\max$ å°±ç»´æŠ¤ä¸Šå‡¸å£³</li><li>$y=kx+bâ€‹$ ä¸­çš„ $kâ€‹$ ä¸€å®šè¦æ˜¯å¸¸é‡æˆ–è€…æ˜¯å®Œå…¨æ˜¯ $iâ€‹$ çš„é‡(ä¾‹å¦‚ $s_i,2\cdot g_i^2â€‹$ ç­‰)ï¼Œ$bâ€‹$ ä¸€å®šæ˜¯ä½ éœ€è¦è½¬ç§»çš„å¯¹è±¡(å°±æ˜¯ $f_iâ€‹$ )ï¼Œ$xâ€‹$ å’Œ $yâ€‹$ ä¸¤ä¸ªå€¼ä¸€å®šè¦åŒ…å«å’Œ $jâ€‹$ æœ‰å…³çš„å€¼ï¼Œè¦éš $jâ€‹$ çš„å˜åŒ–è€Œå˜åŒ–ã€‚</li><li>æç‚¼å‡ºæ¥çš„ $x,y$ æ”¾åˆ°åæ ‡ç³»ä¸Šä¹‹å‰è®°å¾—å»æ‰æ²¡ç”¨çš„å€¼ã€‚</li></ul><p>å·®ä¸å¤šå°±è¿™äº›å§ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯å®Œå…¨æ­£ç¡®ï¼Œè‡³å°‘è¿™ä¸ªå¥—è·¯è¿˜æ˜¯è¿‡äº†å‡ é“é¢˜ç›®çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å·®ä¸å¤šææ‡‚äº†æ–œç‡ä¼˜åŒ–å§â€¦â€¦è¯´å®è¯ç½‘ä¸Šçš„æ–‡ç« éƒ½å†™å¾—å¾ˆè¿·ï¼Œè¿˜å¥½æ‰¾åˆ°äº†ä¸€ä¸ªä¸é”™çš„æ–‡ç« ï¼š&lt;a href=&quot;https://www.cnblogs.com/yangsongyi/p/9630227.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è½¬é€é—¨æˆ³æˆ‘(ï¿£â–½ï¿£)~*&lt;/a&gt; ã€‚(ä¸ºä»€ä¹ˆçªç„¶å‘ç°è¿™é“é¢˜å’Œè¯—äººå°Gå¾ˆåƒå‘¢) &lt;/p&gt;
&lt;p&gt;è¿™ä¸ª $\texttt{DP}$ æ–¹ç¨‹è°éƒ½ä¼šè®¾ï¼šè®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªç©å…·çš„æœ€å°è´¹ç”¨ï¼Œè½¬ç§»æ˜¾ç„¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\min\limits_{j=1}^{i-1}\{f_j+(sum_i-sum_j+i-j-l)^2\}&lt;/script&gt;&lt;p&gt;(å…¶ä¸­ $sum$ æ˜¯å‰ç¼€å’Œ)ã€‚è¿™ä¸ªå¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ï¼Œè¿‡ä¸å»â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SCOI2008]å¥–åŠ±å…³  çŠ¶å‹DP  luoguP2473</title>
    <link href="http://qiulyblog.github.io/2019/04/23/%5B%E9%A2%98%E8%A7%A3%5DluoguP2473/"/>
    <id>http://qiulyblog.github.io/2019/04/23/[é¢˜è§£]luoguP2473/</id>
    <published>2019-04-22T16:00:00.000Z</published>
    <updated>2019-04-24T07:47:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‘ç°æ•°æ®èŒƒå›´å¾ˆå°ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°â€é›†åˆâ€ï¼Œå¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ç”¨çŠ¶å‹ $\texttt{DP}$ ã€‚</p><p>è®¾ $f[i][j]$ è¡¨ç¤ºå·²ç»æŠ›å‡ºäº† $i$ æ¬¡å®ç‰©ï¼Œè·å¾—çš„å®ç‰©é›†åˆä¸º $j$ æ—¶çš„æœ€ä¼˜åˆ†å€¼ã€‚é‚£ä¹ˆè½¬ç§»çš„æ—¶å€™æšä¸¾æ¯ä¸€ä¸ªå®ç‰©ï¼Œåˆ†ä¸¤ç§æƒ…å†µå³å¯â€”â€”é€‰å½“å‰å®ç‰©æˆ–è€…ä¸é€‰ã€‚æ³¨æ„é€‰å½“å‰å®ç‰©çš„å‰ææ˜¯å¿…é¡»æ»¡è¶³å‰æï¼ŒæŒ‰ç…§æœ€ä¼˜æƒ…å†µé€‰å–å³å¯ã€‚æ³¨æ„æœ€åå°†æ‰€æœ‰çš„å®ç‰©çš„è´¡çŒ®åŠ ä¸Šåè¿˜éœ€è¦$/n$ ï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚çš„æ˜¯â€å¹³å‡â€ã€‚</p><a id="more"></a><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">double</span> f[<span class="number">101</span>][<span class="number">65540</span>];</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">18</span>],d[<span class="number">18</span>],v[<span class="number">18</span>],N,K;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">16</span>;++i) p[i]=<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;K,&amp;N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;v[i],&amp;x);</span><br><span class="line">        <span class="keyword">while</span>(x) &#123;d[i]|=p[x];<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=K;i;--i) <span class="comment">/*å€’ç€æšä¸¾ä¼šå¥½äº›*/</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=p[N+<span class="number">1</span>]<span class="number">-1</span>;++j) &#123;</span><br><span class="line">            <span class="comment">/*ä¸Šé¢ä¸¤é‡å¾ªç¯æšä¸¾çŠ¶æ€*/</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=N;++k)<span class="comment">/*æšä¸¾æ‰€æœ‰å®ç‰©å¹¶è®¡ç®—è´¡çŒ®*/</span></span><br><span class="line">                <span class="keyword">if</span>((d[k]&amp;j)==d[k]) <span class="comment">/*å¯ä»¥é€‰å–å½“å‰å®ç‰©*/</span></span><br><span class="line">                    f[i][j]+=max(f[i+<span class="number">1</span>][j],f[i+<span class="number">1</span>][j|p[k]]+v[k]);</span><br><span class="line">                    <span class="comment">/*æŒ‰ç…§æœ€ä¼˜é€‰å–*/</span></span><br><span class="line">                <span class="keyword">else</span> f[i][j]+=f[i+<span class="number">1</span>][j]; <span class="comment">/*ä¸èƒ½é€‰å–ç›´æ¥è½¬ç§»*/</span></span><br><span class="line">            f[i][j]/=N;<span class="comment">/*æ‰€è°“"å¹³å‡"*/</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.6f\n"</span>,f[<span class="number">1</span>][<span class="number">0</span>]);<span class="comment">/*æœ€ç»ˆç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç°æ•°æ®èŒƒå›´å¾ˆå°ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°â€é›†åˆâ€ï¼Œå¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ç”¨çŠ¶å‹ $\texttt{DP}$ ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f[i][j]$ è¡¨ç¤ºå·²ç»æŠ›å‡ºäº† $i$ æ¬¡å®ç‰©ï¼Œè·å¾—çš„å®ç‰©é›†åˆä¸º $j$ æ—¶çš„æœ€ä¼˜åˆ†å€¼ã€‚é‚£ä¹ˆè½¬ç§»çš„æ—¶å€™æšä¸¾æ¯ä¸€ä¸ªå®ç‰©ï¼Œåˆ†ä¸¤ç§æƒ…å†µå³å¯â€”â€”é€‰å½“å‰å®ç‰©æˆ–è€…ä¸é€‰ã€‚æ³¨æ„é€‰å½“å‰å®ç‰©çš„å‰ææ˜¯å¿…é¡»æ»¡è¶³å‰æï¼ŒæŒ‰ç…§æœ€ä¼˜æƒ…å†µé€‰å–å³å¯ã€‚æ³¨æ„æœ€åå°†æ‰€æœ‰çš„å®ç‰©çš„è´¡çŒ®åŠ ä¸Šåè¿˜éœ€è¦$/n$ ï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚çš„æ˜¯â€å¹³å‡â€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çŠ¶å‹DP" scheme="http://qiulyblog.github.io/tags/%E7%8A%B6%E5%8E%8BDP/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2011]Noiå˜‰å¹´å  å†³ç­–å•è°ƒæ€§ä¼˜åŒ–DP  luoguP1973</title>
    <link href="http://qiulyblog.github.io/2019/04/22/%5B%E9%A2%98%E8%A7%A3%5DluoguP1973/"/>
    <id>http://qiulyblog.github.io/2019/04/22/[é¢˜è§£]luoguP1973/</id>
    <published>2019-04-21T16:00:00.000Z</published>
    <updated>2019-04-23T00:42:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é“é¢˜ä¸€å…±æœ‰ä¸¤é—®ï¼Œç¬¬ä¸€é—®çæ $\texttt{DP}$ ï¼Œç¬¬äºŒé—®å¦‚æœç›´æ¥ $\texttt{DP}$ çš„è¯å¤æ‚åº¦æ˜¯ $O(n^4)$ çš„è¿‡ä¸å»ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨åˆ°å†³ç­–å•è°ƒæ€§ä¼˜åŒ–å¤æ‚åº¦å°±å¯ä»¥é™ä½è‡³ $O(n^3)$ ï¼Œè¿™æ ·å°±è¿‡äº†ã€‚æˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹ç¬¬ä¸€é—®çš„åšæ³•ã€‚</p><p>æ—¶é—´çš„èŒƒå›´å¤ªå¤§äº†ï¼Œæˆ‘ä»¬éœ€è¦ç¦»æ•£åŒ–ä¸€ä¸‹ã€‚ç¦»æ•£åŒ–åæ—¶é—´å°±æ§åˆ¶åœ¨ $0$ åˆ° $2n$ çš„èŒƒå›´å†…äº†ã€‚</p><p>é¦–å…ˆå¯ä»¥å‘ç°æœ€ç»ˆçš„ç­”æ¡ˆä¸€å®šå°±æ˜¯ä¸€æ®µä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸€æ®µæ—¶é—´å†…çš„æ´»åŠ¨éƒ½æ˜¯åœ¨åŒä¸€ä¸ªä¼šåœºä¸¾è¡Œã€‚æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†ä¸€ä¸ª $tot_{l,r}$ è¡¨ç¤ºå®Œå…¨åœ¨æ—¶é—´ $l,r$ ä¹‹å†…çš„æ´»åŠ¨æœ‰å¤šå°‘ä¸ªã€‚è®¡ç®—ç›´æ¥æš´åŠ›ï¼Œé¢„å¤„ç†çš„å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚</p><a id="more"></a><p>ç„¶åè®¾ä¸€ä¸ª $pre_{i,j}â€‹$ è¡¨ç¤º <strong>$1â€‹$ åˆ° $iâ€‹$ çš„æ—¶é—´ä¸€ä¸ªä¼šåœºçš„æ´»åŠ¨æ•°ä¸º $jâ€‹$ æ—¶å¦ä¸€ä¸ªä¼šåœºçš„æœ€å¤§æ´»åŠ¨æ•°</strong>ã€‚é‚£ä¹ˆè½¬ç§»çš„è¯æˆ‘ä»¬æšä¸¾ä¸€ä¸ªæ—¶é—´ $kâ€‹$ ï¼Œç„¶åè€ƒè™‘ $kâ€‹$ åˆ° $iâ€‹$ è¿™æ®µæ—¶é—´ä¸­çš„æ‰€æœ‰æ´»åŠ¨åˆ†é…ç»™å“ªä¸ªä¼šåœºå³å¯ã€‚å¯ä»¥å¾—åˆ°è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">pre_{i,j}=\max\limits_{k=1}^{i}\{pre_{k,j}+tot_{k,i},pre_{k,j-tot_{k,i}}\}â€‹</script><p>è¿™é‡Œæˆ‘ä»¬ $pre$ æ–¹ç¨‹çš„å®šä¹‰ä¸­â€ä¸€ä¸ªä¼šåœºâ€å°±æ˜¯ä¸€å·ä¼šåœºï¼Œâ€å¦ä¸€ä¸ªä¼šåœºâ€å°±æ˜¯äºŒå·ä¼šåœº$ã€‚pre_{k,j}+tot_{k,i}$ å°±æ˜¯å°† $k$ åˆ° $i$ è¿™æ®µæ—¶é—´ä¸­æ‰€æœ‰æ´»åŠ¨éƒ½åˆ†é…ç»™äº†äºŒå·ä¼šåœºï¼Œ$pre_{k,j-tot_{k,i}}$ å¾ˆæ˜¾ç„¶å°±æ˜¯åˆ†é…ç»™äº†ä¸€å·ä¼šåœºã€‚è®¡ç®—æ—¶æšä¸¾ $i,j,k$ ï¼Œå¤æ‚åº¦æ˜¯ $O(n^3)$ ã€‚(å…¶å®å‡†ç¡®çš„å¤æ‚åº¦å¸¦ä¸ªå¸¸æ•°ï¼Œå› ä¸º $i$ æšä¸¾çš„æ˜¯æ—¶é—´ï¼Œè€Œæ—¶é—´æœ€å¤§æ˜¯ $2n$ çš„) ã€‚</p><p>æˆ‘ä»¬è®¾ç¦»æ•£åŒ–åæ—¶é—´æ€»é•¿ä¸º $m$ ï¼Œé‚£ä¹ˆç­”æ¡ˆæ˜¾ç„¶ä¸º $\max\limits_{i=1}^m\{\min(pre_{m,i},i)\}$ ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è§£å†³ç¬¬äºŒé—®ã€‚</p><p>æˆ‘ä»¬çš„ $tot_{l,r}$ ç»Ÿè®¡çš„å°±æ˜¯å®Œå…¨åœ¨æ—¶é—´ $l,r$ çš„åŒºé—´æœ‰å¤šå°‘ä¸ªã€‚é‚£ä¹ˆå¯¹äºç¬¬ $i$ ä¸ªæ´»åŠ¨ï¼Œè®¾è¯¥æ´»åŠ¨çš„èµ·å§‹æ—¶é—´ä¸ç»ˆæ­¢æ—¶é—´åˆ†åˆ«ä¸º $s_i,t_i$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†è€ƒè™‘ä¸€å¯¹ $x,y \ \ (x\leq s_i,t_i\leq y)$ ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°†ç­”æ¡ˆè®¡ç®—ä¸Š $tot_{x,y}$ ï¼Œé‚£ä¹ˆä¹Ÿå°±é€‰æ‹©äº†ç¬¬ $i$ ä¸ªæ´»åŠ¨äº†ã€‚</p><p>æˆ‘ä»¬è®¾ $f_{i,j}$ è¡¨ç¤ºä¸€å·ä¼šåœºå¼ºåˆ¶é€‰æ‹© $i$ åˆ° $j$ æ—¶é—´ä¸­çš„æ‰€æœ‰æ´»åŠ¨æ—¶çš„æœ€ä¼˜ç­”æ¡ˆã€‚(æ³¨æ„è¿™é‡Œçš„æœ€ä¼˜ç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªä¼šåœºä¸­æ´»åŠ¨å°‘çš„ä¸€æ–¹çš„æœ€å¤§å€¼ï¼Œæˆ‘ä»¬åªæ˜¯è€ƒè™‘åœ¨ä¸€å·ä¼šåœº<strong>å¼ºåˆ¶é€‰æ‹©</strong> $i$ åˆ° $jâ€‹$ ä¸­çš„æ‰€æœ‰æ´»åŠ¨çš„æƒ…å†µä¸‹è€ƒè™‘æœ€ä¼˜çš„å…¨å±€ç­”æ¡ˆ) ã€‚</p><p>ç»§ç»­çœ‹å‘ä¸€å·ä¼šåœºï¼Œå‡è®¾åœ¨ $i$ å‰é¢çš„æ—¶é—´ä¸­ä¸€å·ä¼šåœºå·²ç»åˆæ³•ä¸¾åŠäº† $x$ åœºæ´»åŠ¨ï¼Œåœ¨ $j$ åé¢çš„æ—¶é—´ä¸­ä¹Ÿåˆæ³•ä¸¾åŠäº† $y$ åœºæ´»åŠ¨ã€‚é‚£ä¹ˆæˆ‘ä»¬æšä¸¾ $i,j,x,y$ ä¹Ÿå¯ä»¥å¾—åˆ°äºŒå·ä¼šåœºçš„æ´»åŠ¨æ•°ï¼š$i$ å‰é¢çš„æ—¶é—´ç§æœ‰ $pre_{i,x}$ åœºæ´»åŠ¨ï¼Œ$j$ åé¢çš„æ—¶é—´ä¸­æœ‰â€¦â€¦è¯¶è¿™é‡Œç”¨ $pre$ è²Œä¼¼ä¸æ˜¯å¾ˆå¥½è¡¨ç¤ºè¯¶ï¼Œäºæ˜¯æˆ‘ä»¬æ–°å®šä¹‰ä¸€ä¸ª $suf$ ï¼Œ$suf_{i,j}$ è¡¨ç¤º <strong>$i$ åˆ° $m$ çš„æ—¶é—´ä¸€ä¸ªä¼šåœºçš„æ´»åŠ¨æ•°ä¸º $j$ æ—¶å¦ä¸€ä¸ªä¼šåœºçš„æœ€å¤§æ´»åŠ¨æ•°</strong>ï¼Œ$suf$ çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹å’Œ $pre$ çš„åŒç†ã€‚</p><p>æšä¸¾ $i,j,x,y$ åå°±å¯ä»¥å¾—åˆ°ä¸¤ä¸ªä¼šåœºçš„æ´»åŠ¨ä¸ªæ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç®—ç­”æ¡ˆäº†ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\max\limits_{x=1}^{m}\max\limits_{y=1}^{m}\{\min(x+tot_{i,j}+y,pre_{i,x}+suf_{j,y})\}â€‹</script><p>ä½†æ˜¯è¿™æ ·å­çš„å¤æ‚åº¦æ˜¯ $O(n^4)â€‹$ çš„ï¼Œè¿‡ä¸äº†ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œ<strong>å¯¹äºå•è°ƒé€’å¢çš„ $x$ ï¼Œå¯¹åº”çš„æœ€ä¼˜çš„ $y$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„</strong> ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿé¦–å…ˆå¯¹äºä¸€ä¸ªå•è°ƒé€’å¢çš„ $i$ ï¼Œ$pre_{?_i},suf_{?_i}$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„( $?$ ä¸ºä»»æ„æ•°) ã€‚é‚£ä¹ˆå¦‚æœå¯¹äºå•è°ƒé€’å¢çš„ $x$ ï¼Œ$pre_{i,x}$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœ $y$ å•è°ƒé€’å¢ä¹Ÿå°±æ„å‘³ç€ $suf_{j,y}$ ä¼šå•è°ƒé€’å‡ï¼Œé‚£ä¹ˆ $x+tot_{i,j}+y$ å’Œ $pre_{i,x}+suf_{j,y}$ å°†ä¼šè¶Šæ‹‰è¶Šå¤§ï¼Œå¯¹äºç­”æ¡ˆæ˜¾ç„¶æ˜¯ä¸åˆ©çš„ã€‚åè¿‡æ¥ï¼Œå¦‚æœ $y$ æ˜¯å•è°ƒé€’å‡çš„ï¼Œé‚£ä¹ˆå°±ä¼šç›¸å¯¹æ¯”è¾ƒå‡è¡¡ã€‚(æ„Ÿæ€§ç†è§£ç†è§£â€¦â€¦)</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦æšä¸¾ $y$ äº†ï¼Œåªéœ€è¦æ‰«ä¸€æ‰«å°±å¥½äº†ï¼Œæœ€ç»ˆè®¡ç®— $f$ çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚</p><p>æœ€ç»ˆç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªæ´»åŠ¨ $i$ ï¼Œæˆ‘ä»¬çš„ç­”æ¡ˆæ˜¾ç„¶ä¸º $\max\limits_{x=1}^{s_i}\max\limits_{y=t_i}^{m}f_{x,y}$ ã€‚å¿…é¡»æ»¡è¶³ $x\leq s_i,t_i\leq y$ ï¼Œå› ä¸ºè¿™æ ·å°±ä¼šæ»¡è¶³ä¸€å®šä¼šé€‰æ‹©ç¬¬ $i$ ä¸ªæ´»åŠ¨ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> F(i,j,k) for((i)=(j);(i)&lt;=(k);++i)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R(i,j,k) for((i)=(j);(i)&gt;=(k);--i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">4e2</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,i,j,k,l,r,s[N],t[N],b[N];</span><br><span class="line"><span class="keyword">int</span> tot[N][N],pre[N][N],suf[N][N],f[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">IN</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;<span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> min(x+tot[l][r]+y,pre[l][x]+suf[r][y]);&#125;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n=IN();</span><br><span class="line">    F(i,<span class="number">1</span>,n) b[++m]=s[i]=IN(),b[++m]=t[i]=IN()+s[i];</span><br><span class="line">    sort(b+<span class="number">1</span>,b+<span class="number">1</span>+m),</span><br><span class="line">    m=unique(b+<span class="number">1</span>,b+<span class="number">1</span>+m)-b<span class="number">-1</span>;<span class="comment">/*ç¦»æ•£åŒ–å»é‡*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,n) &#123;</span><br><span class="line">        s[i]=lower_bound(b+<span class="number">1</span>,b+<span class="number">1</span>+m,s[i])-b;</span><br><span class="line">        t[i]=lower_bound(b+<span class="number">1</span>,b+<span class="number">1</span>+m,t[i])-b;</span><br><span class="line">        F(l,<span class="number">1</span>,s[i]) R(r,m,t[i]) ++tot[l][r];<span class="comment">/*è®¡ç®—å‡ºtot*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    F(i,<span class="number">1</span>,m) F(j,<span class="number">1</span>,n) pre[i][j]=suf[i][j]=-inf;<span class="comment">/*åˆå§‹åŒ–*/</span> </span><br><span class="line">    <span class="comment">/*----------è®¡ç®—å‡ºpreå’Œsuf----------*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,m) F(j,<span class="number">0</span>,tot[<span class="number">1</span>][i]) F(k,<span class="number">1</span>,i) &#123;</span><br><span class="line">        pre[i][j]=max(pre[i][j],pre[k][j]+tot[k][i]);</span><br><span class="line">        <span class="keyword">if</span>(j&gt;=tot[k][i]) pre[i][j]=max(pre[i][j],pre[k][j-tot[k][i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    R(i,m,<span class="number">1</span>) F(j,<span class="number">0</span>,tot[i][m]) F(k,i,m) &#123;</span><br><span class="line">        suf[i][j]=max(suf[i][j],suf[k][j]+tot[i][k]);</span><br><span class="line">        <span class="keyword">if</span>(j&gt;=tot[i][k]) suf[i][j]=max(suf[i][j],suf[k][j-tot[i][k]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è®¡ç®—f*/</span></span><br><span class="line">    F(l,<span class="number">1</span>,m) F(r,l+<span class="number">1</span>,m) <span class="keyword">for</span>(<span class="keyword">int</span> y=n,x=<span class="number">0</span>;x&lt;=n;++x) &#123;<span class="comment">/*yå½“åšæŒ‡é’ˆæ‰«ä¸€é*/</span></span><br><span class="line">        <span class="keyword">int</span> old_calc=calc(x,y),new_calc;</span><br><span class="line">        <span class="keyword">while</span>(y&amp;&amp;old_calc&lt;=(new_calc=calc(x,y<span class="number">-1</span>))) --y,old_calc=new_calc;</span><br><span class="line">        f[l][r]=max(f[l][r],calc(x,y));<span class="comment">/*è½¬ç§»*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¾“å‡ºç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    F(i,<span class="number">1</span>,n) ans=max(ans,min(pre[m][i],i));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);<span class="comment">/*ç¬¬ä¸€é—®*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,n) &#123;</span><br><span class="line">        ans=<span class="number">0</span>;</span><br><span class="line">        F(l,<span class="number">1</span>,s[i]) R(r,m,t[i]) ans=max(ans,f[l][r]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);<span class="comment">/*ç¬¬äºŒé—®*/</span></span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™é“é¢˜ä¸€å…±æœ‰ä¸¤é—®ï¼Œç¬¬ä¸€é—®çæ $\texttt{DP}$ ï¼Œç¬¬äºŒé—®å¦‚æœç›´æ¥ $\texttt{DP}$ çš„è¯å¤æ‚åº¦æ˜¯ $O(n^4)$ çš„è¿‡ä¸å»ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨åˆ°å†³ç­–å•è°ƒæ€§ä¼˜åŒ–å¤æ‚åº¦å°±å¯ä»¥é™ä½è‡³ $O(n^3)$ ï¼Œè¿™æ ·å°±è¿‡äº†ã€‚æˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹ç¬¬ä¸€é—®çš„åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´çš„èŒƒå›´å¤ªå¤§äº†ï¼Œæˆ‘ä»¬éœ€è¦ç¦»æ•£åŒ–ä¸€ä¸‹ã€‚ç¦»æ•£åŒ–åæ—¶é—´å°±æ§åˆ¶åœ¨ $0$ åˆ° $2n$ çš„èŒƒå›´å†…äº†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯ä»¥å‘ç°æœ€ç»ˆçš„ç­”æ¡ˆä¸€å®šå°±æ˜¯ä¸€æ®µä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸€æ®µæ—¶é—´å†…çš„æ´»åŠ¨éƒ½æ˜¯åœ¨åŒä¸€ä¸ªä¼šåœºä¸¾è¡Œã€‚æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†ä¸€ä¸ª $tot_{l,r}$ è¡¨ç¤ºå®Œå…¨åœ¨æ—¶é—´ $l,r$ ä¹‹å†…çš„æ´»åŠ¨æœ‰å¤šå°‘ä¸ªã€‚è®¡ç®—ç›´æ¥æš´åŠ›ï¼Œé¢„å¤„ç†çš„å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­  å¯æŒä¹…åŒ–Trieæ ‘  luoguP5283</title>
    <link href="http://qiulyblog.github.io/2019/04/19/%5B%E9%A2%98%E8%A7%A3%5DluoguP5283/"/>
    <id>http://qiulyblog.github.io/2019/04/19/[é¢˜è§£]luoguP5283/</id>
    <published>2019-04-18T16:00:00.000Z</published>
    <updated>2019-04-19T11:34:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}â€‹$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦</p><p>[åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­ï¼Œå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘çš„æ¿å­é¢˜ï¼Œæ¯”æœ€å¤§å¼‚æˆ–å’Œè¿˜è¦æ¿å­äº›ã€‚ç›¸ä¿¡ $60â€‹$ åˆ†å…¥é—¨è€…éƒ½ä¼šåšï¼Œé‚£ä¹ˆ $100â€‹$ åˆ†çš„è¯æˆ‘ä»¬ä¸Šå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘ç»´æŠ¤å‰ç¼€å¼‚æˆ–å’Œï¼Œå—¯æ²¡é”™å°±åƒä¸»å¸­æ ‘é‚£æ ·ã€‚ç„¶åå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å¯æŒä¹…åŒ– $trieâ€‹$ æ ‘æˆ‘ä»¬å°†å…¶å½“æˆåŒºé—´å³ç«¯ç‚¹ï¼Œç„¶ååœ¨æ­¤ä½ç½®ä¸Šçš„ $trieâ€‹$ æ ‘ä¸­è´ªå¿ƒå¯»æ‰¾å·¦ç«¯ç‚¹å³å¯ã€‚</p><a id="more"></a><p>å¯»æ‰¾å‰ $K$ å¤§åŒºé—´çš„å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">    q.push(MKP(T.query(T.root[i],sum[i],qrank[i]=<span class="number">1</span>),i));</span><br><span class="line"><span class="comment">/*å¯¹äºæ¯ä¸€ä¸ªå³ç«¯ç‚¹ï¼Œæ‰¾ä¸€ä¸ªç¬¬ä¸€å¤§(æœ€ä¼˜)çš„å·¦ç«¯ç‚¹æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—*/</span></span><br><span class="line">ll ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(k--) &#123;</span><br><span class="line">    ll i=q.top().second;<span class="comment">/*å–å‡ºå½“å‰æœ€ä¼˜å…ƒç´ */</span></span><br><span class="line">    ans+=q.top().first;q.pop();</span><br><span class="line">    <span class="keyword">if</span>(qrank[i]!=i) q.push(MKP(T.query(T.root[i],sum[i],++qrank[i]),i));</span><br><span class="line">    <span class="comment">/*æ›´æ–°é˜Ÿåˆ—å…ƒç´ */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤æ‚åº¦å¤§çº¦æ˜¯ $O(nlogn)â€‹$ çº§åˆ«ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MKP make_pair</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ll N=<span class="number">5e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> ll logN=<span class="number">33</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll n,k,sum[N],qrank[N];</span><br><span class="line">priority_queue&lt;pair&lt;ll,ll&gt; &gt; q;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Trie</span> &#123;</span></span><br><span class="line">    ll ch[N*logN][<span class="number">2</span>],sum[N*logN],root[N],tot;</span><br><span class="line">    <span class="function">ll <span class="title">newnode</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">        ++tot,ch[tot][<span class="number">0</span>]=ch[x][<span class="number">0</span>],ch[tot][<span class="number">1</span>]=ch[x][<span class="number">1</span>];</span><br><span class="line">        sum[tot]=sum[x];<span class="keyword">return</span> tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(ll&amp;rt,ll val)</span> </span>&#123;</span><br><span class="line">        rt=newnode(rt),++sum[rt];</span><br><span class="line">        ll now=rt;</span><br><span class="line">        <span class="keyword">for</span>(ll i=<span class="number">31</span>;~i;--i) &#123;</span><br><span class="line">            <span class="keyword">bool</span> son=(val&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">            ch[now][son]=newnode(ch[now][son]);</span><br><span class="line">            now=ch[now][son],++sum[now];</span><br><span class="line">        &#125;<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(ll now,ll val,ll k)</span> </span>&#123;</span><br><span class="line">        ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll i=<span class="number">31</span>;~i;--i) &#123;</span><br><span class="line">            <span class="keyword">bool</span> son=!((val&gt;&gt;i)&amp;<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(k&lt;=sum[ch[now][son]]) now=ch[now][son],ans|=(<span class="number">1u</span>&lt;&lt;i);</span><br><span class="line">            <span class="keyword">else</span> k-=sum[ch[now][son]],now=ch[now][!son];</span><br><span class="line">        &#125;<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IN(n),IN(k);</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>,x;i&lt;=n;++i) IN(x),sum[i]=sum[i<span class="number">-1</span>]^x;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">0</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(i) T.root[i]=T.root[i<span class="number">-1</span>];</span><br><span class="line">        T.Insert(T.root[i],sum[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        q.push(MKP(T.query(T.root[i],sum[i],qrank[i]=<span class="number">1</span>),i));</span><br><span class="line">    ll ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(k--) &#123;</span><br><span class="line">        ll i=q.top().second;</span><br><span class="line">        ans+=q.top().first;q.pop();</span><br><span class="line">        <span class="keyword">if</span>(qrank[i]!=i) q.push(MKP(T.query(T.root[i],sum[i],++qrank[i]),i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}â€‹$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦&lt;/p&gt;
&lt;p&gt;[åäºŒçœè”è€ƒ2019]å¼‚æˆ–ç²½å­ï¼Œå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘çš„æ¿å­é¢˜ï¼Œæ¯”æœ€å¤§å¼‚æˆ–å’Œè¿˜è¦æ¿å­äº›ã€‚ç›¸ä¿¡ $60â€‹$ åˆ†å…¥é—¨è€…éƒ½ä¼šåšï¼Œé‚£ä¹ˆ $100â€‹$ åˆ†çš„è¯æˆ‘ä»¬ä¸Šå¯æŒä¹…åŒ– $trieâ€‹$ æ ‘ç»´æŠ¤å‰ç¼€å¼‚æˆ–å’Œï¼Œå—¯æ²¡é”™å°±åƒä¸»å¸­æ ‘é‚£æ ·ã€‚ç„¶åå¯¹äºæ¯ä¸ªèŠ‚ç‚¹çš„å¯æŒä¹…åŒ– $trieâ€‹$ æ ‘æˆ‘ä»¬å°†å…¶å½“æˆåŒºé—´å³ç«¯ç‚¹ï¼Œç„¶ååœ¨æ­¤ä½ç½®ä¸Šçš„ $trieâ€‹$ æ ‘ä¸­è´ªå¿ƒå¯»æ‰¾å·¦ç«¯ç‚¹å³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å¯æŒä¹…åŒ–Trieæ ‘" scheme="http://qiulyblog.github.io/tags/%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%96Trie%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [åäºŒçœè”è€ƒ2019]æ˜¥èŠ‚åäºŒå“  å †+å¯å‘å¼åˆå¹¶  luoguP5290</title>
    <link href="http://qiulyblog.github.io/2019/04/19/%5B%E9%A2%98%E8%A7%A3%5DluoguP5290/"/>
    <id>http://qiulyblog.github.io/2019/04/19/[é¢˜è§£]luoguP5290/</id>
    <published>2019-04-18T16:00:00.000Z</published>
    <updated>2019-04-19T11:41:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦</p><p>[åäºŒçœè”è€ƒ2019]æ˜¥èŠ‚åäºŒå“ï¼Œå¯å‘å¼åˆå¹¶è£¸é¢˜ã€‚å¯¹äºæ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ $u$ ï¼Œä»å…¶å­æ ‘ä¸­é€‰æ‹©ä¸€æ®µçš„æ–¹å¼æ˜¾ç„¶åªèƒ½æ˜¯ä» $u$ çš„æ‰€æœ‰å­æ ‘ä¸­å„é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ã€‚äºæ˜¯æˆ‘ä»¬æ¯ä¸€ä¸ªèŠ‚ç‚¹å¼€ä¸€ä¸ªå †ï¼Œå­˜çš„å°±æ˜¯å…¶å­æ ‘ä¸­(åŒ…æ‹¬è‡ªå·±)çš„æ‰€æœ‰æ®µçš„å†…å­˜ã€‚</p><p>ç„¶åä»ä¸‹å¾€ä¸Šå¯å‘å¼åˆå¹¶å³å¯ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $O(nlogn)$ ã€‚</p><a id="more"></a><p>å¯å‘å¼åˆå¹¶çš„å…·ä½“ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(q[x].size()&lt;q[y].size()) swap(q[x],q[y]);</span><br><span class="line">    <span class="keyword">while</span>(!q[y].empty()) &#123;</span><br><span class="line">        hep.push_back(max(q[x].top(),q[y].top()));</span><br><span class="line">        q[x].pop(),q[y].pop();</span><br><span class="line">        <span class="comment">/*è´ªå¿ƒé€‰å–*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(hep.size()) q[x].push(hep.back()),hep.pop_back();</span><br><span class="line">    <span class="comment">/*æ›´æ–°èŠ‚ç‚¹*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,sz=G[x].size();i&lt;sz;++i)</span><br><span class="line">        solve(G[x][i]),merge(x,G[x][i]);<span class="comment">/*å°†å½“å‰å­æ ‘ä¸ä¹‹å‰æšä¸¾è¿‡çš„å­æ ‘åˆå¹¶*/</span></span><br><span class="line">    q[x].push(s[x]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åçš„æ€»ä»£ç é•¿åº¦ä¸è¶…è¿‡ $40$ è¡Œã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e5</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,f,s[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; hep,G[N];</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>&gt; q[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(q[x].size()&lt;q[y].size()) swap(q[x],q[y]);</span><br><span class="line">    <span class="keyword">while</span>(!q[y].empty()) &#123;</span><br><span class="line">        hep.push_back(max(q[x].top(),q[y].top()));</span><br><span class="line">        q[x].pop(),q[y].pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(hep.size()) q[x].push(hep.back()),hep.pop_back();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,sz=G[x].size();i&lt;sz;++i)</span><br><span class="line">        solve(G[x][i]),merge(x,G[x][i]);</span><br><span class="line">    q[x].push(s[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;s[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;f),G[f].push_back(i);</span><br><span class="line">    solve(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q[<span class="number">1</span>].empty()) ans+=q[<span class="number">1</span>].top(),q[<span class="number">1</span>].pop();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¦æ˜¯æˆ‘ä¸æ˜¯ $\texttt{HN}$ çš„è¯¥å¤šå¥½ï¼Œä»Šå¹´åäºŒçœè”è€ƒä¸¤é“å‚»é€¼é¢˜ï¼Œä¸€é“å¼‚æˆ–ç²½å­ï¼Œä¸€é“åäºŒå“â€¦â€¦&lt;/p&gt;
&lt;p&gt;[åäºŒçœè”è€ƒ2019]æ˜¥èŠ‚åäºŒå“ï¼Œå¯å‘å¼åˆå¹¶è£¸é¢˜ã€‚å¯¹äºæ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ $u$ ï¼Œä»å…¶å­æ ‘ä¸­é€‰æ‹©ä¸€æ®µçš„æ–¹å¼æ˜¾ç„¶åªèƒ½æ˜¯ä» $u$ çš„æ‰€æœ‰å­æ ‘ä¸­å„é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ã€‚äºæ˜¯æˆ‘ä»¬æ¯ä¸€ä¸ªèŠ‚ç‚¹å¼€ä¸€ä¸ªå †ï¼Œå­˜çš„å°±æ˜¯å…¶å­æ ‘ä¸­(åŒ…æ‹¬è‡ªå·±)çš„æ‰€æœ‰æ®µçš„å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä»ä¸‹å¾€ä¸Šå¯å‘å¼åˆå¹¶å³å¯ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $O(nlogn)$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å †" scheme="http://qiulyblog.github.io/tags/%E5%A0%86/"/>
    
      <category term="å¯å‘å¼åˆå¹¶" scheme="http://qiulyblog.github.io/tags/%E5%90%AF%E5%8F%91%E5%BC%8F%E5%90%88%E5%B9%B6/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ã€æ¨¡æ¿ã€‘åŠ¨æ€DP  LCT+DP+çŸ©é˜µ  luoguP4751</title>
    <link href="http://qiulyblog.github.io/2019/04/19/%5B%E9%A2%98%E8%A7%A3%5DluoguP4751/"/>
    <id>http://qiulyblog.github.io/2019/04/19/[é¢˜è§£]luoguP4751/</id>
    <published>2019-04-18T16:00:00.000Z</published>
    <updated>2019-04-19T11:17:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>çœ‹æ‡‚äº†åå‘ç° $\texttt{DDP}$ å…¶å®ä¸éš¾å‘¢â€¦â€¦</p><p>å…¶å®ä¸»è¦æ€æƒ³å°±æ˜¯å°† $\texttt{DP}$ è½¬ç§»å¼æåˆ°çŸ©é˜µä¸Šï¼Œç„¶åå¦‚æœæ˜¯æ ‘å½¢ $\texttt{DP}$ çš„è¯å°±å¯ä»¥ç›´æ¥ä¸Šæ ‘å‰–æˆ–è€…æ˜¯ $LCT$ è¿›è¡Œç»´æŠ¤ï¼Œå½“ç„¶è¿˜å¯ä»¥ç”¨å…¨å±€å¹³è¡¡äºŒå‰æ ‘(ä¸è´¹) ã€‚å¦‚æœåªæ˜¯çº¿æ€§çš„è¯å¯ä»¥ç›´æ¥ç”¨çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„è¿›è¡Œç»´æŠ¤äº†ã€‚</p><p>æ³¨æ„è¿™é“æ¨¡æ¿æ ‘å‰–çš„å¤æ‚åº¦æ˜¯ $O(nlog^2n)$ ï¼Œè€Œ $LCT$ çš„å¤æ‚åº¦ä¸º $O(nlogn)$ ï¼Œäºæ˜¯çªé€‰æ‹©äº† $LCT$ ï¼Œè·‘çš„è¿˜æŒºå¿«ã€‚</p><a id="more"></a><p>å¼€å§‹åˆ†æé¢˜ç›®ï¼Œå¦‚æœæ²¡æœ‰â€åŠ¨æ€â€é™åˆ¶çš„è¯å°±æ˜¯ä¸€ä¸ªè£¸çš„â€æ²¡æœ‰ä¸Šå¸çš„èˆä¼šâ€ï¼Œè§£æ³•æ˜¾ç„¶æ˜¯è®¾ $f[u][0/1]â€‹$ è¡¨ç¤º $uâ€‹$ ä¸é€‰/é€‰ çš„æ—¶å€™å…¶å­æ ‘çš„æœ€å¤§ä»·å€¼ï¼Œè½¬ç§»æ˜¾ç„¶ä¸ºï¼š</p><script type="math/tex; mode=display">f[u][0]=\sum \max(f[v][0],f[v][1])\\f[u][1]=val[u]+\sum f[v][0]</script><p>å¯¹äºæ ‘ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ $u$ çš„æ‰€æœ‰å„¿å­ä¸­æœ‰ä¸ªé‡å„¿å­ï¼Œå…¶ä»–çš„å„¿å­å°±æ˜¯è½»å„¿å­ï¼Œæˆ‘ä»¬å°†é‡å„¿å­å’Œè½»å„¿å­çš„è´¡çŒ®åˆ†å¼€ç®—ã€‚è®¾ä¸€ä¸ª $g[u][0/1]$ ï¼Œå…¶å€¼ä¸ºï¼š</p><script type="math/tex; mode=display">g[u][0]=\sum\max(f[v][0],f[v][1])\\g[u][1]=val[u]+\sum f[v][0]</script><p>æ³¨æ„ä¸Šå¼ä¸­çš„ $v$ åªçš„æ˜¯è½»å„¿å­ï¼Œç„¶å $f$ çš„è½¬ç§»å°±å˜æˆäº†ä»¥ä¸‹å½¢å¼( $x$ ä¸ºé‡å„¿å­)ï¼š</p><script type="math/tex; mode=display">f[u][0]=\max(f[x][0],f[x][1])+g[u][0]\\f[u][1]=g[u][1]+f[x][0]</script><p>å…¶å®è¿™é‡Œçš„ $g$ å¾ˆå¥½ç»´æŠ¤ï¼Œæˆ‘ä»¬åœ¨ $Access$ çš„æ—¶å€™åªè¦è®¡ç®—å„¿å­å˜åŒ–æ—¶çš„è´¡çŒ®å°±å¥½äº†ã€‚</p><p>æ¥ç€æˆ‘ä»¬æ„é€ å‡ºè½¬ç§»çŸ©é˜µï¼š</p><script type="math/tex; mode=display">\begin{bmatrix}g[u][0] & g[u][0]\\g[u][1] & -inf\end{bmatrix}\cdot\begin{bmatrix}f[x][0] \\f[x][1]\end{bmatrix}=\begin{bmatrix}f[u][0]\\f[u][1]\end{bmatrix}</script><p>è¿™æ ·å­å°±å¯ä»¥ç›´æ¥æ›´æ–°äº†ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªçŸ©é˜µå³å¯ï¼Œä¸€ä¸ªå°±æ˜¯ä¸Šé¢ä¹˜æ³•ä¸­çš„ $g$ çŸ©é˜µï¼Œä¸€ä¸ªå°±æ˜¯ä¸Šé¢ä¹˜æ³•ä¸­çš„ $f$ çŸ©é˜µã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™æ˜¯å¹¿ä¹‰çŸ©é˜µä¹˜æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªçŸ©é˜µä¹˜æ³•çš„è¿ç®—è§„åˆ™ä¸ºï¼š</p><script type="math/tex; mode=display">c[i][j]=max(c[i][j],a[i][k]+b[k][j])</script><p>å¾ˆåƒ $floyd$ ï¼Œå¯ä»¥ç›´æ¥ç®—äº†ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">matrix</span> &#123;</span><span class="keyword">int</span> c[<span class="number">2</span>][<span class="number">2</span>];matrix()&#123;c[<span class="number">0</span>][<span class="number">0</span>]=c[<span class="number">0</span>][<span class="number">1</span>]=c[<span class="number">1</span>][<span class="number">0</span>]=c[<span class="number">1</span>][<span class="number">1</span>]=-inf;&#125;&#125;;</span><br><span class="line">matrix <span class="keyword">operator</span> * (matrix&amp;a,matrix&amp;b) &#123;</span><br><span class="line">    matrix ret;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;<span class="number">2</span>;++k)</span><br><span class="line">        ret.c[i][j]=max(ret.c[i][j],a.c[i][k]+b.c[k][j]);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v[N],dp[N][<span class="number">2</span>],head[N],nxt[N&lt;&lt;<span class="number">1</span>],to[N&lt;&lt;<span class="number">1</span>],cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;nxt[++cnt]=head[u],to[cnt]=v,head[u]=cnt;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">link_cut_tree</span> &#123;</span></span><br><span class="line">    matrix f[N],g[N];</span><br><span class="line">    <span class="keyword">int</span> ch[N][<span class="number">2</span>],fa[N];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> !((ch[fa[x]][<span class="number">0</span>]==x)||(ch[fa[x]][<span class="number">1</span>]==x));&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        f[x]=g[x];</span><br><span class="line">        <span class="keyword">if</span>(ch[x][<span class="number">0</span>]) f[x]=f[ch[x][<span class="number">0</span>]]*f[x];<span class="keyword">if</span>(ch[x][<span class="number">1</span>]) f[x]=f[x]*f[ch[x][<span class="number">1</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> y=fa[x],z=fa[y],k=ch[y][<span class="number">1</span>]==x,v=ch[x][!k];</span><br><span class="line">        <span class="keyword">if</span>(!isroot(y)) ch[z][ch[z][<span class="number">1</span>]==y]=x;ch[x][!k]=y,ch[y][k]=v;</span><br><span class="line">        <span class="keyword">if</span>(v) fa[v]=y;fa[y]=x,fa[x]=z;pushup(y);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(!isroot(x)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!isroot(fa[x]))</span><br><span class="line">                rotate((ch[fa[x]][<span class="number">0</span>]==x)^(ch[fa[fa[x]]][<span class="number">0</span>]==fa[x])?x:fa[x]);</span><br><span class="line">            rotate(x);</span><br><span class="line">        &#125;pushup(x);<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Access</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> y=<span class="number">0</span>;x;x=fa[y=x]) &#123;</span><br><span class="line">            Splay(x);</span><br><span class="line">            <span class="keyword">if</span>(ch[x][<span class="number">1</span>]) &#123;</span><br><span class="line">                g[x].c[<span class="number">0</span>][<span class="number">0</span>]+=max(f[ch[x][<span class="number">1</span>]].c[<span class="number">0</span>][<span class="number">0</span>],f[ch[x][<span class="number">1</span>]].c[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">                g[x].c[<span class="number">1</span>][<span class="number">0</span>]+=f[ch[x][<span class="number">1</span>]].c[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(y) &#123;</span><br><span class="line">                g[x].c[<span class="number">0</span>][<span class="number">0</span>]-=max(f[y].c[<span class="number">0</span>][<span class="number">0</span>],f[y].c[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">                g[x].c[<span class="number">1</span>][<span class="number">0</span>]-=f[y].c[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            g[x].c[<span class="number">0</span>][<span class="number">1</span>]=g[x].c[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">            ch[x][<span class="number">1</span>]=y,pushup(x);</span><br><span class="line">        &#125;<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        Access(x),Splay(x),g[x].c[<span class="number">1</span>][<span class="number">0</span>]-=v[x]-y;</span><br><span class="line">        pushup(x),v[x]=y;<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">        dp[u][<span class="number">1</span>]=v[u];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> v=to[i];<span class="keyword">if</span>(v!=fa[u]) &#123;</span><br><span class="line">                fa[v]=u,build(v);</span><br><span class="line">                dp[u][<span class="number">0</span>]+=max(dp[v][<span class="number">0</span>],dp[v][<span class="number">1</span>]);</span><br><span class="line">                dp[u][<span class="number">1</span>]+=dp[v][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        g[u].c[<span class="number">0</span>][<span class="number">0</span>]=g[u].c[<span class="number">0</span>][<span class="number">1</span>]=dp[u][<span class="number">0</span>];</span><br><span class="line">        g[u].c[<span class="number">1</span>][<span class="number">0</span>]=dp[u][<span class="number">1</span>];f[u]=g[u];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,m;IN(n),IN(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(v[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,u,v;i&lt;n;++i)IN(u),IN(v),add(u,v),add(v,u);</span><br><span class="line">    T.build(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span>(m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;IN(x),IN(y);</span><br><span class="line">        T.change(x,y),T.Splay(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,max(T.f[<span class="number">1</span>].c[<span class="number">0</span>][<span class="number">0</span>],T.f[<span class="number">1</span>].c[<span class="number">1</span>][<span class="number">0</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;çœ‹æ‡‚äº†åå‘ç° $\texttt{DDP}$ å…¶å®ä¸éš¾å‘¢â€¦â€¦&lt;/p&gt;
&lt;p&gt;å…¶å®ä¸»è¦æ€æƒ³å°±æ˜¯å°† $\texttt{DP}$ è½¬ç§»å¼æåˆ°çŸ©é˜µä¸Šï¼Œç„¶åå¦‚æœæ˜¯æ ‘å½¢ $\texttt{DP}$ çš„è¯å°±å¯ä»¥ç›´æ¥ä¸Šæ ‘å‰–æˆ–è€…æ˜¯ $LCT$ è¿›è¡Œç»´æŠ¤ï¼Œå½“ç„¶è¿˜å¯ä»¥ç”¨å…¨å±€å¹³è¡¡äºŒå‰æ ‘(ä¸è´¹) ã€‚å¦‚æœåªæ˜¯çº¿æ€§çš„è¯å¯ä»¥ç›´æ¥ç”¨çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„è¿›è¡Œç»´æŠ¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„è¿™é“æ¨¡æ¿æ ‘å‰–çš„å¤æ‚åº¦æ˜¯ $O(nlog^2n)$ ï¼Œè€Œ $LCT$ çš„å¤æ‚åº¦ä¸º $O(nlogn)$ ï¼Œäºæ˜¯çªé€‰æ‹©äº† $LCT$ ï¼Œè·‘çš„è¿˜æŒºå¿«ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="LCT" scheme="http://qiulyblog.github.io/tags/LCT/"/>
    
      <category term="çŸ©é˜µ" scheme="http://qiulyblog.github.io/tags/%E7%9F%A9%E9%98%B5/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘[HNOI2019]ç™½å…”ä¹‹èˆ  å•ä½æ ¹åæ¼”+MTT  luoguP5293</title>
    <link href="http://qiulyblog.github.io/2019/04/17/%5B%E9%A2%98%E8%A7%A3%5DluoguP5293/"/>
    <id>http://qiulyblog.github.io/2019/04/17/[é¢˜è§£]luoguP5293/</id>
    <published>2019-04-16T16:00:00.000Z</published>
    <updated>2019-04-18T01:53:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>å•ä½æ ¹åæ¼”ä¸ä¼šå•Šæ€ä¹ˆæ $FFT$ å§ï¼Œè¿˜æ˜¯äº†è§£äº†å•ä½æ ¹åæ¼”åæ‰å¯ä»¥æçš„å¥½å§â€¦â€¦å±…ç„¶æœ‰äººåæ§½æˆ‘è¯´æˆ‘<strong>å­¦äº† $FFTâ€‹$ ä½†æ˜¯ä¸ä¼šè¿ç”¨ï¼Ÿï¼</strong>ï¼Œå˜¤å˜¤å˜¤æ‰“å‡»æœ‰äº›å¤§â€¦â€¦</p><p>å®é™…ä¸Šæ‰€è°“çš„å•ä½æ ¹åæ¼”å°±æ˜¯è¿™ä¸ªä¸œè¥¿ï¼š</p><script type="math/tex; mode=display">\frac{1}{n}\sum_{i=0}^{n-1}(\omega_n^d)^i=[n|d]</script><a id="more"></a><p>å›åˆ°é¢˜ç›®ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘æ­£è§£çš„ç®€åŒ–ç‰ˆâ€”â€” $n=1$ çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ $W=w[1][1]$ ã€‚</p><p>ç°åœ¨å¯¹äºæ¯ä¸€ä¸ª $t$ çš„ç­”æ¡ˆæ˜¾ç„¶ä¸º $\sum_{i=0}^{L}[i\% k=t] W^i (^L_i)$</p><p>è¿™ä¸ªå¼å­æ˜¾ç„¶ç­‰äº $\sum_{i=0}^{L}[k|(i-t)] w^i (^L_i)$ ã€‚ä¼šå‘ç° $[k|(i-t)]$ å’Œä¸Šé¢å•ä½æ ¹åæ¼”çš„ $[n|d]$ ä¸€æ ·ï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•å°†å•ä½æ ¹åæ¼”çš„å¼å­å¸¦è¿›å»ã€‚</p><script type="math/tex; mode=display">=\sum_{i=0}^{L}\frac{1}{k}\sum_{j=0}^{k-1}(\omega_k^{i-t})^j W^i \binom{L}{i}\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}\sum_{i=0}^{L} \omega_k^{ij} W^i \binom{L}{i}\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}\sum_{i=0}^{L} \binom{L}{i}(\omega_k^{j} W)^i\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}\sum_{i=0}^{L} \binom{L}{i}(\omega_k^{j} W)^i 1^{n-i}\\\\=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-tj}(\omega_k^{j} W+1)^L</script><p>åé¢çš„ $(\omega_k^{j} W+1)^L$ æ˜¾ç„¶å¯ä»¥é¢„å¤„ç†ï¼Œè®°ä¸º $num_j$ ã€‚</p><p>ç„¶åå‘ç° $-tj=\binom{t}{2}+\binom{j}{2}-\binom{t+j}{2}$</p><script type="math/tex; mode=display">=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{\binom{t}{2}+\binom{j}{2}-\binom{t+j}{2}}num_j\\\\=\frac{1}{k}\omega_k^{\binom{t}{2}}\sum_{j=0}^{k-1}num_j\omega_k^{\binom{j}{2}}\cdot\omega_k^{-\binom{t+j}{2}}</script><p>åé¢çš„å¼å­å¯ä»¥ç”¨ $FFT$ åŠ é€Ÿï¼Œä½†æ˜¯å€¼åŸŸå¤ªå¤§è¿™é‡Œéœ€è¦ç”¨åˆ° $MTT$ ã€‚ç°åœ¨å°±æœ‰ $40$ åˆ†äº†ï¼Œæ¥ä¸‹æ¥è€ƒè™‘ $n&gt;1$ çš„æƒ…å†µã€‚</p><p>æˆ‘ä»¬å»ºçŸ©é˜µï¼Œç„¶åä¼šå‘ç° $n&gt;1$ ä»…ä¼šå¯¹ $num_j$ çš„è®¡ç®—æ–¹å¼æœ‰å˜åŒ–ã€‚</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª $begin$ çŸ©é˜µï¼Œè¯¥çŸ©é˜µåªæœ‰ $(0,x)$ ä½ç½®ä¸Šæœ‰å€¼ä¸”å€¼ä¸º $1$ ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ç™½å…”çš„èµ·ç‚¹ã€‚é‚£ä¹ˆæœ€åæˆ‘ä»¬éœ€è¦ç•™ä¸‹æ¥çš„ä¹Ÿå°±æ˜¯çŸ©é˜µçš„ $(0,y)$ ï¼Œå› ä¸ºåªæœ‰åœ¨ç¬¬äºŒç»´ä¸º $y$ æ˜¯æ‰ä¼šè®¡å…¥ç­”æ¡ˆã€‚</p><p>å—¯ï¼Œå·®ä¸å¤šå¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">begin.c[<span class="number">0</span>][x]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) </span><br><span class="line">    num[i]=(begin*<span class="built_in">pow</span>(w*num[i]+I,n)).c[<span class="number">0</span>][y]%MOD;</span><br><span class="line"><span class="comment">/*wå°±æ˜¯ä¸Šæ–‡ä¸­çš„Wï¼Œä¸è¿‡è¿™é‡Œæ˜¯çŸ©é˜µ*/</span></span><br><span class="line"><span class="comment">/*Iæ˜¯çŸ©é˜µä¸­çš„å•ä½'1'*/</span></span><br></pre></td></tr></table></figure><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">65536</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI=<span class="built_in">acos</span>(<span class="number">-1</span>);   </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m,k,n,x,y,MOD,G,num[N],A[N&lt;&lt;<span class="number">2</span>],B[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> F(x,i,j) for((x)=(i);(x)&lt;=(j);++(x))</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">IN</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;ll x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;<span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">matrix</span> &#123;</span><span class="keyword">int</span> c[<span class="number">3</span>][<span class="number">3</span>];matrix()&#123;<span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span>(c));&#125;&#125;;</span><br><span class="line">    matrix <span class="keyword">operator</span> + (<span class="keyword">const</span> matrix&amp;a,<span class="keyword">const</span> matrix&amp;b) &#123;</span><br><span class="line">        matrix ans;<span class="keyword">int</span> i,j;F(i,<span class="number">0</span>,<span class="number">2</span>)F(j,<span class="number">0</span>,<span class="number">2</span>) &#123;</span><br><span class="line">            ans.c[i][j]=a.c[i][j]+b.c[i][j];</span><br><span class="line">            <span class="keyword">if</span>(ans.c[i][j]&gt;=MOD) ans.c[i][j]-=MOD;</span><br><span class="line">        &#125;<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> matrix&amp;a,<span class="keyword">const</span> matrix&amp;b) &#123;</span><br><span class="line">        matrix ans;<span class="keyword">int</span> i,j,k;F(i,<span class="number">0</span>,<span class="number">2</span>)F(j,<span class="number">0</span>,<span class="number">2</span>)F(k,<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">            ans.c[i][k]=(ans.c[i][k]+<span class="number">1l</span>l*a.c[i][j]*b.c[j][k])%MOD;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> matrix&amp;a,<span class="keyword">const</span> <span class="keyword">int</span>&amp;b) &#123;</span><br><span class="line">        matrix ans;<span class="keyword">int</span> i,j;F(i,<span class="number">0</span>,<span class="number">2</span>)F(j,<span class="number">0</span>,<span class="number">2</span>)ans.c[i][j]=<span class="number">1l</span>l*a.c[i][j]*b%MOD;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">complex</span>&#123;</span><span class="keyword">complex</span>(<span class="keyword">long</span> <span class="keyword">double</span> a=<span class="number">0</span>,<span class="keyword">long</span> <span class="keyword">double</span> b=<span class="number">0</span>)&#123;x=a,y=b;&#125;<span class="keyword">long</span> <span class="keyword">double</span> x,y;&#125;;</span><br><span class="line">    <span class="keyword">complex</span> <span class="keyword">operator</span> + (<span class="keyword">complex</span> a,<span class="keyword">complex</span> b)&#123;<span class="keyword">return</span> <span class="keyword">complex</span>(a.x+b.x,a.y+b.y);&#125;</span><br><span class="line">    <span class="keyword">complex</span> <span class="keyword">operator</span> - (<span class="keyword">complex</span> a,<span class="keyword">complex</span> b)&#123;<span class="keyword">return</span> <span class="keyword">complex</span>(a.x-b.x,a.y-b.y);&#125;</span><br><span class="line">    <span class="keyword">complex</span> <span class="keyword">operator</span> * (<span class="keyword">complex</span> a,<span class="keyword">complex</span> b)&#123;<span class="keyword">return</span> <span class="keyword">complex</span>(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);&#125;</span><br><span class="line">    matrix I;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pow</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">1</span>;<span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=<span class="number">1l</span>l*x*x%MOD) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=<span class="number">1l</span>l*res*x%MOD;</span><br><span class="line">        <span class="keyword">return</span> res%MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> matrix <span class="title">pow</span><span class="params">(matrix x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        matrix res=I;<span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=x*x) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=res*x;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> MTT &#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> BLOCK 32768</span></span><br><span class="line">    <span class="keyword">int</span> limit=<span class="number">1</span>,cnt=<span class="number">0</span>,filp[N&lt;&lt;<span class="number">2</span>],Ans[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">complex</span> A1[N&lt;&lt;<span class="number">2</span>],B1[N&lt;&lt;<span class="number">2</span>],A2[N&lt;&lt;<span class="number">2</span>],B2[N&lt;&lt;<span class="number">2</span>],X[N&lt;&lt;<span class="number">2</span>],omg[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fft</span><span class="params">(<span class="keyword">complex</span> *f,<span class="keyword">short</span> inv)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)<span class="keyword">if</span>(i&lt;filp[i])<span class="built_in">std</span>::swap(f[i],f[filp[i]]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> p=<span class="number">1</span>;p&lt;limit;p&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">complex</span> *a=f;a!=f+limit;a+=(p&lt;&lt;<span class="number">1</span>))</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">0</span>;l&lt;p;++l)&#123;</span><br><span class="line">                    <span class="keyword">complex</span> t=a[l+p]*omg[limit/(p&lt;&lt;<span class="number">1</span>)*l];</span><br><span class="line">                    a[l+p]=a[l]-t,a[l]=a[l]+t;</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">mtt</span><span class="params">(<span class="keyword">int</span> *A,<span class="keyword">int</span> *B)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(limit&lt;(k*<span class="number">3</span>+<span class="number">5</span>)) limit&lt;&lt;=<span class="number">1</span>,++cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) filp[i]=(filp[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(cnt<span class="number">-1</span>));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) A1[i].x=A[i]&amp;(BLOCK<span class="number">-1</span>),A2[i].x=A[i]&gt;&gt;<span class="number">15</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) B1[i].x=B[i]&amp;(BLOCK<span class="number">-1</span>),B2[i].x=B[i]&gt;&gt;<span class="number">15</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) omg[i]=(<span class="keyword">complex</span>)&#123;<span class="built_in">cos</span>(i*PI*<span class="number">2</span>/limit),<span class="built_in">sin</span>(i*PI*<span class="number">2</span>/limit)&#125;;</span><br><span class="line">        fft(A1,<span class="number">1</span>),fft(B1,<span class="number">1</span>);fft(A2,<span class="number">1</span>),fft(B2,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)&#123;</span><br><span class="line">            <span class="keyword">complex</span> a1=A1[i],a2=A2[i],b1=B1[i],b2=B2[i];</span><br><span class="line">            A1[i]=a1*b1,A2[i]=a2*b2,B1[i]=a1*b2,B2[i]=a2*b1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i) omg[i]=(<span class="keyword">complex</span>)&#123;<span class="built_in">cos</span>(i*PI*<span class="number">2</span>/limit),-<span class="built_in">sin</span>(i*PI*<span class="number">2</span>/limit)&#125;;</span><br><span class="line">        fft(A1,<span class="number">-1</span>),fft(B1,<span class="number">-1</span>);fft(A2,<span class="number">-1</span>),fft(B2,<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)</span><br><span class="line">            A1[i].x/=limit,A2[i].x/=limit,B1[i].x/=limit,B2[i].x/=limit;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;limit;++i)</span><br><span class="line">            Ans[i]=((ll)(A1[i].x+<span class="number">0.5</span>)%MOD+<span class="number">1073741824l</span>l*((ll)(A2[i].x+<span class="number">0.5</span>)%MOD)%MOD+</span><br><span class="line">            <span class="number">32768l</span>l*((ll)(B1[i].x+<span class="number">0.5</span>)%MOD)%MOD+<span class="number">32768l</span>l*((ll)(B2[i].x+<span class="number">0.5</span>)%MOD)%MOD)%MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> MTT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> divisor[<span class="number">105</span>],tot;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get_G</span><span class="params">()</span> </span>&#123;<span class="comment">/*è·å–åŸæ ¹*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>,S=MOD<span class="number">-1</span>;i&lt;=S;++i) </span><br><span class="line">        <span class="keyword">if</span>(S%i==<span class="number">0</span>) &#123;divisor[++tot]=i;<span class="keyword">while</span>(!(S%i)) S/=i;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> g=<span class="number">2</span>;;++g) &#123;</span><br><span class="line">        <span class="keyword">bool</span> ok=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=tot;++j) <span class="keyword">if</span>(<span class="built_in">pow</span>(g,(MOD<span class="number">-1</span>)/divisor[j])==<span class="number">1</span>) &#123;ok=<span class="literal">false</span>;<span class="keyword">break</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(ok) <span class="keyword">return</span> g;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">matrix w,s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    I.c[<span class="number">0</span>][<span class="number">0</span>]=I.c[<span class="number">1</span>][<span class="number">1</span>]=I.c[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">1</span>;</span><br><span class="line">    m=IN(),k=IN(),n=IN(),x=IN(),y=IN(),MOD=IN();--x,--y;</span><br><span class="line">    <span class="comment">/*numå…¶å®å°±æ˜¯ä¸Šæ–‡ä¸­çš„å•ä½æ ¹ï¼Œè¿™é‡Œé¢„å¤„ç†ä¸€ä¸‹è®¡ç®—æ–¹ä¾¿äº›*/</span></span><br><span class="line">    num[<span class="number">0</span>]=<span class="number">1</span>,num[<span class="number">1</span>]=<span class="built_in">pow</span>(G=get_G(),(MOD<span class="number">-1</span>)/k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;k;++i) num[i]=<span class="number">1l</span>l*num[<span class="number">1</span>]*num[i<span class="number">-1</span>]%MOD;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i) <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;++j) w.c[i][j]=IN();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);++i) A[i]=num[(k<span class="number">-1l</span>l*i*(i<span class="number">-1</span>)/<span class="number">2</span>%k)%k];</span><br><span class="line">    s.c[<span class="number">0</span>][x]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) B[i]=<span class="number">1l</span>l*num[<span class="number">1l</span>l*i*(i<span class="number">-1</span>)/<span class="number">2</span>%k]*(s*<span class="built_in">pow</span>(w*num[i]+I,n)).c[<span class="number">0</span>][y]%MOD;</span><br><span class="line">    <span class="comment">/*è®¡ç®—åé¢ä¸¤ä¸ªå¤šé¡¹å¼çš„å€¼*/</span></span><br><span class="line">    reverse(B,B+k+<span class="number">1</span>),mtt(A,B);</span><br><span class="line">    <span class="keyword">int</span> invk=<span class="built_in">pow</span>(k,MOD<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,<span class="number">1l</span>l*Ans[i+k]*invk%MOD*num[<span class="number">1l</span>l*i*(i<span class="number">-1</span>)/<span class="number">2</span>%k]%MOD);</span><br><span class="line">    <span class="comment">/*è®¡ç®—ç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å•ä½æ ¹åæ¼”ä¸ä¼šå•Šæ€ä¹ˆæ $FFT$ å§ï¼Œè¿˜æ˜¯äº†è§£äº†å•ä½æ ¹åæ¼”åæ‰å¯ä»¥æçš„å¥½å§â€¦â€¦å±…ç„¶æœ‰äººåæ§½æˆ‘è¯´æˆ‘&lt;strong&gt;å­¦äº† $FFTâ€‹$ ä½†æ˜¯ä¸ä¼šè¿ç”¨ï¼Ÿï¼&lt;/strong&gt;ï¼Œå˜¤å˜¤å˜¤æ‰“å‡»æœ‰äº›å¤§â€¦â€¦&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šæ‰€è°“çš„å•ä½æ ¹åæ¼”å°±æ˜¯è¿™ä¸ªä¸œè¥¿ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;\frac{1}{n}\sum_{i=0}^{n-1}(\omega_n^d)^i=[n|d]&lt;/script&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="FFT" scheme="http://qiulyblog.github.io/tags/FFT/"/>
    
      <category term="å•ä½æ ¹åæ¼”" scheme="http://qiulyblog.github.io/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/"/>
    
      <category term="MTT" scheme="http://qiulyblog.github.io/tags/MTT/"/>
    
  </entry>
  
</feed>
