<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Qiuly&#39;s blog!</title>
  
  <subtitle>A weak OIer from HN-YZ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://qiulyblog.github.io/"/>
  <updated>2019-05-12T08:54:08.118Z</updated>
  <id>http://qiulyblog.github.io/</id>
  
  <author>
    <name>Qiuly</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [ä¹çœè”è€ƒ2018]æ—å…‹å¡ç‰¹æ ‘  æ ‘å½¢DP+wqsäºŒåˆ†ä¼˜åŒ–  loj2478</title>
    <link href="http://qiulyblog.github.io/2019/05/12/%5B%E9%A2%98%E8%A7%A3%5Dloj2478/"/>
    <id>http://qiulyblog.github.io/2019/05/12/[é¢˜è§£]loj2478/</id>
    <published>2019-05-11T16:00:00.000Z</published>
    <updated>2019-05-12T08:54:08.118Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯’ç˜¤ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2478" target="_blank" rel="noopener">æˆ³æˆ‘æˆ³æˆ‘</a></p><p>ä»”ç»†è§‚å¯Ÿä¼šå‘ç°è¯¥é¢˜éœ€è¦ä»æ ‘ä¸Šæ‹¿å‡º $k+1$ æ¡äº’ä¸ç›¸äº¤çš„é“¾ï¼Œæ±‚è¿™äº›é“¾çš„èŠ‚ç‚¹çš„æƒå€¼æ€»å’Œçš„æœ€å¤§å€¼ã€‚é‚£ä¹ˆæˆ‘ä»¬é€‰å‡ºè¿™äº›é“¾åå°±å¯ä»¥ç”¨ $k$ æ¡è¾¹å°†å…¶è¿èµ·æ¥äº†ï¼Œè¿™æ ·å°±æ»¡è¶³äº†é¢˜æ„ã€‚</p><a id="more"></a><p>ç”¨ $f_{i,j}$ è¡¨ç¤º $i$ çš„å­æ ‘ä¸­é€‰å‡ºäº† $j$ ä¸ªé“¾çš„æœ€å¤§å€¼ï¼Œä½†æ˜¯ä¼šå‘ç°è½¬ç§»å¾ˆéš¾åŠï¼Œæšä¸¾ä¸€ä¸ª $i$ çš„å„¿å­ $v$ çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¥½ç®—å‡º $v$ å¯¹ $i$ ä¸Šçš„é“¾åšå‡ºçš„è´¡çŒ®ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æ–°å¢åŠ ä¸€ä¸ªçŠ¶æ€ï¼Œè®¾ $f_{0/1/2,i,j}$ ä¸ºæˆ‘ä»¬çš„çŠ¶æ€ï¼Œ$i,j$ çš„æ„æ€å’Œä¸Šé¢ä¸€æ ·ï¼Œå…¶ä¸­ $0/1/2$ åˆ†åˆ«è¡¨ç¤ºâ€”â€”<strong>$0$ : $i$ ä¸å±äºå­æ ‘ä¸­ $j$ æ¡é“¾ä¸­çš„ä»»æ„ä¸€æ¡ï¼Œ$1$ : $i$ å±äº $j$ æ¡é“¾ä¸­å…¶ä¸­ä¸€æ¡ï¼Œ$2$ : $i$ å±äº $j$ æ¡é“¾ä¸­çš„å…¶ä¸­ä¸¤æ¡</strong> ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æšä¸¾ä¸€ä¸ªå„¿å­ $v$ ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦è½¬ç§»çš„å¯¹è±¡å°±æ˜¯ $u$ (ä¸Šé¢çš„ $i$ ) ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ³¨æ„æ¥è€ƒè™‘ï¼š</p><p>æˆ‘ä»¬è½¬ç§»çš„æ—¶å€™æšä¸¾ä¸€ä¸ª $i$ è¡¨ç¤ºå½“å‰çš„é“¾æ•°ï¼Œç„¶åæšä¸¾ $j$ è¡¨ç¤º $v$ å­æ ‘ä¸­çš„é“¾æ•°ï¼Œé‚£ä¹ˆä¹‹å‰ $u$ å­æ ‘ä¸­çš„é“¾æ•°æ˜¾ç„¶å°±æ˜¯ $i-j$ äº†ã€‚</p><p>ä»¤ $num_{v,j}=\max(f_{0,v,j},f_{1,v,j},f_{2,v,j})$ .</p><ul><li><p>è®¡ç®— $v$ å¯¹ $f_{0,u,i}$ çš„è´¡çŒ®</p><ul><li><p>å› ä¸ºè¯¥çŠ¶æ€å¿…é¡»æ»¡è¶³ $u$ ä¸èƒ½å±äºä»»æ„ä¸€æ¡é“¾ï¼Œæ‰€æœ‰æˆ‘ä»¬ç†æ‰€å½“ç„¶ä¹Ÿä¸èƒ½è¿ä¸Š $u\rightarrow v$ è¿™æ¡è¾¹ã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ $v$ ä¸­å‘ç”Ÿä»€ä¹ˆäº‹æƒ…éƒ½è·Ÿ $u$ æ²¡æœ‰ä»»ä½•å…³ç³»äº†ï¼Œå› ä¸ºè¦ç»Ÿè®¡æœ€å¤§ï¼Œæˆ‘ä»¬ç›´æ¥å°† $num$ ç»Ÿè®¡è¿›å»å³å¯ã€‚</p></li><li><p>è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f_{0,u,i}=\max_v\max_j \{f_{0,u,i-j}+num_{v,j}\}</script></li></ul></li><li><p>è®¡ç®— $v$ å¯¹ $f_{1,u,i}$ çš„è´¡çŒ®</p><ul><li><p>è€ƒè™‘ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§ï¼Œè¿™ä¸€æ¡å’Œ $u$ æœ‰å…³çš„é“¾æ˜¯è¿ç€åˆ«çš„å­æ ‘çš„ï¼Œé‚£ä¹ˆä¹Ÿå°±è‚¯å®šä¸ä¼šè¿ä¸Š $u\rightarrow v$ è¿™æ¡è¾¹ï¼ŒæŒ‰ç…§ä¸Šé¢çš„è½¬ç§»å³å¯ã€‚</p></li><li><p>ç¬¬ä¸€ç§è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f_{1,u,i}=\max_v\max_j \{f_{1,u,i-j}+num_{v,j}\}â€‹</script></li><li><p>ç¬¬äºŒç§æƒ…å†µå°±æ˜¯è¿™ä¸€æ¡é“¾æ˜¯å’Œ $v$ ç›¸è¿æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ $v$ çš„çŠ¶æ€åªèƒ½æ˜¯ $0,1$ ï¼ŒåŸå› å¾ˆæ˜¾ç„¶ï¼Œé“¾ä¸èƒ½é¦™è•‰(æœ€å¥½åƒäº†ğŸŒ) ï¼Œé‚£ä¹ˆå¯¹äº $v$ çŠ¶æ€æ˜¯ $0$ çš„æƒ…å†µï¼Œè¿™æ ·ä¸€è¿æ¥åå°±ä¼šæ–°å‡ºç°ä¸€æ¡é“¾äº†ï¼Œè®°å¾—ç®—ä¸Šè¾¹æƒï¼š</p></li><li><p>è½¬ç§» $0$ æƒ…å†µï¼š</p><script type="math/tex; mode=display">f_{1,u,i}=\max_v\max_j\{f_{0,u,i-j}+f_{0,v,j-1}+w\}â€‹</script><p>$f_{0,u,i-j}$ ä¸è§£é‡Šï¼Œ$f_{0,v,j-1}$ è¿™é‡Œä¸ºä»€ä¹ˆè¦ $j-1$ å‘¢ï¼Ÿå› ä¸ºå¾ˆæ˜¾ç„¶å½“å‰å±€é¢åªæœ‰ $i-1$ æ¡é“¾ï¼Œä¸Šé¢è®²äº†è¿æ¥åä¼šå¤šå‡ºæ¥ä¸€æ¡ï¼Œé‚£ä¹ˆ $i-1+1$ å°±æ­£å¥½ç”¨æ¥è½¬ç§» $i$ äº†ã€‚æœ€åçš„ $w$ å³ä¸ºå½“å‰è½¬ç§»å¸¦æ¥çš„è´¡çŒ®ã€‚</p></li><li><p>$v$ çš„çŠ¶æ€æ˜¯ $1$ çš„æ—¶å€™å’Œä¸Šé¢å·®ä¸å¤šï¼Œä½†æ˜¯å› ä¸ºè¿æ¥ $u,v$ å $u$ å±äºäº†åŸæ¥å°±å­˜åœ¨çš„ä¸€æ¡é“¾ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰æ–°å¢é“¾ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦ $j-1$ äº†ã€‚</p></li><li><p>è½¬ç§» $1$ çš„æƒ…å†µï¼š</p><script type="math/tex; mode=display">f_{1,u,i}=\max_v\max_j\{f_{0,u,i-1}+f_{1,v,j}+w\}</script></li></ul></li><li><p>è®¡ç®— $v$ å¯¹ $f_{2,u,i}$ çš„è´¡çŒ®</p><ul><li><p>é¦–å…ˆå¦‚æœè¿™ä¸¤æ¡é“¾è¿æ¥åˆ«çš„å­æ ‘äº†ï¼Œé‚£ä¹ˆ $v$ å°±æ²¡æœ‰é™åˆ¶äº†ï¼Œè½¬ç§»åŒä¸Šï¼š</p></li><li><p>è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f_{2,u,i}=\max_v\max_j \{f_{2,u,i-j}+num_{v,j}\}</script></li><li><p>æ¥ä¸‹æ¥çš„å°±å¾ˆå¥½åŠäº†ï¼Œå› ä¸ºè¿æ¥ $u,v$ æœ€å¤šæ˜¯ä¸€æ¡é“¾ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸å¯èƒ½å°†ä¸¤æ¡é“¾éƒ½æ”¾åˆ° $v$ ä¸‹æ¥ã€‚å…ˆè€ƒè™‘ $v$ çŠ¶æ€ä¸º $0$ çš„æƒ…å†µï¼Œå› ä¸ºè¿æ¥å $v$ å±äºäº† $u$ åŸæ¥æ‰€åœ¨çš„é“¾(æ²¡æœ‰æ–°å¢é“¾)ï¼Œé‚£ä¹ˆç›´æ¥ç®—è´¡çŒ®ï¼š</p></li><li><p>è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f_{2,u,i}=\max_v\max_j\{f_{1,u,i-j}+f_{0,v,j}+w\}</script></li><li><p>ç„¶åè€ƒè™‘ $v$ çŠ¶æ€ä¸º $1$ çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™è¿æ¥ $u,v$ ä¼šä½¿å¾— $v$ åŸæ¥æ‰€åœ¨çš„é“¾å’Œ $u$ åŸæ¥æ‰€åœ¨çš„é“¾åˆå¹¶ä¸ºä¸€æ¡é“¾ï¼Œé‚£ä¹ˆè¿™é‡Œçš„å’Œä¸Šé¢çš„ $j-1$ ä¸åŒï¼Œè¿™é‡Œå› ä¸ºæ˜¯å°‘äº†ä¸€æ¡é“¾æ‰€æœ‰è¦å˜æˆ $j+1$ ã€‚</p></li><li><p>è½¬ç§»ï¼š</p><script type="math/tex; mode=display">f_{2,u,i}=\max_v\max_j\{f_{1,u,i-j}+f_{1,v,j+1}+w\}</script></li></ul></li></ul><p>æ‰€æœ‰çš„è½¬ç§»å¼éƒ½å¾—åˆ°äº†ï¼Œæˆ‘ä»¬æ¥è€ƒè™‘åˆå§‹åŒ–ï¼Œé¦–å…ˆå› ä¸ºæ˜¯å–æœ€å¤§å€¼ï¼Œæˆ‘ä»¬éœ€è¦å…¨éƒ¨åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¾ˆå°çš„è´Ÿæ•°ã€‚ç„¶åå¯¹äº $f_{0,u,0}$ è¿™æ ·çš„çŠ¶æ€çš„å€¼å¾ˆæ˜¾ç„¶æ˜¯ $0$ ã€‚</p><p>å…¶ä»–çš„æ²¡äº†ï¼Œæ³¨æ„è¿™æ ·çš„ $\rm{DP}$ å¤æ‚åº¦åªèƒ½è®©æˆ‘ä»¬æœ€å¤šæ‹¿åˆ° $60$ åˆ†ã€‚</p><h3 id="Code-60-pts-ï¼š"><a href="#Code-60-pts-ï¼š" class="headerlink" title="Code (60 $pts$ ) ï¼š"></a>Code (60 $pts$ ) ï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,k,sz[N],head[N],cnt;</span><br><span class="line">ll dp[<span class="number">3</span>][N][<span class="number">110</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to,val;&#125; G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[u],v,w&#125;,head[u]=cnt;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[v],u,w&#125;,head[v]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    dp[<span class="number">0</span>][u][<span class="number">0</span>]=<span class="number">0</span>;<span class="comment">/*åˆå§‹åŒ–*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> e=head[u];e;e=G[e].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> v=G[e].to,w=G[e].val;</span><br><span class="line">        <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v,u),sz[u]+=sz[v];</span><br><span class="line">        <span class="comment">/*åˆ©ç”¨szæ•°ç»„ä¼˜åŒ–ï¼ŒåŒæ ·æ˜¯O(nk^2)çš„ä»£ç ï¼Œå…¶ä»–çš„åªèƒ½æ‹¿åˆ°30</span></span><br><span class="line"><span class="comment">        ~40ï¼Œä½†æ˜¯è¿™ä¸ªä¼˜åŒ–è¿‡åæ˜¯å¦¥å¦¥çš„60åˆ†*/</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=min(sz[u],k);i;--i) &#123;</span><br><span class="line">            <span class="comment">/*è®¡ç®—vä¸‹é¢æ²¡æœ‰é“¾çš„æƒ…å†µï¼Œè®¡ç®—åˆå§‹çŠ¶æ€å¸¦æ¥çš„è´¡çŒ®*/</span></span><br><span class="line">            dp[<span class="number">2</span>][u][i]=max(dp[<span class="number">2</span>][u][i],dp[<span class="number">1</span>][u][i]+w);</span><br><span class="line">            dp[<span class="number">2</span>][u][i]=max(dp[<span class="number">2</span>][u][i],dp[<span class="number">1</span>][u][i]+dp[<span class="number">1</span>][v][<span class="number">1</span>]+w);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=min(sz[v],i);j;--j) &#123;</span><br><span class="line">                <span class="comment">/*è®¡ç®—å‡ºnum*/</span></span><br><span class="line">                ll num=max(dp[<span class="number">0</span>][v][j],max(dp[<span class="number">1</span>][v][j],dp[<span class="number">2</span>][v][j]));</span><br><span class="line">                <span class="comment">/*ä¸‹é¢çš„7ä¸ªå¼å­å°±æ˜¯ä¸Šæ–‡è®²çš„è½¬ç§»äº†*/</span></span><br><span class="line">                dp[<span class="number">0</span>][u][i]=max(dp[<span class="number">0</span>][u][i],dp[<span class="number">0</span>][u][i-j]+num);</span><br><span class="line"></span><br><span class="line">                dp[<span class="number">1</span>][u][i]=max(dp[<span class="number">1</span>][u][i],dp[<span class="number">1</span>][u][i-j]+num);</span><br><span class="line">                dp[<span class="number">1</span>][u][i]=max(dp[<span class="number">1</span>][u][i],dp[<span class="number">0</span>][u][i-j]+dp[<span class="number">1</span>][v][j]+w);</span><br><span class="line">                dp[<span class="number">1</span>][u][i]=max(dp[<span class="number">1</span>][u][i],dp[<span class="number">0</span>][u][i-j]+dp[<span class="number">0</span>][v][j<span class="number">-1</span>]+w);</span><br><span class="line"></span><br><span class="line">                dp[<span class="number">2</span>][u][i]=max(dp[<span class="number">2</span>][u][i],dp[<span class="number">2</span>][u][i-j]+num);</span><br><span class="line">                dp[<span class="number">2</span>][u][i]=max(dp[<span class="number">2</span>][u][i],dp[<span class="number">1</span>][u][i-j]+dp[<span class="number">0</span>][v][j]+w);</span><br><span class="line">                dp[<span class="number">2</span>][u][i]=max(dp[<span class="number">2</span>][u][i],dp[<span class="number">1</span>][u][i-j]+dp[<span class="number">1</span>][v][j+<span class="number">1</span>]+w);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/*ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå¯ä»¥ç›´æ¥æ”¾åˆ°ä¸Šé¢å»çš„(vä¸‹æ²¡æœ‰é“¾)*/</span></span><br><span class="line">            dp[<span class="number">1</span>][u][i]=max(dp[<span class="number">1</span>][u][i],dp[<span class="number">0</span>][u][i<span class="number">-1</span>]+w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!sz[u]) dp[<span class="number">0</span>][u][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    ++sz[u];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y,v;IN(x),IN(y),IN(v),add(x,y,v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">-0x3f</span>,<span class="keyword">sizeof</span>(dp));<span class="comment">/*æå°å€¼*/</span></span><br><span class="line">    ++k;dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,max(dp[<span class="number">0</span>][<span class="number">1</span>][k],max(dp[<span class="number">1</span>][<span class="number">1</span>][k],dp[<span class="number">2</span>][<span class="number">1</span>][k])));</span><br><span class="line">    <span class="comment">/*è¾“å‡ºæœ€ä¼˜ğŸ‘†*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>å¦‚æœæ‰“å‡ºäº†è¡¨ï¼Œä½ ä¼šå‘ç°å¯¹äºå•è°ƒé€’å¢çš„ $k$ ï¼Œå…³äºå…¶çš„æœ€ä¼˜è§£æ‰€å½¢æˆçš„ä¸€å®šæ˜¯ä¸€ä¸ªä¸Šå‡¸çš„å‡½æ•°ï¼Œæ„Ÿæ€§ç†è§£çš„è¯å°±æ˜¯è¯´ $k$ å°çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥é€‰æ›´å¤šçš„æ›´å¤§çš„è¾¹ï¼Œä½†æ˜¯éšç€ $k$ å¢å¤§ï¼Œè¿™äº›è¾¹ä¸å¤Ÿäº†ï¼Œæˆ‘ä»¬åªèƒ½é€‰æ›´å°çš„æˆ–è€…æ˜¯æ‹†æ‰ä¸€äº›è¾¹(å°†ä¸€æ¡é“¾æ–­æˆä¸¤æ¡å¢åŠ é“¾æ•°) ï¼Œè¿™æ ·å­ç­”æ¡ˆå°±å¥½æ…¢æ…¢å˜å°ã€‚</p><p>å› ä¸ºæ˜¯ä¸Šå‡¸å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ $\rm{DP}$ å‡¸ä¼˜åŒ–ï¼Œå¸¦æƒäºŒåˆ†/$wqs$äºŒåˆ†å¥—è·¯ä¼˜åŒ–ä¸€ä¸‹å°±å¯ä»¥è¿‡äº†ã€‚</p><p>æ³¨æ„äºŒåˆ†è¾¹ç•Œï¼è¿˜æœ‰å°±æ˜¯éœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹ä¹Ÿå¯ä»¥æˆä¸ºä¸€æ¡é“¾çš„æƒ…å†µï¼</p><h3 id="Code-100-pts"><a href="#Code-100-pts" class="headerlink" title="Code (100 $pts$ )"></a>Code (100 $pts$ )</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">6e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf=<span class="number">1e18</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,k,head[N],cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">date</span> &#123;</span></span><br><span class="line">    ll x;<span class="keyword">int</span> y;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> date&amp;var) <span class="keyword">const</span> &#123;<span class="keyword">return</span> x==var.x?y&gt;var.y:x&lt;var.x;&#125;</span><br><span class="line">    date <span class="keyword">operator</span> + (<span class="keyword">const</span> date&amp;var) &#123;<span class="keyword">return</span> (date)&#123;x+var.x,y+var.y&#125;;&#125;</span><br><span class="line">    date <span class="keyword">operator</span> + (<span class="keyword">const</span> ll&amp;var) &#123;<span class="keyword">return</span> (date)&#123;x+var,y&#125;;&#125;</span><br><span class="line">&#125;dp[<span class="number">3</span>][N];</span><br><span class="line"><span class="function">ll <span class="title">number</span><span class="params">(date var)</span> </span>&#123;<span class="keyword">return</span> var.x;&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to,val;&#125; G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[u],v,w&#125;,head[u]=cnt;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[v],u,w&#125;,head[v]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">check</span><span class="params">(ll add,<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    dp[<span class="number">0</span>][u]=(date)&#123;<span class="number">0</span>,<span class="number">0</span>&#125;,</span><br><span class="line">    dp[<span class="number">1</span>][u]=(date)&#123;-inf,<span class="number">0</span>&#125;,</span><br><span class="line">    dp[<span class="number">2</span>][u]=(date)&#123;add,<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> e=head[u];e;e=G[e].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> v=G[e].to;</span><br><span class="line">        ll w=G[e].val;</span><br><span class="line">        <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">        check(add,v,u);</span><br><span class="line">        date num=max(dp[<span class="number">0</span>][v],max(dp[<span class="number">1</span>][v],dp[<span class="number">2</span>][v]));</span><br><span class="line"></span><br><span class="line">        dp[<span class="number">2</span>][u]=max(dp[<span class="number">2</span>][u],dp[<span class="number">2</span>][u]+num);</span><br><span class="line">        dp[<span class="number">2</span>][u]=max(dp[<span class="number">2</span>][u],dp[<span class="number">1</span>][u]+(date)&#123;w,<span class="number">0</span>&#125;+max(dp[<span class="number">0</span>][v],dp[<span class="number">1</span>][v]+(date)&#123;-add,<span class="number">-1</span>&#125;));</span><br><span class="line"></span><br><span class="line">        dp[<span class="number">1</span>][u]=max(dp[<span class="number">1</span>][u],dp[<span class="number">1</span>][u]+num);</span><br><span class="line">        dp[<span class="number">1</span>][u]=max(dp[<span class="number">1</span>][u],dp[<span class="number">0</span>][u]+(date)&#123;w,<span class="number">0</span>&#125;+max(dp[<span class="number">1</span>][v],dp[<span class="number">0</span>][v]+(date)&#123;add,<span class="number">1</span>&#125;));</span><br><span class="line"></span><br><span class="line">        dp[<span class="number">0</span>][u]=dp[<span class="number">0</span>][u]+num;</span><br><span class="line">    &#125;<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">wqs</span><span class="params">(ll sum)</span> </span>&#123;</span><br><span class="line">    ll l=-sum,r=sum,mid;</span><br><span class="line">    date now;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r) &#123;</span><br><span class="line">        mid=(l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>,check(mid,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        now=max(dp[<span class="number">0</span>][<span class="number">1</span>],max(dp[<span class="number">1</span>][<span class="number">1</span>],dp[<span class="number">2</span>][<span class="number">1</span>]));</span><br><span class="line">        <span class="keyword">if</span>(!(now.y^k)) &#123;l=r=mid;<span class="keyword">break</span>;&#125;</span><br><span class="line">        now.y&lt;k?l=mid:r=mid<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    mid=l;check(mid,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    now=max(dp[<span class="number">0</span>][<span class="number">1</span>],max(dp[<span class="number">1</span>][<span class="number">1</span>],dp[<span class="number">2</span>][<span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">return</span> now.x-mid*k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("lct2.in","r",stdin);</span></span><br><span class="line">    <span class="comment">// freopen("P4383.out","w",stdout);</span></span><br><span class="line">    IN(n),IN(k);++k;</span><br><span class="line">    ll sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y,v;IN(x),IN(y),IN(v);</span><br><span class="line">        add(x,y,v),sum+=<span class="built_in">abs</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,wqs(sum));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¯’ç˜¤ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2478&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ³æˆ‘æˆ³æˆ‘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»”ç»†è§‚å¯Ÿä¼šå‘ç°è¯¥é¢˜éœ€è¦ä»æ ‘ä¸Šæ‹¿å‡º $k+1$ æ¡äº’ä¸ç›¸äº¤çš„é“¾ï¼Œæ±‚è¿™äº›é“¾çš„èŠ‚ç‚¹çš„æƒå€¼æ€»å’Œçš„æœ€å¤§å€¼ã€‚é‚£ä¹ˆæˆ‘ä»¬é€‰å‡ºè¿™äº›é“¾åå°±å¯ä»¥ç”¨ $k$ æ¡è¾¹å°†å…¶è¿èµ·æ¥äº†ï¼Œè¿™æ ·å°±æ»¡è¶³äº†é¢˜æ„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ ‘å½¢DP" scheme="http://qiulyblog.github.io/tags/%E6%A0%91%E5%BD%A2DP/"/>
    
      <category term="wqsäºŒåˆ†/å¸¦æƒäºŒåˆ†" scheme="http://qiulyblog.github.io/tags/wqs%E4%BA%8C%E5%88%86-%E5%B8%A6%E6%9D%83%E4%BA%8C%E5%88%86/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [ZJOI2010]åŸºç«™é€‰å€  çº¿æ®µæ ‘ä¼˜åŒ–DP  luoguP2065</title>
    <link href="http://qiulyblog.github.io/2019/05/09/%5B%E9%A2%98%E8%A7%A3%5DluoguP2605/"/>
    <id>http://qiulyblog.github.io/2019/05/09/[é¢˜è§£]luoguP2605/</id>
    <published>2019-05-08T16:00:00.000Z</published>
    <updated>2019-05-09T14:43:08.149Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é¢˜å±…ç„¶åªæœ‰ $luogu$ æœ‰â€¦â€¦æ— æ³•æ°´å¤šå€ç»éªŒäº†ï¼ˆé€ƒã€‚</p><p>æœ´ç´ çš„ $\rm{DP}$ å¾ˆç®€å•ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºå‰ $i$ ä¸ªæ‘åº„å»ºäº† $j$ ä¸ªåŸºç«™çš„èŠ±è´¹æœ€å°å€¼ï¼Œæ³¨æ„å› ä¸ºæ˜¯<strong>å‰ $i$ ä¸ª</strong>ï¼Œæ‰€æœ‰å®Œå…¨æ— è§†æ‰åé¢çš„æ‰€æœ‰æ‘åº„äº†ã€‚è½¬ç§»çš„è¯ç›´æ¥æšä¸¾ä¸€ä¸ª $k$ ï¼Œä» $f_{k,j-1}$ è½¬ç§»è¿‡æ¥å³å¯ï¼ŒåŠ ä¸Šçš„ä»£ä»·å°±æ˜¯ä¸­é—´æ‘åº„äº§ç”Ÿçš„è¡¥å¿è´¹ç”¨ã€‚</p><a id="more"></a><p>é‚£ä¹ˆè¿™æ ·çš„å¤æ‚åº¦å°±æ˜¯ $O(n^2k)$ [<del>çˆ†ç‚¸</del>] ï¼Œæˆ‘ä»¬éœ€è¦åšåˆ°çš„å°±æ˜¯å¦‚ä½•å¿«é€Ÿè®¡ç®—ä¸­é—´æ‘åº„çš„è¡¥å¿ï¼Œé‚£ä¹ˆå¤–å›´çš„ $\rm{DP}$ å¤æ‚åº¦å…¶å®æ˜¯ $O(nk)$ çš„ï¼Œå¦‚æœä¸­é—´çš„è¡¥å¿å¯ä»¥å¿«é€Ÿç®—å‡ºé‚£ä¹ˆå°±å¯ä»¥è¿‡æ‰äº†ã€‚</p><p>æˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªæ‘åº„ $i$ ï¼Œç”¨äºŒåˆ†è®¡ç®—å‡ºæœ€å·¦è¾¹å¯ä»¥è¦†ç›–åˆ°å…¶çš„æ‘åº„ $st_i$ å’Œæœ€å³è¾¹å¯ä»¥è¦†ç›–åˆ°å…¶çš„æ‘åº„ $ed_i$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä» $i$ åˆ° $i+1$ çš„æ—¶å€™ï¼Œæ‰€æœ‰ $ed$ å€¼ä¸º $i$ çš„ç‚¹éƒ½å°†å¤±å»å³è¾¹çš„ä¾é ï¼Œè¿™ä¸ªæ—¶å€™å¯¹äº $i+1$ çš„æœ€ä¼˜è½¬ç§»ç‚¹ $k$ ï¼Œæœ‰å¯¹äºä¸€ä¸ªå¤±å»â€å³è¾¹ä¾é â€çš„æ‘åº„ $j$ ï¼Œå¦‚æœ $k$ çš„èŒƒå›´åœ¨ $[1,st_j-1]$ ä¹‹é—´çš„è¯é‚£ä¹ˆå°±è¦ç»™ $j$ è¡¥å¿äº†ã€‚</p><p>äºæ˜¯æˆ‘ä»¬è€ƒè™‘ç”¨çº¿æ®µæ ‘ä¼˜åŒ–ï¼Œå¯¹äºè¿™æ ·ä¸€ä¸ªæ‘åº„ $j$ ï¼Œæˆ‘ä»¬åœ¨ $[1,st_j-1]$ åŒºé—´é›†ä½“åŠ ä¸Š $w_j$ ï¼Œè¡¨ç¤ºå†³ç­–ç‚¹å¦‚æœè½åœ¨é‚£ä¸ªåŒºé—´å°±è¦å¤šä»˜å‡º $w_j$ çš„è´¹ç”¨ã€‚</p><p>çº¿æ®µæ ‘çš„æ¯ä¸ªä½ç½®ç»´æŠ¤çš„å°±æ˜¯ $f_k+$ $i$ å’Œ $k$ ä¸­é—´æ‘åº„çš„è¡¥å¿è´¹ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬æ¯ä¸€æ¬¡çš„ç­”æ¡ˆå°±æ˜¯æ•´ä¸ªåŒºé—´çš„ $\min$ å€¼äº†ï¼Œåªæ˜¯éšç€ $i$ çš„å˜åŒ–çº¿æ®µæ ‘ç»´æŠ¤çš„å€¼ä¹Ÿåº”å½“åšå‡ºå˜åŒ–ï¼Œæ‰€ä»¥å°±ä¼šå‘ä¸Šé¢é‚£æ ·æ›´æ–°ã€‚</p><p>ä¸è¿‡æœ‰ä¸ªé—®é¢˜ï¼Œæœ‰ä¸ªæƒ…å†µæ²¡æœ‰è€ƒè™‘é“ï¼šç¬¬ $n$ ä¸ªæ‘åº„ä¸å»ºåŸºç«™çš„æƒ…å†µï¼Œå¯¹äºä¸€ä¸ªå°äº $n$ çš„ $i$ ï¼Œ$f_i$ ç®¡ä¸äº† $n$ ï¼Œé‚£ä¹ˆ $f_n$ ä¹Ÿä»…ä»…è¡¨ç¤º $n$ å»ºç«™çš„æƒ…å†µã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ $n+1$ çš„ä½ç½®ä¸Šå»ºä¸€ä¸ªè¾…åŠ©åŸºç«™ï¼Œå½“ç„¶ $c_{n+1}=0$ ï¼Œè¿™æ ·å­å°±å¾ˆå¥½è®¡ç®— <q>ç¬¬ $n$ ä¸ªæ‘åº„ä¸å»ºç«™æ—¶å…¨å±€çš„èŠ±è´¹äº†</q> ã€‚</p><h3 id="Codeï¼š"><a href="#Codeï¼š" class="headerlink" title="Codeï¼š"></a>Codeï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e4</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K=<span class="number">1e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[N],cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">link</span>&#123;</span><span class="keyword">int</span> nxt,to;&#125; G[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;G[++cnt]=(link)&#123;head[u],v&#125;;head[u]=cnt;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,k,d[N],c[N],s[N],w[N],f[N],st[N],ed[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Segment_Tree &#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> mid ((l+r)&gt;&gt;1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> ls(x) ((x)&lt;&lt;1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> rs(x) ((x)&lt;&lt;1|1)</span></span><br><span class="line">    <span class="keyword">int</span> val[N&lt;&lt;<span class="number">2</span>],tag[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        val[ls(x)]+=tag[x],tag[ls(x)]+=tag[x];</span><br><span class="line">        val[rs(x)]+=tag[x],tag[rs(x)]+=tag[x];</span><br><span class="line">        tag[x]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        tag[x]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(l==r) &#123;val[x]=f[l];<span class="keyword">return</span>;&#125;</span><br><span class="line">        build(ls(x),l,mid),build(rs(x),mid+<span class="number">1</span>,r);</span><br><span class="line">        val[x]=min(val[ls(x)],val[rs(x)]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(L==l&amp;&amp;r==R) &#123;val[x]+=v,tag[x]+=v;<span class="keyword">return</span>;&#125;</span><br><span class="line">        <span class="keyword">if</span>(tag[x]) pushdown(x,l,r);</span><br><span class="line">        <span class="keyword">if</span>(R&lt;=mid) change(ls(x),l,mid,L,R,v);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(L&gt;mid) change(rs(x),mid+<span class="number">1</span>,r,L,R,v);</span><br><span class="line">        <span class="keyword">else</span> change(ls(x),l,mid,L,mid,v),change(rs(x),mid+<span class="number">1</span>,r,mid+<span class="number">1</span>,R,v);</span><br><span class="line">        val[x]=min(val[ls(x)],val[rs(x)]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> L,<span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(L==l&amp;&amp;r==R) <span class="keyword">return</span> val[x];</span><br><span class="line">        <span class="keyword">if</span>(tag[x]) pushdown(x,l,r);</span><br><span class="line">        <span class="keyword">if</span>(R&lt;=mid) <span class="keyword">return</span> query(ls(x),l,mid,L,R);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(L&gt;mid) <span class="keyword">return</span> query(rs(x),mid+<span class="number">1</span>,r,L,R);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> min(query(ls(x),l,mid,L,mid),query(rs(x),mid+<span class="number">1</span>,r,mid+<span class="number">1</span>,R));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> Segment_Tree;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) IN(d[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(c[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(s[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(w[i]);</span><br><span class="line">    ++n;w[n]=d[n]=inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        st[i]=lower_bound(d+<span class="number">1</span>,d+<span class="number">1</span>+n,d[i]-s[i])-d;</span><br><span class="line">        ed[i]=lower_bound(d+<span class="number">1</span>,d+<span class="number">1</span>+n,d[i]+s[i])-d;</span><br><span class="line">        <span class="keyword">if</span>(d[ed[i]]&gt;d[i]+s[i]) ed[i]--;add(ed[i],i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans=inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=k;++i)</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j) &#123;</span><br><span class="line">                f[j]=res+c[j];</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> e=head[j];e;e=G[e].nxt)</span><br><span class="line">                    res+=w[G[e].to];</span><br><span class="line">            &#125;ans=f[n];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            build(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j) &#123;</span><br><span class="line">                f[j]=(j&gt;i<span class="number">-1</span>?query(<span class="number">1</span>,<span class="number">1</span>,n,i<span class="number">-1</span>,j<span class="number">-1</span>):<span class="number">0</span>)+c[j];</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> e=head[j],v;e;e=G[e].nxt)</span><br><span class="line">                    <span class="keyword">if</span>(st[v=G[e].to]&gt;<span class="number">1</span>) change(<span class="number">1</span>,<span class="number">1</span>,n,<span class="number">1</span>,st[v]<span class="number">-1</span>,w[v]); </span><br><span class="line">            &#125;ans=min(ans,f[n]);</span><br><span class="line">       &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™é¢˜å±…ç„¶åªæœ‰ $luogu$ æœ‰â€¦â€¦æ— æ³•æ°´å¤šå€ç»éªŒäº†ï¼ˆé€ƒã€‚&lt;/p&gt;
&lt;p&gt;æœ´ç´ çš„ $\rm{DP}$ å¾ˆç®€å•ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºå‰ $i$ ä¸ªæ‘åº„å»ºäº† $j$ ä¸ªåŸºç«™çš„èŠ±è´¹æœ€å°å€¼ï¼Œæ³¨æ„å› ä¸ºæ˜¯&lt;strong&gt;å‰ $i$ ä¸ª&lt;/strong&gt;ï¼Œæ‰€æœ‰å®Œå…¨æ— è§†æ‰åé¢çš„æ‰€æœ‰æ‘åº„äº†ã€‚è½¬ç§»çš„è¯ç›´æ¥æšä¸¾ä¸€ä¸ª $k$ ï¼Œä» $f_{k,j-1}$ è½¬ç§»è¿‡æ¥å³å¯ï¼ŒåŠ ä¸Šçš„ä»£ä»·å°±æ˜¯ä¸­é—´æ‘åº„äº§ç”Ÿçš„è¡¥å¿è´¹ç”¨ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çº¿æ®µæ ‘" scheme="http://qiulyblog.github.io/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ æœ€é•¿ä¸Šå‡å­åºåˆ—  çŠ¶å‹DP  bzoj3591</title>
    <link href="http://qiulyblog.github.io/2019/05/08/%5B%E9%A2%98%E8%A7%A3%5Dbzoj3591/"/>
    <id>http://qiulyblog.github.io/2019/05/08/[é¢˜è§£]bzoj3591/</id>
    <published>2019-05-07T16:00:00.000Z</published>
    <updated>2019-05-08T08:09:02.467Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é¢˜è„‘æ´å¾ˆå¤§â€”â€”ä½ éœ€è¦çŠ¶å‹ $\rm{LTS}$ æ•°ç»„ï¼Œè€Œä¸”æ˜¯ä¸‰è¿›åˆ¶çŠ¶å‹ã€‚å¤æ‚åº¦å¾ˆé«˜â€¦â€¦å¤§çº¦æ˜¯ $O(n3^n)$ å·¦å³ï¼Œå½“ç„¶å®é™…å¤æ‚åº¦ä¼šå°äºè¿™ä¸ªï¼Œ$1000^+ms$ æ˜¯å¯ä»¥é€šè¿‡çš„ã€‚</p><p>å¯¹äºæ¯ä¸€ä¸ªæ•°å­—ï¼Œåˆ†åˆ«è®°å½•å…¶ä¸‰ç§çŠ¶æ€ï¼šè¯¥æ•°å­—æ²¡æœ‰è¿›è¿‡ $\rm{LTS}$ æ•°ç»„è®°ä¸º $0$ ï¼Œè¯¥æ•°å­—åœ¨ $\rm{LTS}$ æ•°ç»„ä¸­è®°ä¸º $1$ ï¼Œè¯¥æ•°å­—è¿›è¿‡ $\rm{LTS}$ æ•°ç»„ï¼Œç»“æœåˆå‡ºæ¥äº†è®°ä¸º $2$ ã€‚</p><a id="more"></a><p>è®¾ $f_i$ è¡¨ç¤º $1$ åˆ° $n$ æ‰€æœ‰æ•°å­—çš„çŠ¶æ€ä¸º $i$ æ—¶çš„æ–¹æ¡ˆæ•°ï¼Œæ¥ä¸‹æ¥è€ƒè™‘è½¬ç§»ï¼Œé¦–å…ˆå¯¹äºè¿™ä¸ª $i$ çŠ¶æ€æˆ‘ä»¬è¿˜åŸå…¶ $\rm{LTS}$ æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯å½“å‰ä½ç½®ä¸Šä¸º $1$ çš„é‚£äº›æ•°å­—ã€‚æ¥ç€æˆ‘ä»¬æšä¸¾æ‰€æœ‰ä½ç½®ä¸Šä¸º $0$ çš„æ•°å­—ï¼Œå¹¶è€ƒè™‘å°†å…¶æ’å…¥å½“å‰çš„ $\rm{LTS}$ å½“ä¸­ã€‚æ›¿æ¢æ‰ä¸€ä¸ªçŠ¶æ€ä¸º $1$ çš„æ•°ã€‚</p><p>æˆ‘ä»¬å°±é€‰å®šè¿™ä¸ªè¦è¢«æ›¿æ¢çš„çŠ¶æ€ä¸º $1$ çš„æ•°ä¸ºå½“å‰ $\rm{LTS}$ ä¸­ç¬¬ä¸€ä¸ªå¤§äºå½“å‰è¦åŠ å…¥çš„æ•°çš„æ•°ï¼Œé‚£ä¹ˆè¿™æ ·æ›¿æ¢å $\rm{LTS}$ ä¾ç„¶æ»¡è¶³å…¶æ€§è´¨ã€‚</p><p>ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆæ‰«ä¸€éå°±å¥½ï¼Œç¢°åˆ°éœ€è¦æ¢çš„æ•°å°±å°†å…¶æ ‡è®°ä¸º $2$ ï¼Œç„¶åå°†å½“å‰éœ€è¦åŠ å…¥çš„æ•°å˜æˆ $1$ å³å¯ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œçš„â€åŠ å…¥â€å¹¶ä¸æ˜¯åªçš„åœ¨åŸæ•°ç»„ä¸­åŠ å…¥ï¼Œä¹Ÿå°±æ˜¯è¯´è·Ÿæ’åˆ—ä»€ä¹ˆçš„å‡ ä¹æ‰¯ä¸ä¸Šå…³ç³»ï¼Œæ¯”å¦‚è¯´å½“å‰åºåˆ—ä¸º $1,2,3,4,5$ ï¼Œ$\rm{LTS}$ æ•°ç»„ä¸º $1,3,4$ ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå°† $3$ ä¸¢æ‰ï¼Œç„¶ååŠ å…¥ $2$ ï¼Œå…¶å®æ˜¯ä¸å˜çš„ã€‚</p><p>å½“æ‰€æœ‰æ•°å­—éƒ½è¢«è€ƒè™‘è¿‡çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ç»Ÿè®¡ç­”æ¡ˆäº†ï¼Œæ™®é€šçš„ $\rm{LTS}$ ä¹Ÿæ˜¯æ‰€æœ‰æ•°å­—éƒ½è¦è€ƒè™‘ä¸€å›çš„ã€‚</p><p>åœ¨åš $\rm{DP}$ è½¬ç§»çš„æ—¶å€™æˆ‘ä»¬é¡ºå¸¦æ»¡è¶³ä¸€ä¸‹é¢˜é¢ç»™å‡ºçš„é‚£äº›æ•°çš„é€’å¢å³å¯ï¼Œé‚£ä¹ˆå¯ä»¥ä¿è¯æ‰€æœ‰è¢«ç»Ÿè®¡çš„çŠ¶æ€éƒ½å¸¦æœ‰é¢˜é¢è¦æ±‚çš„ $\rm{LTS}$ ã€‚</p><h3 id="Codeï¼š"><a href="#Codeï¼š" class="headerlink" title="Codeï¼š"></a>Codeï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,ans,arr[N],pos[N],mul[N];</span><br><span class="line"><span class="keyword">int</span> hep[N],var[N],dp[<span class="number">14348907</span>+<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"3591.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"3591.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</span><br><span class="line">    IN(n),IN(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i) </span><br><span class="line">        IN(arr[i]),--arr[i],pos[arr[i]]=i;</span><br><span class="line">    mul[<span class="number">0</span>]=dp[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) mul[i]=mul[i<span class="number">-1</span>]*<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;mul[n];++i) <span class="keyword">if</span>(dp[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> state=i,top=<span class="number">0</span>,num=<span class="number">0</span>,per=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;++j) &#123;</span><br><span class="line">            var[j]=state%<span class="number">3</span>,state/=<span class="number">3</span>;</span><br><span class="line">            <span class="keyword">if</span>(var[j]) ++num;</span><br><span class="line">            <span class="keyword">if</span>(var[j]==<span class="number">1</span>) hep[top++]=j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num==n) &#123;ans+=dp[i];<span class="keyword">continue</span>;&#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;++j) &#123;</span><br><span class="line">            <span class="keyword">if</span>(var[j]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(pos[j]&amp;&amp;!var[arr[pos[j]<span class="number">-1</span>]]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">while</span>(hep[per]&lt;j&amp;&amp;per&lt;top) ++per;</span><br><span class="line">            <span class="keyword">if</span>(per&gt;=m) <span class="keyword">continue</span>;</span><br><span class="line">            state=i+mul[j];</span><br><span class="line">            <span class="keyword">if</span>(per&lt;top) state+=mul[hep[per]];</span><br><span class="line">            dp[state]+=dp[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™é¢˜è„‘æ´å¾ˆå¤§â€”â€”ä½ éœ€è¦çŠ¶å‹ $\rm{LTS}$ æ•°ç»„ï¼Œè€Œä¸”æ˜¯ä¸‰è¿›åˆ¶çŠ¶å‹ã€‚å¤æ‚åº¦å¾ˆé«˜â€¦â€¦å¤§çº¦æ˜¯ $O(n3^n)$ å·¦å³ï¼Œå½“ç„¶å®é™…å¤æ‚åº¦ä¼šå°äºè¿™ä¸ªï¼Œ$1000^+ms$ æ˜¯å¯ä»¥é€šè¿‡çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸€ä¸ªæ•°å­—ï¼Œåˆ†åˆ«è®°å½•å…¶ä¸‰ç§çŠ¶æ€ï¼šè¯¥æ•°å­—æ²¡æœ‰è¿›è¿‡ $\rm{LTS}$ æ•°ç»„è®°ä¸º $0$ ï¼Œè¯¥æ•°å­—åœ¨ $\rm{LTS}$ æ•°ç»„ä¸­è®°ä¸º $1$ ï¼Œè¯¥æ•°å­—è¿›è¿‡ $\rm{LTS}$ æ•°ç»„ï¼Œç»“æœåˆå‡ºæ¥äº†è®°ä¸º $2$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çŠ¶å‹DP" scheme="http://qiulyblog.github.io/tags/%E7%8A%B6%E5%8E%8BDP/"/>
    
  </entry>
  
  <entry>
    <title>DPè¿›é˜¶å¿…åˆ·é¢˜å•</title>
    <link href="http://qiulyblog.github.io/2019/05/07/DP%E8%BF%9B%E9%98%B6%E5%BF%85%E5%88%B7%E9%A2%98%E5%8D%95/"/>
    <id>http://qiulyblog.github.io/2019/05/07/DPè¿›é˜¶å¿…åˆ·é¢˜å•/</id>
    <published>2019-05-06T16:00:00.000Z</published>
    <updated>2019-05-12T07:42:19.466Z</updated>
    
    <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="åœ¨æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡" />    <label for="pass">åœ¨æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡ä¸ºåŠ å¯†æ–‡ç« ï¼Œé˜…è¯»æœ¬æ–‡éœ€è¦è¾“å…¥å¯†ç ã€‚
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜å•" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E5%8D%95/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2009]åŒé€’å¢åºåˆ—  çº¿æ€§DP  luoguP4728</title>
    <link href="http://qiulyblog.github.io/2019/05/07/%5B%E9%A2%98%E8%A7%A3%5DluoguP4728/"/>
    <id>http://qiulyblog.github.io/2019/05/07/[é¢˜è§£]luoguP4728/</id>
    <published>2019-05-06T16:00:00.000Z</published>
    <updated>2019-05-07T02:42:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®è¿™é¢˜å¾ˆå®¹æ˜“è®¾å‡ºå››ç»´çš„ $\rm{DP}$ ï¼Œä¹Ÿå°±æ˜¯ç”¨ $dp_{i,j,x,y}$ è¡¨ç¤º<strong>ç¬¬ä¸€ä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $i$ ä¸”é•¿åº¦ä¸º $x$ï¼Œç¬¬äºŒä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $j$ ä¸”é•¿åº¦ä¸º $y$ æ˜¯å¦æˆç«‹</strong> ï¼Œç„¶åä¹Ÿå¾ˆå®¹æ˜“æƒ³åˆ°é™ç»´ï¼Œæšä¸¾å½“å‰åºåˆ—é•¿åº¦ $len$ çš„æ—¶å€™çŸ¥é“äº† $x$ å°±å·²ç»çŸ¥é“ $y$ äº†â€”â€” $y$ å°±æ˜¯ $len-x$ ã€‚ä¹Ÿå°±æ˜¯è¯´ç°åœ¨çš„ $DP$ æ˜¯ $O(n^3)$ çš„ï¼Œè¿˜éœ€è¦ä¼˜åŒ–ã€‚</p><a id="more"></a><p>è€ƒè™‘è®¾ $dp_{i,j}$ è¡¨ç¤ºç¬¬ä¸€ä¸ªåºåˆ—çš„æœ€ç»ˆä½ç½®ä¸º $i-1$ ä¸”é•¿åº¦ä¸º $j$ æ—¶ç¬¬äºŒä¸ªåºåˆ—çš„æœ€ç»ˆä½ç½®çš„æœ€å°å€¼ã€‚æšä¸¾å½“å‰æ•°å­— $i$ ï¼Œç„¶ååˆ†ä¸¤ç§æƒ…å†µè¿›è¡Œè½¬ç§»â€”â€”å°† $a_i$ æ”¾åˆ°ç¬¬ä¸€ä¸ªåºåˆ—æœ«å°¾ $\texttt{and}$ å°† $a_i$ æ”¾åˆ°ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾ã€‚</p><p>æ”¾åˆ°ç¬¬ä¸€ä¸ªåºåˆ—æœ«å°¾å¾ˆå¥½æƒ³ï¼šå› ä¸ºå½“å‰ç¬¬ä¸€ä¸ªåºåˆ—çš„ç»“å°¾å¤„å°±æ˜¯ $a_{i-1}$ ï¼Œæ¯”è¾ƒä¸€ä¸‹å¤§å°ç›´æ¥è½¬ç§»å°±å¥½äº†ï¼š</p><script type="math/tex; mode=display">dp_{i,j}=min(dp_{i,j},dp_{i-1,j-1}) \ \ \ (a_i>a_{i-1})</script><p>å› ä¸ºç¬¬äºŒä¸ªåºåˆ—çš„æœ«å°¾æ²¡å˜ï¼Œæ‰€æœ‰ç›´æ¥è½¬ç§»å°±å¥½ã€‚</p><p>æ¥ä¸‹æ¥è€ƒè™‘å°†ç¬¬ $i$ ä¸ªæ•°æ”¾åˆ°ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾çš„æƒ…å†µï¼Œå…¶å®ç¬¬ä¸€ä¸ªåºåˆ—å’Œç¬¬äºŒä¸ªåºåˆ—æ²¡åŒºåˆ«ï¼Œå½“ç„¶é™¤äº†åå­—ä¸Šæœ‰ä¸€ä¸ªå­—çš„å·®å¼‚ï¼Œå‡è®¾ç¬¬ $i-1$ ä¸ªæ•°æ˜¯ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾ï¼Œå½“å‰ç¬¬ä¸€ä¸ªåºåˆ—çš„é•¿åº¦ä¸º $j-1$ ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªåºåˆ—çš„é•¿åº¦å› è¯¥å°±æ˜¯ $(i-1)-(j-1)$ äº†ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾äº†ç¬¬ $i-1$ ä¸ªæ•°æ˜¯ç¬¬äºŒä¸ªåºåˆ—æœ«å°¾ï¼Œé‚£ä¹ˆ $dp_{i-1,i-j}$ åˆå¯ä»¥è¢«è§£é‡Šä¸º<strong>ç¬¬äºŒä¸ªåºåˆ—çš„æœ«å°¾ä¸º $i-1$ ä¸ªæ•°ä¸”ç¬¬äºŒä¸ªåºåˆ—çš„é•¿åº¦ä¸º $i-j$ çš„æ—¶å€™ç¬¬ä¸€ä¸ªåºåˆ—çš„æœ«å°¾çš„æœ€å°å€¼</strong> ï¼Œå¦‚æœè¿™ä¸ªæœ€å°å€¼å°äº $a_i$ ï¼Œè¯´æ˜ $a_i$ å¯ä»¥æ¥åˆ°ç¬¬ä¸€ä¸ªåºåˆ—å‰é¢ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¬¬äºŒä¸ªåºåˆ—çš„æœ«å°¾ä¸º $a_{i-1}$ ï¼Œæ˜¾ç„¶åˆæœ‰è½¬ç§»ï¼š</p><script type="math/tex; mode=display">dp_{i,j}=min(dp_{i,j},a_{i-1}) \ \ \ (a_i>dp_{i-1,i-j})</script><p>å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬å°† $dp$ æ•°ç»„èµ‹æˆæå¤§å€¼ï¼Œç„¶åæœ€ååˆ¤æ–­ä¸€ä¸‹ $dp_{n,n/2}$ è¿™ä¸ªçŠ¶æ€å˜å°æ²¡æœ‰å°±å¥½ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e3</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N],f[N][N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;IN(n);</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    a[<span class="number">0</span>]=f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        f[i][<span class="number">0</span>]=a[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i&amp;&amp;j&lt;=n/<span class="number">2</span>;++j) &#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i]&gt;a[i<span class="number">-1</span>]) f[i][j]=min(f[i][j],f[i<span class="number">-1</span>][j<span class="number">-1</span>]);</span><br><span class="line">            <span class="keyword">if</span>(a[i]&gt;f[i<span class="number">-1</span>][i-j]) f[i][j]=min(f[i][j],a[i<span class="number">-1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">return</span> f[n][n/<span class="number">2</span>]&lt;<span class="number">0x3f3f3f3f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;IN(T);</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">puts</span>(solve()?<span class="string">"Yes!"</span>:<span class="string">"No!"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰è¿™é“é¢˜çš„ç¡®å¾ˆç»•â€¦â€¦=ã€‚=</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®è¿™é¢˜å¾ˆå®¹æ˜“è®¾å‡ºå››ç»´çš„ $\rm{DP}$ ï¼Œä¹Ÿå°±æ˜¯ç”¨ $dp_{i,j,x,y}$ è¡¨ç¤º&lt;strong&gt;ç¬¬ä¸€ä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $i$ ä¸”é•¿åº¦ä¸º $x$ï¼Œç¬¬äºŒä¸ªåºåˆ—çš„ç»ˆæ­¢ä½ç½®ä¸º $j$ ä¸”é•¿åº¦ä¸º $y$ æ˜¯å¦æˆç«‹&lt;/strong&gt; ï¼Œç„¶åä¹Ÿå¾ˆå®¹æ˜“æƒ³åˆ°é™ç»´ï¼Œæšä¸¾å½“å‰åºåˆ—é•¿åº¦ $len$ çš„æ—¶å€™çŸ¥é“äº† $x$ å°±å·²ç»çŸ¥é“ $y$ äº†â€”â€” $y$ å°±æ˜¯ $len-x$ ã€‚ä¹Ÿå°±æ˜¯è¯´ç°åœ¨çš„ $DP$ æ˜¯ $O(n^3)$ çš„ï¼Œè¿˜éœ€è¦ä¼˜åŒ–ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HEOI2013]SAO  ç»„åˆæ•°å­¦+æ ‘å½¢DP  luoguP4099</title>
    <link href="http://qiulyblog.github.io/2019/05/06/%5B%E9%A2%98%E8%A7%A3%5DluoguP4099/"/>
    <id>http://qiulyblog.github.io/2019/05/06/[é¢˜è§£]luoguP4099/</id>
    <published>2019-05-05T16:00:00.000Z</published>
    <updated>2019-05-06T10:07:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>$loj$ ä¸Šæ²¡æœ‰æ­¤é¢˜ï¼Œ$bzoj$ ä¸Šæ˜¯æƒé™é¢˜ï¼Œå¯¹äºä¸ä¸Š $yzoj$ çš„æˆ‘æ¥è¯´åªèƒ½å»æ´›è°·åšé¢˜äº†ï¼š<a href="https://www.luogu.org/problemnew/show/P4099" target="_blank" rel="noopener">è½¬é€é—¨ğŸ˜„</a> ã€‚</p><p>æˆ‘ä»¬å…ˆä¸è€ƒè™‘è¾¹çš„æƒå€¼(&lt;ä¸&gt;)ï¼Œè¿™æ ·å­ $n-1$ æ¡è¾¹ç»„æˆçš„å°±æ˜¯æ ‘äº†ï¼Œå¾ˆæ˜¾ç„¶æ˜¯éœ€è¦æˆ‘ä»¬æ±‚å‡ºè¿™æ£µæ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„ä¸ªæ•°ï¼Œè€ƒè™‘ä½¿ç”¨ $\rm{DP}$ ï¼Œå¯¹äºè¾¹çš„æ–¹å‘(å³&lt;,&gt;) ï¼Œæˆ‘ä»¬åˆ†ç±»è®¨è®ºå³å¯ã€‚</p><p>é¦–å…ˆçš„ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è®¾ $f_u$ è¡¨ç¤ºç‚¹ $u$ çš„å­æ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„æ€»æ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å¦‚ä½•è®¡ç®—å‘¢<a id="more"></a>ï¼Œå¯¹äºä¸€ä¸ª $u$ çš„å„¿å­ $v$ ï¼Œæˆ‘ä»¬è™½ç„¶çŸ¥é“ $u$ å’Œ $v$ çš„æ”»å…‹çš„å‰åå…³ç³»ï¼Œä½†æ˜¯åˆå¹¶ç­”æ¡ˆè²Œä¼¼å¹¶ä¸å¥½åˆå¹¶ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¢åŠ ä¸€ç»´ $j$ ï¼Œ$f_{u,j}$ è¡¨ç¤º $u$ çš„å­æ ‘çš„æ‰€æœ‰åˆæ³•æ‹“æ‰‘åºä¸­ $u$ åœ¨ç¬¬ $j$ ä½ä¸Šçš„æ€»çŠ¶æ€æ•°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ªå¿…é¡»åœ¨ $u$ å‰é¢æ”»å…‹çš„å…³å¡ $v$ ï¼Œæˆ‘ä»¬è€ƒè™‘æšä¸¾ä¸€ä¸ª $j$ ï¼Œ$v$ å­æ ‘ä¸­ $j$ ä¸ªç»“ç‚¹åœ¨åˆå¹¶ $u,v$ åæ”¾åˆ° $u$ å‰é¢ï¼Œå¦å¤– $sz_v-j$ ä¸ªæ”¾åˆ° $u$ åé¢ï¼Œç„¶åæšä¸¾ä¸€ä¸ª $k$ ï¼Œè¡¨ç¤ºå½“å‰çš„ $v$ æ’åœ¨ $v$ å­æ ‘çš„æ‹“æ‰‘åºä¸­çš„ç¬¬ $k$ ä½ï¼Œåªæœ‰ $k\leq j$ çš„æ—¶å€™ $v$ æ‰å¯ä»¥è½¬ç§» $u$ ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ $v$ åœ¨ $u$ å‰é¢ã€‚</p><p>ç°åœ¨å†æ¥è€ƒè™‘$â€œ$ $j$ ä¸ªç»“ç‚¹æ”¾åœ¨ $u$ å‰é¢ $â€$ çš„æ–¹æ¡ˆæ•°å’Œ$â€œ$ $sz_v-j$ ä¸ªç»“ç‚¹æ”¾åœ¨ $u$ åé¢çš„æ–¹æ¡ˆæ•°$â€$ï¼Œè¿™ä¸ªæ˜¾ç„¶å¯ä»¥ç”¨ç»„åˆæ•°ç®—ï¼Œåˆå¹¶ $v$ çš„å­æ ‘åï¼Œ$u$ çš„æ’åä» $i$ å˜æˆäº† $i+j$ ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦å°† $j$ ä¸ªä¹±åºæ’å…¥åˆ° $u$ å‰é¢ $i+j-1$ ä¸ªæ•°ä¸­ï¼Œæ–¹æ¡ˆæ•°æ˜¾ç„¶ä¸º $C_{i+j-1}^{j}$ ï¼Œé‚£ä¹ˆç°åœ¨æ€»èŠ‚ç‚¹æ•°æ˜¾ç„¶ä¸º $sz_u+sz_v$ (ç°åœ¨ $sz_u$ å’Œ $sz_v$ è¿˜æ²¡æœ‰å¹¶åœ¨ä¸€èµ·) ï¼Œ$u$ åé¢ç†æ‰€å½“ç„¶æœ‰ $sz_u+sz_v-i-j$ ä¸ªä½ç½®ï¼Œå°† $sz_v-j$ ä¸ªæ•°æ’è¿›å»çš„æ–¹æ¡ˆæ•°æ˜¾ç„¶ä¸º $C_{sz_u+sz_v-i-j}^{sz_v-j}$ ä¸ªï¼Œè¿™ä¸¤ä¸ªæ•°å†ä¹˜ä¸Š $f_{u,i}$ å’Œ $f_{v,k}$ å°±å¥½äº†ï¼Œè¿™ä¸€æ¬¡åˆå¹¶å $u$ çš„ä½ç½®æ˜¾ç„¶åˆ°äº† $i+j$ ï¼Œæ‰€ä»¥ $f_{u,i+j}$ æ˜¾ç„¶è¦åŠ ä¸Šè¿™ä¸€ç»„è´¡çŒ®ã€‚</p><p>ç»æ•´ç†åçš„è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">pls(f_{u,i+j},f_{u,i}\cdot f_{v,k}\cdot C_{i+j-1}^{j}\cdot C_{sz_u+sz_v-i-j}^{sz_v-j})</script><p>ä»£ç å°±æ˜¯è¿™æ ·å†™ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i=<span class="number">1</span> to sz[u]</span><br><span class="line">    <span class="keyword">for</span> j=<span class="number">1</span> to sz[v]</span><br><span class="line">        <span class="keyword">for</span> k=<span class="number">1</span> to j</span><br><span class="line">            pls(f[u][i+j],f[u][i]*f[v][k]*C[i+j<span class="number">-1</span>][j]*C[sz[u]+sz[v]-i-j][sz[v]-j])</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ $n^3$ çš„ï¼Œè¿‡ä¸å»ã€‚è€ƒè™‘å‰ç¼€å’Œä¼˜åŒ–ï¼Œå‡ ä¸‹ $f_v$ çš„å‰ç¼€å’Œï¼Œæœ€åçš„ä¸€å±‚å¾ªç¯å°±å¯ä»¥ç›´æ¥ä¸¢æ‰äº†ã€‚</p><p>è¿™ä¸ªå°±æ˜¯ $v$ è¦åœ¨ $u$ å‰é¢çš„æƒ…å†µï¼Œ$u$ åœ¨ $v$ å‰é¢çš„æƒ…å†µå’Œè¿™ä¸ªå·®ä¸å¤šï¼Œä¸è¿‡è½¬ç§»çš„æ—¶å€™ $j$ å°±è¦ä» $0$ å¼€å§‹äº†ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™ $u$ å‰é¢æ˜¯å¯ä»¥ä¸å¤šæ”¾ä»»ä½•ä¸œè¥¿çš„ï¼Œè¿˜æœ‰å°±æ˜¯ $u$ åœ¨ $v$ å‰é¢çš„æ—¶å€™æ³¨æ„ $k\geq j$ æ—¶æ‰å¯ä»¥è½¬ç§» !</p><p>æœ€åçš„ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{i=1}^{n} f_{1,i}$ å•¦ã€‚</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e3</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[N],cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to,val;&#125;G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> C[N][N],f[N][N],pre[N][N],suf[N][N],sz[N],g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[u],v,w&#125;,head[u]=cnt;</span><br><span class="line">    G[++cnt]=(Edge)&#123;head[v],u,w^<span class="number">1</span>&#125;,head[v]=cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(<span class="keyword">int</span>&amp;x,<span class="keyword">int</span> y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;=mod)x-=mod;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sz[u]=f[u][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l=head[u];l;l=G[l].nxt) &#123;</span><br><span class="line">        <span class="keyword">int</span> v=G[l].to,w=G[l].val;</span><br><span class="line">        <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(v,u);</span><br><span class="line">        <span class="built_in">memset</span>(g,<span class="number">0</span>,<span class="keyword">sizeof</span>(g));</span><br><span class="line">        <span class="keyword">if</span>(w) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=sz[v];++j)</span><br><span class="line">                    pls(g[i+j],<span class="number">1l</span>l*f[u][i]*pre[v][j]%mod*C[i+j<span class="number">-1</span>][j]%mod</span><br><span class="line">                    *C[sz[u]+sz[v]-i-j][sz[v]-j]%mod);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=sz[v];++j)</span><br><span class="line">                    pls(g[i+j],<span class="number">1l</span>l*f[u][i]*suf[v][j+<span class="number">1</span>]%mod*C[i+j<span class="number">-1</span>][j]%mod</span><br><span class="line">                    *C[sz[u]+sz[v]-i-j][sz[v]-j]%mod);</span><br><span class="line">        &#125;</span><br><span class="line">        sz[u]+=sz[v];</span><br><span class="line">        <span class="built_in">memcpy</span>(f[u],g,<span class="keyword">sizeof</span>(g));</span><br><span class="line">    &#125;</span><br><span class="line">    pre[u][<span class="number">0</span>]=suf[u][sz[u]+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sz[u];++i) pre[u][i]=(pre[u][i<span class="number">-1</span>]+f[u][i])%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=sz[u];i&gt;=<span class="number">1</span>;--i) suf[u][i]=(suf[u][i+<span class="number">1</span>]+f[u][i])%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head)),cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">int</span> n;IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> u,v;<span class="keyword">char</span> sign;</span><br><span class="line">        IN(u),sign=getchar(),IN(v);</span><br><span class="line">        add(u+<span class="number">1</span>,v+<span class="number">1</span>,sign==<span class="string">'&lt;'</span>?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) pls(ans,f[<span class="number">1</span>][i]);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*é¢„å¤„ç†ç»„åˆæ•°*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=N<span class="number">-2</span>;++i) C[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N<span class="number">-2</span>;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=N<span class="number">-2</span>;++j)</span><br><span class="line">            C[i][j]=(C[i<span class="number">-1</span>][j]+C[i<span class="number">-1</span>][j<span class="number">-1</span>])%mod;</span><br><span class="line">    <span class="keyword">int</span> T;IN(T);</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solve());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯èƒ½æœ‰äººä¼šé—®ï¼Œå¦‚æœ $u$ çš„å„¿å­ $v$ ä¸‹é¢çš„è¾¹å…¨éƒ½æ˜¯ $&gt;$ ï¼Œå¹¶ä¸” $u$ è¿å‘ $v$ çš„è¾¹ä¹Ÿæ˜¯ $&gt;$ ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ $v$ ä»¥åŠå…¶å­æ ‘çš„æ‰€æœ‰ç‚¹éƒ½å¿…é¡»åœ¨ $u$ å‰é¢å®Œæˆï¼Œåœ¨è½¬ç§»çš„æ—¶å€™ä¸ºä»€ä¹ˆå¯ä»¥ $â€œ$ æå‡º $j$ ä¸ªç»“ç‚¹æ”¾åˆ° $u$ å‰é¢ $â€$ å‘¢ï¼Ÿ</p><p>å…¶å®æƒ³æƒ³å°±å¯ä»¥æ˜ç™½ï¼Œåœ¨å‘ä¸Šç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™å¯¹äºä¸€ä¸ª $v$ çš„å„¿å­ $a$ ï¼Œæˆ‘ä»¬åªç»Ÿè®¡äº†åˆå¹¶å $a$ åœ¨ $v$ å‰é¢çš„æƒ…å†µï¼ŒåŒæ ·åœ¨ $u$ ç»Ÿè®¡ $v$ æ—¶ä¹Ÿåªæ˜¯ç»Ÿè®¡äº†åˆå¹¶å $v$ åœ¨ $u$ å‰é¢çš„æƒ…å†µï¼Œæ‰€æœ‰æˆ‘ä»¬ä¹Ÿåªæ˜¯ç»Ÿè®¡äº† $â€œ$ $a$ åœ¨ $v$ å‰é¢ä¸” $v$ åœ¨ $u$ å‰é¢ $â€$ çš„æƒ…å†µï¼Œæ‰€æœ‰è¢«ç»Ÿè®¡çš„æƒ…å†µä¸€å®šæ˜¯åˆæ³•çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;$loj$ ä¸Šæ²¡æœ‰æ­¤é¢˜ï¼Œ$bzoj$ ä¸Šæ˜¯æƒé™é¢˜ï¼Œå¯¹äºä¸ä¸Š $yzoj$ çš„æˆ‘æ¥è¯´åªèƒ½å»æ´›è°·åšé¢˜äº†ï¼š&lt;a href=&quot;https://www.luogu.org/problemnew/show/P4099&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è½¬é€é—¨ğŸ˜„&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä¸è€ƒè™‘è¾¹çš„æƒå€¼(&amp;lt;ä¸&amp;gt;)ï¼Œè¿™æ ·å­ $n-1$ æ¡è¾¹ç»„æˆçš„å°±æ˜¯æ ‘äº†ï¼Œå¾ˆæ˜¾ç„¶æ˜¯éœ€è¦æˆ‘ä»¬æ±‚å‡ºè¿™æ£µæ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„ä¸ªæ•°ï¼Œè€ƒè™‘ä½¿ç”¨ $\rm{DP}$ ï¼Œå¯¹äºè¾¹çš„æ–¹å‘(å³&amp;lt;,&amp;gt;) ï¼Œæˆ‘ä»¬åˆ†ç±»è®¨è®ºå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆçš„ä¸€ä¸ªæƒ³æ³•å°±æ˜¯è®¾ $f_u$ è¡¨ç¤ºç‚¹ $u$ çš„å­æ ‘çš„åˆæ³•æ‹“æ‰‘åºçš„æ€»æ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™å¦‚ä½•è®¡ç®—å‘¢&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ç»„åˆæ•°å­¦" scheme="http://qiulyblog.github.io/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"/>
    
      <category term="æ ‘å½¢DP" scheme="http://qiulyblog.github.io/tags/%E6%A0%91%E5%BD%A2DP/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘  [HAOI2018]è‹¹æœæ ‘  ç»„åˆæ•°å­¦  loj2526</title>
    <link href="http://qiulyblog.github.io/2019/05/05/%5B%E9%A2%98%E8%A7%A3%5Dloj2526/"/>
    <id>http://qiulyblog.github.io/2019/05/05/[é¢˜è§£]loj2526/</id>
    <published>2019-05-04T16:00:00.000Z</published>
    <updated>2019-05-06T05:23:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰è¶£çš„é¢˜ç›®ï¼Œå¯çˆ±çš„ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2526" target="_blank" rel="noopener">æˆ³è¿™å‘¢=ï¿£Ï‰ï¿£=</a></p><p>åˆšå¼€å§‹å¾€æ¦‚ç‡ $\rm{DP}$ æƒ³äº†ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç‚¹çš„æ¦‚ç‡æ˜¯å¥½ç®—ï¼Œä½†æ˜¯å¦‚æœæ±‚è´¡çŒ®çš„è¯å°±ä¼šå¾ˆéš¾åŠã€‚æœ€åä¸‡èˆ¬æ— èµ–çš„ç‚¹å¼€äº†é¢˜è§£ï¼Œå‘ç°å±…ç„¶æ˜¯â€¦â€¦ç»„åˆæ•°å­¦ï¼Ÿå…¶å®å’Œ $\rm{DP}$ æ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ $i$ ï¼Œæˆ‘ä»¬æšä¸¾å…¶å­æ ‘å¤§å° $j$ ã€‚ç°åœ¨è€ƒè™‘æœ€ç»ˆæœ‰å¤šå°‘ç§åˆæ³•çš„æƒ…å†µå¯ä»¥ä½¿å¾— $i$ çš„å­æ ‘å¤§å°æ°å¥½ä¸º $j$ ã€‚</p><a id="more"></a><p>æ˜“çŸ¥èŠ‚ç‚¹æ•°ä¸º $n$ çš„äºŒå‰æ ‘çš„æ€»å½¢æ€æ•°ä¸º $n!$ ï¼Œè€Œä¸” $i$ å­æ ‘ä¸‹çš„æ‰€æœ‰èŠ‚ç‚¹çš„ç¼–å·ä¸€å®šè¦å¤§äº $i$ ï¼Œæˆ‘ä»¬è€ƒè™‘â€å…ˆå°† $i$ å­æ ‘æ„é€ å‡ºæ¥å†å¡«å…¥èŠ‚ç‚¹â€çš„è¿‡ç¨‹ï¼Œå­æ ‘çš„å½¢æ€æ•°æ˜¾ç„¶ä¸º $j!$ ï¼Œç„¶åæˆ‘ä»¬åªèƒ½é€‰å‰©ä¸‹çš„ $n-i$ ä¸ªèŠ‚ç‚¹(ç¼–å·è¦æ¯” $i$ å¤§) ï¼Œå¡«å…¥å‰©ä¸‹çš„ $j-1$ ä¸ªä½ç½®( $i$ å äº†ä¸€ä¸ªä½ç½®) ï¼Œæ˜¾ç„¶è¿™æ ·çš„æ–¹æ¡ˆæ•°ä¸º $C_{n-i}^{j-1}$ ã€‚</p><p>è¿™æ ·çš„ä¸€ä¸ª $i$ ï¼Œå…¶å­æ ‘å¤§å°ä¸º $j$ ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥åšå‡ºå¤šå°‘è´¡çŒ®å‘¢ï¼Ÿè€ƒè™‘ $fa_i \Rightarrow i$ è¿™æ¡è¾¹ä¼šç»è¿‡å¤šå°‘æ¬¡ï¼Œæ˜¾ç„¶æ˜¯ $j\cdot(n-j)$ æ¬¡( $j$ ä¸ºå­æ ‘èŠ‚ç‚¹ä¸ªæ•°ï¼Œ$n-j$ ä¸ºä¸Šé¢çš„èŠ‚ç‚¹ä¸ªæ•°) ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ ·çš„æ–¹æ¡ˆå¯ä»¥é€ æˆ $j\cdot (n-j)$ çš„è´¡çŒ®ã€‚</p><p>é‚£ä¹ˆç°åœ¨ $i$ çš„å­æ ‘å¾—åˆ°ç¡®å®šäº†ï¼Œæˆ‘ä»¬å°† $i$ ä»¥åŠå…¶å­æ ‘çœ‹åšä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬è€ƒè™‘ $1$ åˆ° $i$ è¿™äº›èŠ‚ç‚¹ï¼Œå®ƒä»¬å¯ä»¥ä»¥ä»»æ„å½¢æ€ç»„æˆä¸€æ£µæ ‘ï¼Œæ–¹æ¡ˆæ•°æ˜¯ $i!$ ã€‚</p><p>æ¥ç€æˆ‘ä»¬éœ€è¦å°†å‰©ä¸‹çš„ $n-j-(i-1)$ ä¸ªèŠ‚ç‚¹æŒ‚åˆ°æ ‘ä¸Šå»ã€‚å¯¹äºç¬¬ $i$ ä¸ªæŒ‚åˆ°æ ‘ä¸Šçš„ç‚¹ï¼Œå®ƒæœ‰ $i$ ä¸ªä½ç½®å¯ä»¥æŒ‚ã€‚ä½†æ˜¯å› ä¸º $i$ ä¸€å®šè¦å ä¸€ä¸ªä½ç½®ï¼Œæ‰€ä»¥è¿™ä¸ªèŠ‚ç‚¹åªæœ‰ $i-1$ ä¸ªä½ç½®å¯ä»¥æŒ‚äº†ï¼Œç¬¬äºŒä¸ªå¤šå‡ºæ¥çš„èŠ‚ç‚¹å°±æœ‰ $i$ ä¸ªä½ç½®å¯ä»¥æŒ‚â€¦â€¦ç¬¬ $k$ ä¸ªæ˜¾ç„¶æœ‰ $i-2+k$ ä¸ªä½ç½®å¯ä»¥æŒ‚ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™äº›ç‚¹æŒ‚ä¸Šå»çš„æ€»æ–¹æ¡ˆæ•°ä¸º $\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)$ ã€‚</p><p>å°†ä¸Šé¢çš„ä¹˜èµ·æ¥å°±æ˜¯è¿™ä¸€ç»„ $i,j$ å¯¹ç­”æ¡ˆé€ æˆçš„è´¡çŒ®äº†ï¼š</p><script type="math/tex; mode=display">j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i!\cdot\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)</script><p>$\prod\limits_{k=1}^{n-j-(i-1)} (i-2+k)$ æ¯”è¾ƒä¸å¥½è®¡ç®—ï¼Œä½†æ˜¯ç®€å•çš„å˜åŒ–åå‘ç°è¿™ä¸ªæ˜¯å’Œ $(n-j-1)!/(i-2)!$ ç­‰ä»·çš„ï¼Œæˆ‘ä»¬å¸¦è¿›åŸå¼å­ã€‚</p><script type="math/tex; mode=display">j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i!\cdot(n-j-1)!/(i-2)!\\\\=j!\cdot C_{n-i}^{j-1}\cdot j\cdot (n-j)\cdot i\cdot (i-1)\cdot(n-j-1)!\\\\=j!\cdot C_{n-i}^{j-1}\cdot j\cdot i\cdot (i-1)\cdot (n-j)!</script><p>è¿™æ ·å°±å¾ˆå¥½ç®—äº†ï¼Œæˆ‘ä»¬é¢„å¤„ç†ç»„åˆæ•°å’Œé˜¶ä¹˜ï¼Œä¸Šé¢çš„å¼å­ $O(1)$ ç®—~</p><p>ä»£ç å¾ˆçŸ­ã€‚</p><h3 id="Codeï¼š"><a href="#Codeï¼š" class="headerlink" title="Codeï¼š"></a>Codeï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">2e3</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,p,ans,fac[N],C[N][N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(<span class="keyword">int</span>&amp;x,<span class="keyword">int</span> y)</span> </span>&#123;x+=y;x%=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(p);</span><br><span class="line">    fac[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) fac[i]=<span class="number">1l</span>l*fac[i<span class="number">-1</span>]*i%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;++i) C[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i;++j)</span><br><span class="line">            C[i][j]=(C[i<span class="number">-1</span>][j]+C[i<span class="number">-1</span>][j<span class="number">-1</span>])%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n-i+<span class="number">1</span>;++j)</span><br><span class="line">            pls(ans,(ll)fac[j]*fac[n-j]%p*C[n-i][j<span class="number">-1</span>]%p*(i*(i<span class="number">-1</span>))%p*j%p);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ‰è¶£çš„é¢˜ç›®ï¼Œå¯çˆ±çš„ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2526&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ³è¿™å‘¢=ï¿£Ï‰ï¿£=&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹å¾€æ¦‚ç‡ $\rm{DP}$ æƒ³äº†ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç‚¹çš„æ¦‚ç‡æ˜¯å¥½ç®—ï¼Œä½†æ˜¯å¦‚æœæ±‚è´¡çŒ®çš„è¯å°±ä¼šå¾ˆéš¾åŠã€‚æœ€åä¸‡èˆ¬æ— èµ–çš„ç‚¹å¼€äº†é¢˜è§£ï¼Œå‘ç°å±…ç„¶æ˜¯â€¦â€¦ç»„åˆæ•°å­¦ï¼Ÿå…¶å®å’Œ $\rm{DP}$ æ²¡æœ‰åŠæ¯›é’±å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ $i$ ï¼Œæˆ‘ä»¬æšä¸¾å…¶å­æ ‘å¤§å° $j$ ã€‚ç°åœ¨è€ƒè™‘æœ€ç»ˆæœ‰å¤šå°‘ç§åˆæ³•çš„æƒ…å†µå¯ä»¥ä½¿å¾— $i$ çš„å­æ ‘å¤§å°æ°å¥½ä¸º $j$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="ç»„åˆæ•°å­¦" scheme="http://qiulyblog.github.io/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [å…­çœè”è€ƒ2017]åˆ†æ‰‹æ˜¯ç¥æ„¿  æ¦‚ç‡DP  loj2145</title>
    <link href="http://qiulyblog.github.io/2019/05/05/%5B%E9%A2%98%E8%A7%A3%5Dloj2145/"/>
    <id>http://qiulyblog.github.io/2019/05/05/[é¢˜è§£]loj2145/</id>
    <published>2019-05-04T16:00:00.000Z</published>
    <updated>2019-05-05T02:43:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ¦‚ç‡ç¥ä»™é¢˜çš„ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2145" target="_blank" rel="noopener"><del>åˆ«æˆ³åäº†</del></a></p><p>è®¾ $f_i$ è¡¨ç¤ºè¿˜å‰©ä¸‹ $i$ ç›ç¯äº®åˆ°è¿˜å‰©ä¸‹ $i-1$ ç›ç¯äº®çš„æœŸæœ›æ“ä½œæ¬¡æ•°ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ $\frac{i}{n}$ çš„æ¦‚ç‡æŒ‰ä¸­äº®çš„ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‰ä¸­äº®çš„çš„è¯å°±åªèƒ½é€€åˆ° $f_{i+1}$ ã€‚ä¸éš¾åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_i=\frac{i}{n}+(1-\frac{i}{n})\cdot (1+f_i+f_{i+1})</script><p>å› ä¸ºè½¬ç§»å¼ä¸­æœ‰ä¸ª $f_i$ ï¼Œæœ‰äº›ä¸å¥½åŠâ€¦â€¦æ¨ä¸€æ¨å¼å­åº·åº·ã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=\frac{i}{n}+1\cdot (1+f_i+f_{i+1})-\frac{i}{n}\cdot (1+f_i+f_{i+1})\\\\f_i=\frac{i}{n}+1+f_i+f_{i+1}-\frac{i}{n}-\frac{i}{n}f_i-\frac{i}{n}f_{i+1}\\\\f_i=1+f_i+f_{i+1}-\frac{i}{n}f_i-\frac{i}{n}f_{i+1}\\\\\frac{i}{n}f_i=1+f_{i+1}-\frac{i}{n}f_{i+1}\\\\f_i=\frac{1+f_{i+1}-\frac{i}{n}f_{i+1}}{\frac{i}{n}}\\\\f_i=\frac{n\cdot(1+f_{i+1})-i\cdot f_{i+1}}{i}\\\\f_i=\frac{n+(n-i)\cdot f_{i+1}}{i}\\\\f_i=1+\frac{(n-i)\cdot (f_{i+1}+1)}{i}</script><p>é¢„å¤„ç†é€†å…ƒå°±å¯ä»¥ç›´æ¥è®¡ç®—äº†ï¼Œè®°å¾—æœ€åä¹˜ä¸Š $n!$ ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p=<span class="number">100003</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,k,step,a[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans,f[N],inv[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(k);</span><br><span class="line">    inv[<span class="number">0</span>]=<span class="number">0</span>,inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) inv[i]=(<span class="keyword">long</span> <span class="keyword">long</span>)(p-p/i)*inv[p%i]%p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;=n;j+=i) g[j].push_back(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;--i) <span class="keyword">if</span>(a[i]) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;g[i].size();++j) a[g[i][j]]^=<span class="number">1</span>;</span><br><span class="line">        ++step;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(step&lt;=k) ans=step;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        f[n]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;<span class="number">1</span>;--i) f[i]=(<span class="number">1l</span>l+(<span class="number">1l</span>l*n-i)*(f[i+<span class="number">1</span>]+<span class="number">1</span>)*inv[i])%p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=step;i&gt;k;--i) ans=(ans+f[i])%p;</span><br><span class="line">        ans=(ans+k)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans=(<span class="number">1l</span>l*i*ans)%p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¦‚ç‡ç¥ä»™é¢˜çš„ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2145&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;del&gt;åˆ«æˆ³åäº†&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºè¿˜å‰©ä¸‹ $i$ ç›ç¯äº®åˆ°è¿˜å‰©ä¸‹ $i-1$ ç›ç¯äº®çš„æœŸæœ›æ“ä½œæ¬¡æ•°ï¼Œè¿™ä¸ªæ—¶å€™æœ‰ $\frac{i}{n}$ çš„æ¦‚ç‡æŒ‰ä¸­äº®çš„ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‰ä¸­äº®çš„çš„è¯å°±åªèƒ½é€€åˆ° $f_{i+1}$ ã€‚ä¸éš¾åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\frac{i}{n}+(1-\frac{i}{n})\cdot (1+f_i+f_{i+1})&lt;/script&gt;&lt;p&gt;å› ä¸ºè½¬ç§»å¼ä¸­æœ‰ä¸ª $f_i$ ï¼Œæœ‰äº›ä¸å¥½åŠâ€¦â€¦æ¨ä¸€æ¨å¼å­åº·åº·ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SCOI2014]æ–¹ä¼¯ä¼¯çš„ç‰ç±³ç”°  æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–DP  luoguP3287</title>
    <link href="http://qiulyblog.github.io/2019/05/04/%5B%E9%A2%98%E8%A7%A3%5DluoguP3287/"/>
    <id>http://qiulyblog.github.io/2019/05/04/[é¢˜è§£]luoguP3287/</id>
    <published>2019-05-03T16:00:00.000Z</published>
    <updated>2019-05-05T02:25:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥åä¸è¦è¢«è¿™ç§å‚»é€¼é¢˜ç»™è’™éª—äº†ã€‚ä¼ é€é—¨ï¼š<a href="https://www.luogu.org/problemnew/show/P3287" target="_blank" rel="noopener">æ–¹ä¼¯ä¼¯çš„ä¼ é€é—¨=ã€‚=</a></p><p>é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼Œæ¯ä¸€æ¬¡æ‹”é«˜çš„å³ç«¯ç‚¹ä¸€å®šæ˜¯ $n$ ï¼Œå¦‚æœæ˜¯åªæ‹”é«˜ä¸­é—´éƒ¨åˆ†ï¼Œå³è¾¹çš„åˆè¦å°½å¯èƒ½å¤§äºä¸­é—´éƒ¨åˆ†ï¼Œç´¢æ€§ä¸€èµ·æ‹”äº†ï¼Œè¿™ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚</p><p>è®¾ $f_{i,j}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªç‰ç±³è¢«æ‹”é«˜äº† $j$ æ¬¡æ—¶ä»¥ $i$ ç»“å°¾çš„æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é•¿åº¦ï¼Œå®¹æ˜“å¾—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><a id="more"></a><script type="math/tex; mode=display">f_{i,j}=\max\{f_{k,l}+1\} \ \ (k<i,l\leq j,h_i+j\geq h_k+l)</script><p>å¯èƒ½æœ‰äººä¼šé—®ä¸ºä»€ä¹ˆ $l\leq j$ ï¼Œå¾ˆæ˜¾ç„¶å°±æ˜¯ä¸Šé¢çš„é“ç†ï¼Œè¶Šå¤§çš„ $i$ ä¸€å®šæ‹”é«˜æ¬¡æ•°æ˜¯å•è°ƒä¸å‡çš„ã€‚</p><p>å‘ç°ä¸Šé¢çš„è½¬ç§»å…¶å®æ˜¯ $O(n^2k^2)$ çš„ï¼Œä¸‡æ¶çš„å‡ºé¢˜äººä¸ä¼šç»™è¿™ä¸ªå¤æ‚åº¦ä¸€ä¸ç‚¹åˆ†â€¦â€¦è¿™ä¸ªæ—¶å€™ç”¨æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–è½¬ç§»ï¼Œå‘ç°ä¸Šé¢æœ‰ä¸‰ä¸ªé™åˆ¶æ¡ä»¶ï¼Œæˆ‘ä»¬æ­£ç€æšä¸¾ $i$ ï¼Œå°±å·²ç»æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶äº†ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™æ ‘çŠ¶æ•°ç»„ä¸­çš„éƒ½æ˜¯å°äº $i$ çš„ $k$ ã€‚ç„¶åå°†æ¯ä¸ªç‚¹æŒ‰ç…§ $(j+1,h_i+j)$ æ”¾åˆ°å¹³é¢ä¸Šï¼Œç„¶åæ ‘çŠ¶æ•°ç»„ç»Ÿè®¡ç­”æ¡ˆå³å¯ã€‚</p><p>æ ‘çŠ¶æ•°ç»„ç»´æŠ¤çš„æ˜¯ $\max$  ï¼Œä¸æ˜¯å’Œã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e4</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> K=<span class="number">5e2</span>+<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[N],n,k,mx;</span><br><span class="line"><span class="keyword">namespace</span> BIT&#123;</span><br><span class="line">    <span class="keyword">int</span> c[N][<span class="number">5009</span>+K];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">const</span> <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(;x&lt;=mx+k;x+=(x&amp;-x))<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i&lt;=k+<span class="number">1</span>;i+=(i&amp;-i))</span><br><span class="line">                c[x][i]=max(c[x][i],v); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(;x;x-=(x&amp;-x))<span class="keyword">for</span>(<span class="keyword">int</span> i=y;i;i-=(i&amp;-i))</span><br><span class="line">                ans=max(ans,c[x][i]);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> BIT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]),mx=max(mx,a[i]);</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)   </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=k;~j;--j) &#123;</span><br><span class="line">            <span class="keyword">int</span> res=query(a[i]+j,j+<span class="number">1</span>)+<span class="number">1</span>;</span><br><span class="line">            ans=max(ans,res),update(a[i]+j,j+<span class="number">1</span>,res);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»¥åä¸è¦è¢«è¿™ç§å‚»é€¼é¢˜ç»™è’™éª—äº†ã€‚ä¼ é€é—¨ï¼š&lt;a href=&quot;https://www.luogu.org/problemnew/show/P3287&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ–¹ä¼¯ä¼¯çš„ä¼ é€é—¨=ã€‚=&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªé“ç†ï¼Œæ¯ä¸€æ¬¡æ‹”é«˜çš„å³ç«¯ç‚¹ä¸€å®šæ˜¯ $n$ ï¼Œå¦‚æœæ˜¯åªæ‹”é«˜ä¸­é—´éƒ¨åˆ†ï¼Œå³è¾¹çš„åˆè¦å°½å¯èƒ½å¤§äºä¸­é—´éƒ¨åˆ†ï¼Œç´¢æ€§ä¸€èµ·æ‹”äº†ï¼Œè¿™ä¸€å®šæ˜¯æœ€ä¼˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f_{i,j}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªç‰ç±³è¢«æ‹”é«˜äº† $j$ æ¬¡æ—¶ä»¥ $i$ ç»“å°¾çš„æœ€é•¿ä¸ä¸‹é™å­åºåˆ—é•¿åº¦ï¼Œå®¹æ˜“å¾—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ ‘çŠ¶æ•°ç»„" scheme="http://qiulyblog.github.io/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
      <category term="äºŒç»´æ ‘çŠ¶æ•°ç»„" scheme="http://qiulyblog.github.io/tags/%E4%BA%8C%E7%BB%B4%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SHOI2014]æ¦‚ç‡å……ç”µå™¨  æ¦‚ç‡DP  loj2192</title>
    <link href="http://qiulyblog.github.io/2019/05/02/%5B%E9%A2%98%E8%A7%A3%5Dloj2192/"/>
    <id>http://qiulyblog.github.io/2019/05/02/[é¢˜è§£]loj2192/</id>
    <published>2019-05-01T16:00:00.000Z</published>
    <updated>2019-05-05T02:07:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¼ é€é—¨åœ¨è¿™ï¼š<a href="https://loj.ac/problem/2192" target="_blank" rel="noopener">æˆ‘æ˜¯ä¼ é€é—¨$QwQ$</a></p><p>å…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦ç®—çš„å°±æ˜¯ $\sum a_i$ (å…¶ä¸­ $a_i$ ä¸ºç‚¹ $i$ çš„é€šç”µæ¦‚ç‡) ã€‚æˆ‘ä»¬éœ€è¦ç®—å‡ºæ¯ä¸ªç‚¹çš„é€šç”µæ¦‚ç‡å³å¯ã€‚å› ä¸ºæœ‰äº›ç‚¹å¯ä»¥è‡ªå·±å‘ç”µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è€ƒè™‘çˆ¶äº²å’Œå„¿å­çš„é€šç”µæƒ…å†µã€‚</p><p>å› ä¸ºç›´æ¥è®¾é€šç”µæ¦‚ç‡æœ‰äº›æ£˜æ‰‹ï¼Œæˆ‘ä»¬è®¾ $f_i$ è¡¨ç¤ºç‚¹ $i$ çš„å„¿å­æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç®—ï¼Œæˆ‘ä»¬é¡ºå¸¦ç®—ä¸Šç‚¹ $i$ è‡ªå·±å‘ç”µçš„æ¦‚ç‡ã€‚</p><a id="more"></a><p>æšä¸¾æ¯ä¸€ä¸ªå„¿å­ï¼Œå¯¹äºè¿™ä¸ªå„¿å­åªæœ‰ä¸¤ç§æƒ…å†µï¼šè¯¥å„¿å­æ²¡æœ‰é€šä¸Šç”µï¼Œè¯¥å„¿å­é€šä¸Šç”µäº†ä¸”ä¼ é€å¤±è´¥ã€‚ä¸¤ç§æƒ…å†µçš„æ¦‚ç‡éƒ½å¾ˆå¥½ç®—ã€‚æˆ‘ä»¬å¯ä»¥åˆ—å‡ºè½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">f_u=(1-q_u)\cdot \prod (f_v+(1-f_v)\cdot(1-G_i.p))</script><p>å…¶ä¸­ $(1-q_u)$ æ˜¾ç„¶ä¸ºè¯¥ç‚¹æœ¬èº«ä¸é€šç”µçš„æ¦‚ç‡ï¼Œç„¶åæšä¸¾å„¿å­ $v$ ï¼Œ$f_v$ å°±æ˜¯è¯¥å„¿å­æœ¬æ¥å°±æ²¡æœ‰é€šä¸Šç”µçš„æ¦‚ç‡ï¼Œ$(1-f_v)\cdot(1-G_i.p)$ å°±æ˜¯é€šä¸Šç”µçš„ä¼ é€å¤±è´¥(æ³¨ï¼š$G_i.p$ æ˜¯å½“å‰è¿æ¥ $u,v$ çš„è¾¹çš„é€šç”µæ¦‚ç‡) ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è®¡ç®—çˆ¶äº²ä¼ æ¥çš„ç”µå‘¢ï¼Ÿè®¾ $g_i$ è¡¨ç¤ºç‚¹ $i$ çš„çˆ¶äº²æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ã€‚è®¡ç®—ä¸€ä¸‹çˆ¶èŠ‚ç‚¹ä¸é€šç”µçš„æ¦‚ç‡ï¼Œæ³¨æ„ä¸è¦è®¡ç®—ä¸Šè¯¥å„¿å­çš„è´¡çŒ®ï¼Œä¸ç„¶ä¼šä¹±ã€‚è®¡ç®—å®Œä¸é€šç”µçš„æ¦‚ç‡ååˆ†ä¸Šé¢ä¸¤ç§æƒ…å†µè®¨è®ºå³å¯ã€‚</p><script type="math/tex; mode=display">res=g_u\cdot f_v / (f_v+(1-f_v)\cdot(1-G_i.p))\\\\g_v=res+(1-res)\cdot(1-G_i.p)</script><p>ä¸¤è¾¹ $dfs$ å°±å¯ä»¥æå®šã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e5</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> ans,f[N],g[N],q[N];</span><br><span class="line"><span class="keyword">int</span> head[N],cnt,n,tot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span><span class="keyword">int</span> nxt,to;<span class="keyword">double</span> p;&#125;G[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">double</span> p)</span> </span>&#123;G[++cnt]=(Edge)&#123;head[x],y,p&#125;,head[x]=cnt;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[u]=<span class="number">1</span>-q[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u],v;i;i=G[i].nxt) </span><br><span class="line">        <span class="keyword">if</span>((v=G[i].to)!=fa)</span><br><span class="line">            dfs1(v,u),f[u]*=(f[v]+(<span class="number">1</span>-f[v])*(<span class="number">1</span>-G[i].p));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u],v;i;i=G[i].nxt) </span><br><span class="line">        <span class="keyword">if</span>((v=G[i].to)!=fa) &#123;</span><br><span class="line">            <span class="keyword">double</span> res=g[u]*f[u]/(f[v]+(<span class="number">1</span>-f[v])*(<span class="number">1</span>-G[i].p));</span><br><span class="line">            g[v]=res+(<span class="number">1</span>-res)*(<span class="number">1</span>-G[i].p);dfs2(v,u);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y,p;IN(x),IN(y),IN(p);</span><br><span class="line">        add(x,y,p/<span class="number">100.0</span>),add(y,x,p/<span class="number">100.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,x;i&lt;=n;++i) IN(x),q[i]=x/<span class="number">100.0</span>;</span><br><span class="line">    dfs1(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    g[<span class="number">1</span>]=<span class="number">1.0</span>,dfs2(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans+=<span class="number">1</span>-f[i]*g[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.6f\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¼ é€é—¨åœ¨è¿™ï¼š&lt;a href=&quot;https://loj.ac/problem/2192&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ‘æ˜¯ä¼ é€é—¨$QwQ$&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬éœ€è¦ç®—çš„å°±æ˜¯ $\sum a_i$ (å…¶ä¸­ $a_i$ ä¸ºç‚¹ $i$ çš„é€šç”µæ¦‚ç‡) ã€‚æˆ‘ä»¬éœ€è¦ç®—å‡ºæ¯ä¸ªç‚¹çš„é€šç”µæ¦‚ç‡å³å¯ã€‚å› ä¸ºæœ‰äº›ç‚¹å¯ä»¥è‡ªå·±å‘ç”µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è€ƒè™‘çˆ¶äº²å’Œå„¿å­çš„é€šç”µæƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºç›´æ¥è®¾é€šç”µæ¦‚ç‡æœ‰äº›æ£˜æ‰‹ï¼Œæˆ‘ä»¬è®¾ $f_i$ è¡¨ç¤ºç‚¹ $i$ çš„å„¿å­æ²¡æœ‰å‘ç‚¹ $i$ é€šç”µçš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¯”è¾ƒå¥½ç®—ï¼Œæˆ‘ä»¬é¡ºå¸¦ç®—ä¸Šç‚¹ $i$ è‡ªå·±å‘ç”µçš„æ¦‚ç‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2015]å¯¿å¸æ™šå®´  çŠ¶å‹DP  loj2131</title>
    <link href="http://qiulyblog.github.io/2019/05/01/%5B%E9%A2%98%E8%A7%A3%5Dloj2131/"/>
    <id>http://qiulyblog.github.io/2019/05/01/[é¢˜è§£]loj2131/</id>
    <published>2019-04-30T16:00:00.000Z</published>
    <updated>2019-05-05T01:22:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆï¼Œä¸¤ä¸ªæ•°ä¸äº’è´¨åŒç†äºä¸¤ä¸ªæ•°çš„è´¨å› å­é›†åˆæ²¡æœ‰äº¤é›†ã€‚è€ƒè™‘ä¸€ä¸‹ $n\leq 30$ çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°è¿™é‡Œé¢çš„è´¨æ•°ä¹Ÿåªæœ‰ $10$ ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ¯ä¸€ä¸ªå¯¿å¸åˆ†è§£è´¨å› æ•°ï¼Œç„¶åå°†è´¨å› å­å‹æˆä¸€ä¸ªçŠ¶æ€ã€‚</p><p>è®¾ $f[s1][s2]$ è¡¨ç¤ºå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œå° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™æšä¸¾å¯¿å¸ï¼Œåˆ†åˆ«åˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦èƒ½åƒç„¶åè½¬ç§»å³å¯ã€‚</p><a id="more"></a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mul=<span class="number">1024</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n,s[N];ll p,f[<span class="number">2</span>][mul][mul];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(ll&amp;x,ll&amp;y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;p)x-=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("1.in","r",stdin);</span></span><br><span class="line">    <span class="comment">// freopen("1.out","w",stdout);</span></span><br><span class="line">    IN(n),IN(p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">10</span>;++j)</span><br><span class="line">            <span class="keyword">if</span>(!(i%pri[j])) s[i]|=<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>);</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> now=i&amp;<span class="number">1</span>,lst=!now;</span><br><span class="line">        <span class="built_in">memcpy</span>(f[now],f[lst],<span class="keyword">sizeof</span>(f[lst]));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;mul;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;mul;++s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!f[lst][s1][s2]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;s[i])) pls(f[now][s1|s[i]][s2],f[lst][s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;s[i])) pls(f[now][s1][s2|s[i]],f[lst][s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;mul;++s1)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;mul;++s2) pls(ans,f[n&amp;<span class="number">1</span>][s1][s2]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>å¯ä»¥çŸ¥é“ $n\leq 500$ çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªæ•°æœ€å¤šå¸¦ä¸Šä¸€ä¸ªå¤§äºç­‰äº $23$ çš„è´¨å› å­ã€‚æˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰çš„å¯¿å¸åˆ†ä¸ºä¸¤ç±»ï¼šå¸¦äº†å¤§äºç­‰äº $23$ çš„è´¨å› å­çš„å’Œæ²¡å¸¦çš„ã€‚</p><p>æ²¡å¸¦çš„æ˜¾ç„¶å¯ä»¥å‘ä¸Šé¢é‚£æ ·è½¬ç§»ã€‚é‚£ä¹ˆå¸¦äº†çš„å‘¢ï¼Ÿè¿™ä¸ªæ˜¾ç„¶ä¸èƒ½å‹ç¼©å§ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘å°†å¸¦äº†åŒæ ·çš„å¤§äºç­‰äº $23$ çš„è´¨å› å­çš„åˆ†æˆä¸€ç»„ï¼Œè¿™ä¸€ç»„è¦ä¸å° $\rm{G}$ åƒå° $\rm{W}$ ä¸åƒï¼Œè¦ä¸å° $\rm{W}$ åƒå° $G$ ä¸åƒã€‚åˆ†åˆ«è®¨è®ºå³å¯ã€‚</p><p>è®¾ $f1[s1][s2]$ è¡¨ç¤ºè¿™ä¸€ç»„æ˜¯å° $\rm{G}$ åƒæ—¶ï¼Œå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œ å° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚åŒç†ï¼Œè®¾ $f2[s1][s2]$ è¡¨ç¤ºè¿™ä¸€ç»„æ˜¯å° $\rm{W}$ åƒæ—¶ï¼Œå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œ å° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚åˆ†åˆ«è½¬ç§»å°±å¥½äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=pos+<span class="number">1</span>;i&lt;=n;++i) &#123; <span class="comment">/*æšä¸¾è¿™äº›å¯¿å¸*/</span></span><br><span class="line">    <span class="keyword">if</span>(a[i].t!=a[i<span class="number">-1</span>].t) <span class="comment">/*å¤§è´¨å› å­ä¸åŒäº†*/</span></span><br><span class="line">        <span class="built_in">memcpy</span>(f1,f,<span class="keyword">sizeof</span>(f)),<span class="built_in">memcpy</span>(f2,f,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">        <span class="comment">/*å€’ç€æšä¸¾æ‰€ä»¥æ²¡ç”¨æ»šåŠ¨æ•°ç»„*/</span></span><br><span class="line">        <span class="comment">/*æ‰€è°“çš„åˆ†åˆ«è½¬ç§»*/</span></span><br><span class="line">        <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f1[s1|a[i].s][s2],f1[s1][s2]);</span><br><span class="line">        <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f2[s1][s2|a[i].s],f2[s1][s2]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¿™ä¸€ç»„ç»“æŸäº†ï¼Œéœ€è¦åˆå¹¶ç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">if</span>(a[i].t!=a[i+<span class="number">1</span>].t||i==n)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2)</span><br><span class="line">            <span class="comment">/*å› ä¸ºf1[s1][s2]å’Œf2[s1][s2]éƒ½é‡å¤ç®—äº†ä¸€éåŸæ¥çš„</span></span><br><span class="line"><span class="comment">            f[s1][s2]ï¼Œæ‰€ä»¥å‡æ‰åå†å–è†œ*/</span></span><br><span class="line">            f[s1][s2]=(f1[s1][s2]+f2[s1][s2]-f[s1][s2]+p)%p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">5e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M=<span class="number">256</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pri[]=&#123;<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>&#125;;</span><br><span class="line">ll p,f[M][M],f1[M][M],f2[M][M];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span><span class="keyword">int</span> t,s;&#125;a[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Node a,Node b)</span> </span>&#123;<span class="keyword">return</span> a.t&lt;b.t;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> OI &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pls</span><span class="params">(ll&amp;x,ll&amp;y)</span> </span>&#123;x+=y;<span class="keyword">if</span>(x&gt;=p)x%=p;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">        <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">using</span> <span class="keyword">namespace</span> OI;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;IN(n),IN(p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        a[i].t=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">8</span>;++j)<span class="keyword">if</span>(!(i%pri[j])) &#123;</span><br><span class="line">            a[i].s|=<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>),a[i].t/=pri[j];</span><br><span class="line">            <span class="keyword">while</span>(!(a[i].t%pri[j])) a[i].t/=pri[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    sort(a+<span class="number">2</span>,a+n+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">int</span> pos=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span>(a[pos].t==<span class="number">1</span>) ++pos;--pos;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=pos;++i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f[s1|a[i].s][s2],f[s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f[s1][s2|a[i].s],f[s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=pos+<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i].t!=a[i<span class="number">-1</span>].t)</span><br><span class="line">            <span class="built_in">memcpy</span>(f1,f,<span class="keyword">sizeof</span>(f)),<span class="built_in">memcpy</span>(f2,f,<span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s1=M<span class="number">-1</span>;~s1;--s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=M<span class="number">-1</span>;~s2;--s2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(s2&amp;a[i].s)) pls(f1[s1|a[i].s][s2],f1[s1][s2]);</span><br><span class="line">            <span class="keyword">if</span>(!(s1&amp;a[i].s)) pls(f2[s1][s2|a[i].s],f2[s1][s2]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a[i].t!=a[i+<span class="number">1</span>].t||i==n)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)<span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2)</span><br><span class="line">                f[s1][s2]=(f1[s1][s2]+f2[s1][s2]-f[s1][s2]+p)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s1=<span class="number">0</span>;s1&lt;M;++s1)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s2=<span class="number">0</span>;s2&lt;M;++s2) pls(ans,f[s1][s2]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(ans+p)%p);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¦–å…ˆï¼Œä¸¤ä¸ªæ•°ä¸äº’è´¨åŒç†äºä¸¤ä¸ªæ•°çš„è´¨å› å­é›†åˆæ²¡æœ‰äº¤é›†ã€‚è€ƒè™‘ä¸€ä¸‹ $n\leq 30$ çš„æƒ…å†µï¼Œå¯ä»¥å‘ç°è¿™é‡Œé¢çš„è´¨æ•°ä¹Ÿåªæœ‰ $10$ ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ¯ä¸€ä¸ªå¯¿å¸åˆ†è§£è´¨å› æ•°ï¼Œç„¶åå°†è´¨å› å­å‹æˆä¸€ä¸ªçŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f[s1][s2]$ è¡¨ç¤ºå° $\rm{G}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s1$ ï¼Œå° $\rm{W}$ åƒäº†çš„å¯¿å¸çš„çŠ¶æ€ä¸º $s2$ æ—¶çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»çš„æ—¶å€™æšä¸¾å¯¿å¸ï¼Œåˆ†åˆ«åˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦èƒ½åƒç„¶åè½¬ç§»å³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çŠ¶æ€å‹ç¼©" scheme="http://qiulyblog.github.io/tags/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [JSOI2016]ç¯å¡”  å†³ç­–å•è°ƒæ€§&amp;DP  loj2074</title>
    <link href="http://qiulyblog.github.io/2019/04/30/%5B%E9%A2%98%E8%A7%A3%5Dloj2047/"/>
    <id>http://qiulyblog.github.io/2019/04/30/[é¢˜è§£]loj2047/</id>
    <published>2019-04-29T16:00:00.000Z</published>
    <updated>2019-05-05T01:22:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®è¿™é“é¢˜æ˜¯ $\rm{POI}$ çš„åŸé¢˜ï¼Œ$loj$ ä¼ é€é—¨é“¾æ¥ï¼š<a href="https://loj.ac/problem/2074" target="_blank" rel="noopener">åœ¨è¿™å‘¢o(ï¿£ï¸¶ï¿£)o</a></p><p>åˆšå¼€å§‹è‚¯å®šè¿˜æ˜¯çœ‹ä¸å‡ºè¿™é¢˜æ˜¯ä»€ä¹ˆ $\rm{DP}$ ï¼Œæ„Ÿè§‰å¾ˆè¯¡å¼‚ï¼Œä½†æ˜¯æ¨ä¸€æ¨è‡ªç„¶å°±å‡ºæ¥äº†ï¼š</p><script type="math/tex; mode=display">h_j \leq h_i+p-\sqrt{|iâˆ’j|}\\\\p\geq h_j-h_i +\sqrt{|iâˆ’j|}\\\\p=\max\{ h_j-h_i +\sqrt{|iâˆ’j|}\}</script><p>è®¾ $f_i$ è¡¨ç¤º $i$ çš„ $p$ å€¼ï¼Œé‚£ä¹ˆç»§ç»­ï¼š</p><a id="more"></a><script type="math/tex; mode=display">f_i=\max\{ h_j +\sqrt{|iâˆ’j|}\}-h_i</script><p>å‘ç°ç»å¯¹å€¼å¾ˆçƒ¦äººï¼Œå°†ç»å¯¹å€¼æ‹†å¼€ã€‚</p><script type="math/tex; mode=display">f_i=\max(\max\limits_{j=1}^{i}\{h_j +\sqrt{iâˆ’j}\},\max\limits_{j=i}^{n}\{h_j +\sqrt{j-i}\})-h_i</script><p>åŸåºåˆ—ç¿»è½¬ä¸€ä¸‹å°±å¯ä»¥ç›´æ¥è®¡ç®—åé¢çš„å¼å­ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦è€ƒè™‘ç¬¬ä¸€ä¸ªï¼š</p><script type="math/tex; mode=display">f_i=\max\limits_{j=1}^{i}\{h_j +\sqrt{iâˆ’j}\}-h_i</script><p>å‡è®¾å¯¹äº $i$ æ¥è¯´ $j$ æ˜¯æœ€ä¼˜çš„å†³ç­–ï¼Œé‚£ä¹ˆå¦‚æœå­˜åœ¨ä¸€ä¸ªå°äº $j$ çš„ $k$ ï¼Œæ˜¯å¦åœ¨è½¬ç§»ä¸€ä¸ªå¤§äº $i$ çš„ $l$ ä¼šæ›´ä¼˜å‘¢ï¼Ÿæ˜¾ç„¶ä¸ä¼šï¼Œå¯ä»¥çŸ¥é“ $i-k$ æ˜¾ç„¶æ˜¯å¤§äº $i-j$ çš„ï¼Œè€Œä¸”æ ¹å·æ˜¯å¢é•¿çš„è¶Šæ¥è¶Šæ…¢çš„ã€‚æ‰€ä»¥å¦‚æœåœ¨ $i$ æ—¶ $k$ å°±æ²¡æœ‰ $j$ ä¼˜äº†ï¼Œé‚£ä¹ˆåœ¨ä»¥åæ‰€ä»¥å¤§äº $i$ çš„ $l$ è½¬ç§»æ—¶ $k$ ä¹Ÿä¸å¯èƒ½æ¯” $j$ ä¼˜ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ä¸Šé¢çš„å¼å­æ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ $O(n\log n)$ æ„‰å¿«æ±‚å‡ºäº†ã€‚</p><p>è¿™é‡Œè¯´æ˜ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ul><li><strong>1.</strong> å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸‰å…ƒç»„ï¼Œä¸‰å…ƒç»„åŒ…å« $v$ (å†³ç­–ç‚¹ $v$) ï¼Œ$l$ (å†³ç­–ç‚¹ $v$ ä½œä¸ºæœ€ä¼˜å†³ç­–ç‚¹çš„æœ€å·¦ç«¯ç‚¹) ï¼Œ$r$ (å†³ç­–ç‚¹ $v$ ä½œä¸ºæœ€ä¼˜å†³ç­–ç‚¹çš„æœ€å³ç«¯ç‚¹) ï¼Œæ¯ä¸€æ¬¡æ’é™¤æ‰æœ€å³ç«¯ç‚¹å°äº $i$ çš„å…ƒç´ (å› ä¸ºè¯¥å…ƒç´ å·²ç»æ²¡ç”¨äº†) ï¼Œæ’å…¥é˜Ÿåˆ—çš„æ—¶å€™å»æ‰å®Œå…¨åŠ£äº $i$ çš„ï¼Œç„¶åå¯¹äºæŠ˜ä¸­çš„äºŒåˆ†å³å¯ã€‚(å…·ä½“å‚è§è¯—äººå° $\rm{G}$ çš„é¢˜è§£) ã€‚</li><li><strong>2.</strong> åˆ†æ²»è®¡ç®—ç­”æ¡ˆã€‚è®¾ $slove(al,ar,vl,vr)$ è¡¨ç¤ºåœ¨åŸæ•°ç»„ $al$ åˆ° $ar$ è¿™æ®µåŒºé—´çš„æœ€ä¼˜å†³ç­–ç‚¹ä½äº $vl$ åˆ° $vr$ åŒºé—´ã€‚æˆ‘ä»¬æ¯ä¸€æ¬¡æ‰¾åˆ° $al$ åˆ° $ar$ çš„ä¸­é—´ç‚¹ï¼Œä¹Ÿå°±æ˜¯ $mid$ ï¼Œç„¶ååœ¨ $vl$ åˆ° $vr$ å¯»æ‰¾æœ€ä¼˜çš„å†³ç­–ç‚¹æ›´æ–° $f_{mid}$ ( $\rm{DP}$ æ•°ç»„)ï¼Œè®¾è¿™ä¸ªæœ€ä¼˜ç‚¹ä¸º $g$ ã€‚å› ä¸ºæ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œ$al$ åˆ° $mid-1$ çš„æ‰€æœ‰ç‚¹çš„æœ€ä¼˜å†³ç­–ç‚¹ä¸€å®šåœ¨ $vl$ åˆ° $g$ ä¹‹é—´ï¼Œå³è¾¹ $mid+1$ åˆ° $ar$ çš„ä¹ŸåŒç†ï¼Œå°±è¿™ä¹ˆåˆ†æ²»ä¸‹å»å³å¯ã€‚</li></ul><p>å®é™…è¿ç”¨ä¸­åˆ†æ²»çš„æ•ˆç‡ä¸å¦‚ä¸‰å…ƒç»„ï¼Œä½†æ˜¯ä»£ç å´å¥½å†™å¾—å¤šï¼Œå¾ˆçŸ­ï¼Œå¹¶ä¸”è°ƒè¯•éš¾åº¦ä¹Ÿå¤§å¤§é™ä½ï¼Œæ‰€ä»¥æœ€ç»ˆæˆ‘é€‰æ‹©äº†åˆ†æ²»â€¦â€¦åˆ†æ²»çš„å…·ä½“ç»†èŠ‚çœ‹ä»£ç ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">6e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;ll a[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">double</span> f1[N],f2[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_f1</span><span class="params">(<span class="keyword">int</span> al,<span class="keyword">int</span> ar,<span class="keyword">int</span> vl,<span class="keyword">int</span> vr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(al&gt;ar) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(al+ar)&gt;&gt;<span class="number">1</span>,g=<span class="number">0</span>;</span><br><span class="line">    f1[mid]=a[mid];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=vl;i&lt;=min(vr,mid);++i) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> calc=a[i]+<span class="built_in">sqrt</span>(<span class="keyword">double</span>(mid-i));</span><br><span class="line">        <span class="keyword">if</span>(calc&gt;f1[mid]) f1[mid]=calc,g=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!g) g=mid;f1[mid]-=a[mid];</span><br><span class="line">    solve_f1(al,mid<span class="number">-1</span>,vl,g),solve_f1(mid+<span class="number">1</span>,ar,g,vr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_f2</span><span class="params">(<span class="keyword">int</span> al,<span class="keyword">int</span> ar,<span class="keyword">int</span> vl,<span class="keyword">int</span> vr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(al&gt;ar) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid=(al+ar)&gt;&gt;<span class="number">1</span>,g=<span class="number">0</span>;</span><br><span class="line">    f2[mid]=a[mid];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=vr;i&gt;=max(vl,mid);--i) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> calc=a[i]+<span class="built_in">sqrt</span>(<span class="keyword">double</span>(i-mid));</span><br><span class="line">        <span class="keyword">if</span>(calc&gt;f2[mid]) f2[mid]=calc,g=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!g) g=mid;f2[mid]-=a[mid];</span><br><span class="line">    solve_f2(al,mid<span class="number">-1</span>,vl,g),solve_f2(mid+<span class="number">1</span>,ar,g,vr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(a[i]);</span><br><span class="line">    solve_f1(<span class="number">1</span>,n,<span class="number">1</span>,n),solve_f2(<span class="number">1</span>,n,<span class="number">1</span>,n);</span><br><span class="line">    <span class="comment">/*æœ€ç»ˆæ²¡æœ‰ç¿»è½¬åºåˆ—ï¼Œè€Œæ˜¯é€‰æ‹©åšä¸¤éåˆ†æ²»*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(ll)<span class="built_in">ceil</span>(max(f1[i],f2[i])));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®è¿™é“é¢˜æ˜¯ $\rm{POI}$ çš„åŸé¢˜ï¼Œ$loj$ ä¼ é€é—¨é“¾æ¥ï¼š&lt;a href=&quot;https://loj.ac/problem/2074&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;åœ¨è¿™å‘¢o(ï¿£ï¸¶ï¿£)o&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆšå¼€å§‹è‚¯å®šè¿˜æ˜¯çœ‹ä¸å‡ºè¿™é¢˜æ˜¯ä»€ä¹ˆ $\rm{DP}$ ï¼Œæ„Ÿè§‰å¾ˆè¯¡å¼‚ï¼Œä½†æ˜¯æ¨ä¸€æ¨è‡ªç„¶å°±å‡ºæ¥äº†ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;h_j \leq h_i+p-\sqrt{|iâˆ’j|}\\\\p\geq h_j-h_i +\sqrt{|iâˆ’j|}\\\\p=\max\{ h_j-h_i +\sqrt{|iâˆ’j|}\}&lt;/script&gt;&lt;p&gt;è®¾ $f_i$ è¡¨ç¤º $i$ çš„ $p$ å€¼ï¼Œé‚£ä¹ˆç»§ç»­ï¼š&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
      <category term="åˆ†æ²»" scheme="http://qiulyblog.github.io/tags/%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2016]å›½ç‹é¥®æ°´è®°  æ–œç‡ä¼˜åŒ–DP  loj2087</title>
    <link href="http://qiulyblog.github.io/2019/04/29/%5B%E9%A2%98%E8%A7%A3%5Dloj2087/"/>
    <id>http://qiulyblog.github.io/2019/04/29/[é¢˜è§£]loj2087/</id>
    <published>2019-04-28T16:00:00.000Z</published>
    <updated>2019-04-29T13:20:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¯çˆ±çš„é¢˜ç›®ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2087" target="_blank" rel="noopener">æˆ³æˆ‘æˆ³æˆ‘Â·(<em>â•¹â–½â•¹</em>)Â·</a></p><p>è¯´å®è¯è¿™é“é¢˜å¦‚æœå•çœ‹æ–œç‡ä¼˜åŒ– $\texttt{DP}$ ï¼Œä½†æ˜¯å¦‚æœæ²¡çŒœåˆ°é‚£ä¹ˆå¤šç»“è®ºï¼Œä½ æ˜¯æ€ä¹ˆä¹Ÿæƒ³ä¸åˆ°â€æ–œç‡ä¼˜åŒ–â€æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹çŒœç»“è®ºå§â€¦â€¦</p><ul><li><strong>1.</strong> åˆå§‹æ°´ä½å°äº $h_1$ çš„æ²¡æœ‰ç”¨ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ã€‚</p><a id="more"></a><ul><li><strong>2.</strong> å¦‚æœ $n\leq k$ ï¼Œé‚£ä¹ˆåªéœ€è¦å°†æ‰€ä»¥å¤§äº $h_1$ çš„è·Ÿ $1$ åŸå¸‚è¿å°±å¥½äº†ã€‚</li></ul><p>æ¯æ¬¡è¿æ¥çš„åŸå¸‚æ•°è¶Šå°‘è´¡çŒ®è¶Šå¤§ï¼Œé‚£ä¹ˆæ¯ä¸ªé€ä¸€è¿ä¸€æ¬¡ä¸€å®šæ˜¯æœ€ä¼˜æ–¹æ¡ˆã€‚</p><ul><li><strong>3.</strong> æ¯æ¬¡æ“ä½œå¿…ç„¶è·Ÿ $1$ åŸå¸‚æœ‰å…³ç³»ã€‚</li></ul><p>ä¸ç„¶æ²¡è´¡çŒ®ã€‚</p><ul><li><strong>4.</strong> é™¤äº† $1$ å·åŸå¸‚ï¼Œå…¶ä»–æ¯ä¸ªåŸå¸‚æœ€å¤šè¿ä¸€æ¬¡ã€‚</li></ul><p>å› ä¸ºè¿è¿‡ä¸€æ¬¡çš„åŸå¸‚çš„æ°´ä½å·²ç»å’Œ $1$ åŸå¸‚ä¸€æ ·äº†ï¼Œç®€å•ç‚¹è¯´è‚¯å®šå°±æ˜¯åºŸäº†ã€‚</p><ul><li><strong>5.</strong> æ¯æ¬¡è¿çš„æ‰€æœ‰åŸå¸‚ä¸­æœ€å°çš„ $h_i$ å¿…ç„¶å¤§äºä¸Šä¸€æ¬¡é“¾æ¥çš„æœ€å¤§çš„ $h_i$ ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ï¼Œä¸ç„¶ä¸æ»¡è¶³æœ€ä¼˜æ–¹æ¡ˆã€‚</p><ul><li><strong>6.</strong> å°†æ‰€ä»¥åŸå¸‚æŒ‰æ°´ä½æ’åºåï¼Œæ¯æ¬¡é€‰æ‹©çš„å¿…ç„¶æ˜¯è¿ç»­ä¸€æ®µåŒºé—´ã€‚</li></ul><p>å’Œä¸Šä¸€ä¸ªå·®ä¸å¤šã€‚</p><ul><li><strong>7.</strong> æ¯æ¬¡é€‰æ‹©çš„åŒºé—´å¿…ç„¶å’Œä¸Šä¸€æ¬¡çš„é€‰æ‹©åŒºé—´æ¥è§¦ã€‚</li></ul><p>è¿™å¾ˆæ˜¾ç„¶ã€‚</p><ul><li><strong>8.</strong> æ¯æ¬¡é€‰æ‹©çš„åŒºé—´çš„é•¿åº¦å¿…å®šå•è°ƒä¸å¢ã€‚</li></ul><p>æ»¡è¶³æœ€ä¼˜ï¼Œéƒ½è¯´äº†æ¯æ¬¡è¿æ¥çš„åŸå¸‚è¶Šå°‘è´¡çŒ®è¶Šå¤§ã€‚</p><hr><p>é‚£ä¹ˆæ˜¾ç„¶å°±å˜æˆäº†ä¸€ä¸ªåŒºé—´é—®é¢˜äº†ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªåŒºé—´åˆ†æˆè‹¥å¹²å—ã€‚</p><p>è®¾ $f_{i,j}$ è¡¨ç¤ºæ’åºåå‰ $i$ ä¸ªåŸå¸‚è”é€šäº† $j$ æ¬¡å $1$ å·åŸå¸‚çš„æœ€å¤§æ°´ä½é«˜åº¦ã€‚é‚£ä¹ˆè½¬ç§»ç›´æ¥æšä¸¾ä¸€ä¸ª $k$ ï¼Œåœ¨æ–°çš„ä¸€æ¬¡è¿æ¥ä¸­è¿æ¥äº† $k+1$ åˆ° $i$ è¿™äº›åŸå¸‚ã€‚è½¬ç§»æ–¹ç¨‹æ˜¾ç„¶ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\frac{f_{k,j-1}+(s_i-s_k)}{i-k+1}</script><p>*æ³¨ï¼š$s_i$ ä¸ºå‰ç¼€å’Œã€‚</p><p>ä¸Šå¼çš„å¤æ‚åº¦ä¸º $O(n^2k)$  ï¼Œè‚¯å®šçˆ†ç‚¸ã€‚ä½†æ˜¯è¿™ä¸ªæ˜¯å¯ä»¥<strong>æ–œç‡ä¼˜åŒ–</strong>çš„ï¼š</p><script type="math/tex; mode=display">\frac{f_{k,j-1}+(s_i-s_k)}{i-k+1} =\frac{s_i-(s_k-f_{k,j-1})}{i-(k-1)}\Rightarrow \frac{Y(i)-Y(k)}{X(i)-X(k)}</script><p>ç„¶åé€šè¿‡ç¬¬ $8$ æ¡æ€§è´¨å¯ä»¥å¾—çŸ¥ $\texttt{DP}$ æ˜¯æœ‰<strong>å†³ç­–å•è°ƒæ€§</strong>çš„ï¼Œæ•…å¤æ‚åº¦ä¸º $O(nk)$ ã€‚å› ä¸ºæ¶å¿ƒçš„é«˜ç²¾åº¦å°æ•°çš„è¿ç®—è¿˜éœ€è¦ $O(p)$ çš„å¤æ‚åº¦ï¼Œæ‰€ä»¥æœ€ç»ˆæ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(nkp)$ ã€‚</p><p>æˆ‘ä»¬å‘ç° $k$ æœ‰ $10^9$ ï¼Œæ‰€ä»¥å¤æ‚åº¦å¸¦ $k$ çš„ä¸€å®šå‡æ‰äº†ã€‚</p><p>é‚£ä¹ˆè§‚å¯Ÿç¬¬ $2$ æ¡æ€§è´¨ä¼šå‘ç°ï¼Œå¦‚æœ $k$ å¤§äº $n$ äº†ç›´æ¥å°† $k$ è®¾ä¸º $n$ å°±å¥½äº†ã€‚ä¹Ÿå°±æ˜¯è¯´å¤æ‚åº¦åº”è¯¥ä¸º $O(n^2p)$ ï¼Œè¿™æ ·å°±æ˜¯ $86$ åˆ†ï¼Œé€šè¿‡æ•°æ®æ¥çœ‹ä¼šå‘ç°è¿™ä¸ªå€¾å‘äºå¤§ä¼—åˆ†ï¼Œä¸€è½¦å¢çš„äººéƒ½æ˜¯è¿™ä¸ªåˆ†æ•°ã€‚</p><p>é‚£ä¹ˆå¦‚æœæƒ³è¦ $\texttt{AC}$ çš„è¯éœ€è¦æœ€åä¸€æ¡å¾ˆè¿·çš„æ€§è´¨ï¼š</p><ul><li><strong>9.</strong> å› ä¸º $h$ å„ä¸åŒï¼Œé€‰æ‹©çš„åŒºé—´æœ€å¤šåªæœ‰ $14$ ä¸ªåŒºé—´é•¿åº¦å¤§äº $1$ ï¼Œå…¶ä»–çš„åŒºé—´å‡ç­‰äº $1$ ã€‚</li></ul><p>å¾ˆè¿·ï¼Œå‡†ç¡®çš„è¯´è¿™æ ·çš„åŒºé—´æ˜¯ $O(\log\frac{nh}{\min_i\{h_i-h_{i-1}\}})$ ä¸ªã€‚</p><p>è¯æ˜ä¸ä¼šâ€¦â€¦ä½†æ˜¯è¿™é‡Œå†™äº†è¯æ˜(å”¯ä¸€çš„ä¸”å¾ˆè¿·çš„è¯æ˜)ï¼š<a href="https://github.com/qiulyblog/image/blob/master/[NOI2016]%E5%9B%BD%E7%8E%8B%E9%A5%AE%E6%B0%B4%E8%AE%B0%E9%A2%98%E8%A7%A3.pdf?raw=true" target="_blank" rel="noopener">å“ˆå“ˆæˆ‘æ˜¯ä¼ é€é—¨O(âˆ©_âˆ©)O</a></p><p>é‚£ä¹ˆå°±ä¸¢ä»£ç äº†ï¼Œå®é™…ä¸Šæ˜¯éœ€è¦é«˜ç²¾å°æ•°çš„ï¼Œè¿™é‡Œå…ˆç»™å‡ºä¸€ä¸ªé™¤å»é«˜ç²¾å°æ•°æ¿å­çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">8e3</span>+<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">Decimal ans;</span><br><span class="line"><span class="keyword">int</span> n,k,p,lim,h[N],s[N],pre[N][<span class="number">16</span>],tot;</span><br><span class="line"><span class="keyword">int</span> q[N],head,tail;</span><br><span class="line"><span class="keyword">double</span> f[N][<span class="number">16</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span>&#123;</span><span class="keyword">double</span> x,y;&#125;t[N];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(point a,point b)</span> </span>&#123;<span class="keyword">return</span> (a.y-b.y)/(a.x-b.x);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Decimal <span class="title">solve</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!j) <span class="keyword">return</span> h[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> (solve(pre[i][j],j<span class="number">-1</span>)+s[i]-s[pre[i][j]])/(i-pre[i][j]+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;k,&amp;p,&amp;h[tot=<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d\n"</span>,&amp;h[i]);</span><br><span class="line">        <span class="keyword">if</span>(h[i]&gt;h[<span class="number">1</span>]) h[++tot]=h[i];</span><br><span class="line">    &#125;</span><br><span class="line">    n=tot;sort(&amp;h[<span class="number">1</span>],&amp;h[n+<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[i][<span class="number">0</span>]=h[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]=s[i<span class="number">-1</span>]+h[i];</span><br><span class="line">    k=min(k,n),lim=min(k,<span class="number">14</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=lim;++j) &#123;</span><br><span class="line">        q[head=tail=<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) t[i]=(point)&#123;i<span class="number">-1</span>,s[i]-f[i][j<span class="number">-1</span>]&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            point now=(point)&#123;i,s[i]&#125;;</span><br><span class="line">            <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(now,t[q[head]])&lt;slope(now,t[q[head+<span class="number">1</span>]])) ++head;</span><br><span class="line">            f[i][j]=(f[q[head]][j<span class="number">-1</span>]+s[i]-s[q[head]])/(i-q[head]+<span class="number">1</span>);</span><br><span class="line">            pre[i][j]=q[head];</span><br><span class="line">            <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(t[q[tail]],t[q[tail<span class="number">-1</span>]])&gt;slope(t[q[tail]],t[i])) --tail;</span><br><span class="line">            q[++tail]=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m=n-k+lim,pos;</span><br><span class="line">    <span class="keyword">double</span> mx=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=lim;++i) </span><br><span class="line">        <span class="keyword">if</span>(f[m][i]&gt;mx) mx=f[m][i],pos=i;</span><br><span class="line">    ans=solve(m,pos);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=m+<span class="number">1</span>;i&lt;=n;++i) ans=(ans+h[i])/<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans.to_string(p&lt;&lt;<span class="number">1</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆé«˜ç²¾åº¦å°æ•°æ¿å­çš„ä¸‹è½½é“¾æ¥å°±è´´è¿™äº†ï¼š<a href="https://loj.ac/problem/2087/download/additional_file" target="_blank" rel="noopener">$loj$ çš„ä¸‹è½½åœ°å€ä¼ é€ä»¬(ï½ï¿£â–½ï¿£)ï½</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯çˆ±çš„é¢˜ç›®ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2087&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ³æˆ‘æˆ³æˆ‘Â·(&lt;em&gt;â•¹â–½â•¹&lt;/em&gt;)Â·&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯´å®è¯è¿™é“é¢˜å¦‚æœå•çœ‹æ–œç‡ä¼˜åŒ– $\texttt{DP}$ ï¼Œä½†æ˜¯å¦‚æœæ²¡çŒœåˆ°é‚£ä¹ˆå¤šç»“è®ºï¼Œä½ æ˜¯æ€ä¹ˆä¹Ÿæƒ³ä¸åˆ°â€æ–œç‡ä¼˜åŒ–â€æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹çŒœç»“è®ºå§â€¦â€¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;1.&lt;/strong&gt; åˆå§‹æ°´ä½å°äº $h_1$ çš„æ²¡æœ‰ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™å¾ˆæ˜¾ç„¶ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç®—æ³•ã€‘ å°è°ˆæ–œç‡ä¼˜åŒ–</title>
    <link href="http://qiulyblog.github.io/2019/04/28/%5B%E7%AE%97%E6%B3%95%5D%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    <id>http://qiulyblog.github.io/2019/04/28/[ç®—æ³•]æ–œç‡ä¼˜åŒ–/</id>
    <published>2019-04-27T16:00:00.000Z</published>
    <updated>2019-05-07T06:46:02.000Z</updated>
    
    <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="åœ¨æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡" />    <label for="pass">åœ¨æ­¤è¾“å…¥ä½ çš„å¯†ç ä»¥ä¾¿é˜…è¯»å…¨æ–‡</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡ä¸ºåŠ å¯†æ–‡ç« ï¼Œé˜…è¯»æœ¬æ–‡éœ€è¦è¾“å…¥å¯†ç ã€‚
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="ç®—æ³•" scheme="http://qiulyblog.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2015]äºšç‘Ÿç‹  æ¦‚ç‡DP  loj2112</title>
    <link href="http://qiulyblog.github.io/2019/04/28/%5B%E9%A2%98%E8%A7%A3%5Dloj2112/"/>
    <id>http://qiulyblog.github.io/2019/04/28/[é¢˜è§£]loj2112/</id>
    <published>2019-04-27T16:00:00.000Z</published>
    <updated>2019-04-29T13:18:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‘ç° <a href="https://loj.ac" target="_blank" rel="noopener">$loj$</a> çœŸçš„å¥½ç”¨â€¦â€¦æ¯” $luogu$ ä¸çŸ¥é“æ¸…çˆ½åˆ°å“ªé‡Œå»äº†ï¼Œæ›´ä½•å†µ $loj$ çš„é¢˜ç›®ä¹Ÿæ›´å¤šï¼Œè€Œä¸”æä¾›æ•°æ®å’Œä»£ç ï¼Œæ›´åŠ å¼€æ”¾ã€‚ä¼°è®¡ä»¥åéƒ½ä¼šåœ¨ $loj$ ä¸Šå¤šé€›é€›ã€‚( $bzoj$ æ˜¯çœŸçš„ä¸‘ï¼Œé™¤éæ˜¯åš $bzoj$ çš„åŸåˆ›é¢˜ä¸ç„¶æˆ‘ä¸ä¼šä¸Š $bzoj$ çš„) ã€‚</p><p>é¡ºä¾¿è´´ä¸€ä¸‹é¢˜ç›®ä¼ é€é—¨ï¼š<a href="https://loj.ac/problem/2112" target="_blank" rel="noopener">$loj$çš„ä¼ é€é—¨å°±æˆ³æˆ‘å•¦(ï½ï¿£â–½ï¿£)ï½</a></p><p>æ¦‚ç‡ $\texttt{DP}$ ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºæ‰“äº†å‰ $i$ å¼ ç‰Œï¼Œè¿˜æœ‰ $j$ è½®æ²¡æœ‰æ‰“å‡ºç‰Œçš„æ¦‚ç‡ã€‚æˆ‘ä»¬æšä¸¾ç¬¬ $i+1$ å¼ ç‰Œï¼Œåˆ†åˆ«è®¨è®ºä¸€ä¸‹è¯¥ç‰Œæ‰“å‡ºä¸ä¸æ‰“å‡ºçš„æƒ…å†µå³å¯ã€‚</p><a id="more"></a><p>ç¬¬ä¸€ç§æƒ…å†µï¼š$j$ è½®ä¸­éƒ½æ²¡æœ‰æ‰“å‡ºç¬¬ $i+1$ å¼ ç‰Œï¼Œç”±äºä¸€è½®ä¸­ä¸æ‰“å‡ºç¬¬ $i+1$ å¼ ç‰Œçš„æ¦‚ç‡ä¸º $1-p_i$ ï¼Œé‚£ä¹ˆ $j$ è½®éƒ½ä¸æ‰“å‡ºè¯¥ç‰Œçš„æ¦‚ç‡æ˜¾ç„¶ä¸º $(1-p_i)^j$ ã€‚è½¬ç§»æ–¹ç¨‹æ˜¾ç„¶ï¼š</p><script type="math/tex; mode=display">f_{i+1,j}+=f_{i,j}\cdot (1-p_i)^jâ€‹</script><p>å› ä¸º $f_{i+1,j}$ å¯èƒ½ä»å¤šæ–¹å‘è½¬ç§»è¿‡æ¥ï¼Œæ‰€ä»¥æ˜¯ $+=$ ã€‚</p><p>ç¬¬äºŒç§æƒ…å†µï¼š$j$ è½®ä¸­è‡³å°‘æœ‰ä¸€è½®æ‰“å‡ºäº†ç¬¬ $i+1$ å¼ ç‰Œï¼Œæ¦‚ç‡æ˜¾ç„¶ä¸º $1-(1-p_i)^j$ ï¼Œè½¬ç§»ä¹Ÿå°±å¾ˆæ˜¾ç„¶äº†ï¼š</p><script type="math/tex; mode=display">f_{i+1,j-1}+=f_{i,j}\cdot ï¼ˆ1-(1-p_i)^jï¼‰</script><p>å¦‚æœæˆ‘ä»¬æ‰“å‡ºäº†ç¬¬ $i+1$ å¼ ç‰Œï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯è¦è®¡ç®—è´¡çŒ®çš„ï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥ç”¨è¿™ä¸ªæ¦‚ç‡ç®—è´¡çŒ®å°±å¥½äº†ã€‚</p><h4 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">3e2</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> T,n,r,d[N];</span><br><span class="line"><span class="keyword">double</span> f[N][N],p[N],pw[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;r);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%lf%d"</span>,&amp;p[i],&amp;d[i]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            pw[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=r;++j) pw[i][j]=pw[i][j<span class="number">-1</span>]*(<span class="number">1</span>-p[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        f[<span class="number">0</span>][r]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=r;++j) &#123;</span><br><span class="line">                f[i+<span class="number">1</span>][j]+=f[i][j]*pw[i+<span class="number">1</span>][j];</span><br><span class="line">                <span class="keyword">if</span>(j) &#123;</span><br><span class="line">                    <span class="keyword">double</span> calc=f[i][j]*(<span class="number">1</span>-pw[i+<span class="number">1</span>][j]);</span><br><span class="line">                    f[i+<span class="number">1</span>][j<span class="number">-1</span>]+=calc,ans+=calc*d[i+<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.10f\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç° &lt;a href=&quot;https://loj.ac&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;$loj$&lt;/a&gt; çœŸçš„å¥½ç”¨â€¦â€¦æ¯” $luogu$ ä¸çŸ¥é“æ¸…çˆ½åˆ°å“ªé‡Œå»äº†ï¼Œæ›´ä½•å†µ $loj$ çš„é¢˜ç›®ä¹Ÿæ›´å¤šï¼Œè€Œä¸”æä¾›æ•°æ®å’Œä»£ç ï¼Œæ›´åŠ å¼€æ”¾ã€‚ä¼°è®¡ä»¥åéƒ½ä¼šåœ¨ $loj$ ä¸Šå¤šé€›é€›ã€‚( $bzoj$ æ˜¯çœŸçš„ä¸‘ï¼Œé™¤éæ˜¯åš $bzoj$ çš„åŸåˆ›é¢˜ä¸ç„¶æˆ‘ä¸ä¼šä¸Š $bzoj$ çš„) ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºä¾¿è´´ä¸€ä¸‹é¢˜ç›®ä¼ é€é—¨ï¼š&lt;a href=&quot;https://loj.ac/problem/2112&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;$loj$çš„ä¼ é€é—¨å°±æˆ³æˆ‘å•¦(ï½ï¿£â–½ï¿£)ï½&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¦‚ç‡ $\texttt{DP}$ ï¼Œè®¾ $f_{i,j}$ è¡¨ç¤ºæ‰“äº†å‰ $i$ å¼ ç‰Œï¼Œè¿˜æœ‰ $j$ è½®æ²¡æœ‰æ‰“å‡ºç‰Œçš„æ¦‚ç‡ã€‚æˆ‘ä»¬æšä¸¾ç¬¬ $i+1$ å¼ ç‰Œï¼Œåˆ†åˆ«è®¨è®ºä¸€ä¸‹è¯¥ç‰Œæ‰“å‡ºä¸ä¸æ‰“å‡ºçš„æƒ…å†µå³å¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="æ¦‚ç‡" scheme="http://qiulyblog.github.io/tags/%E6%A6%82%E7%8E%87/"/>
    
      <category term="æœŸæœ›" scheme="http://qiulyblog.github.io/tags/%E6%9C%9F%E6%9C%9B/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [CEOI2017]Building Bridges æ–œç‡ä¼˜åŒ–DP loj2483</title>
    <link href="http://qiulyblog.github.io/2019/04/27/%5B%E9%A2%98%E8%A7%A3%5Dloj2483/"/>
    <id>http://qiulyblog.github.io/2019/04/27/[é¢˜è§£]loj2483/</id>
    <published>2019-04-26T16:00:00.000Z</published>
    <updated>2019-04-29T13:17:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ„‰å¿«çš„æ¨å¼å­å§(ï¾‰â‰§âˆ€â‰¦)ï¾‰ï¼</p><p>è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ æ ¹æŸ±å­å®Œå·¥åçš„æœ€å°ä»£ä»·ã€‚æšä¸¾ä¸€ä¸ªå°äº $i$ çš„ $j$ ï¼Œè¡¨ç¤ºä¸ºä» $j$ å‘ $i$ è¿äº†ä¸€åº§æ¡¥ï¼Œä¸­é—´çš„æŸ±å­å½“ç„¶å…¨éƒ¨æ¨æ‰ï¼Œè®¡ç®—ä¸€ä¸‹å°±å¥½ï¼š</p><script type="math/tex; mode=display">f_i=\min\{f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\}</script><p>*å…¶ä¸­ $s$ ä¸º $w$ çš„å‰ç¼€å’Œã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\\\\f_i=f_j+s_{i-1}-s_j+h_i^2+h_j^2-2h_ih_j\\\\f_j+s_{i-1}-s_j+h_i^2+h_j^2=2h_ih_j+f_i</script><p>äºæ˜¯æœ€ç»ˆå¼å­å˜æˆäº† $y=kx+b$ çš„å½¢å¼ï¼Œæ–œç‡ä¼˜åŒ–ï¼</p><p>ä½†æ˜¯â€¦â€¦æ³¨æ„è¿™ä¸ªå¼å­çš„ $k$ ä¸æ˜¯å•è°ƒé€’å¢çš„ï¼Œå¹¶ä¸” $x$ ä¹Ÿä¸æ˜¯å•è°ƒé€’å¢çš„ï¼é‚£ä¹ˆæˆ‘ä»¬ä¸èƒ½ç”¨æœ´ç´ åšæ³•äº†ï¼Œä¹Ÿä¸èƒ½ç”¨äºŒåˆ†â€¦â€¦éš¾é“ç”¨ $Splay$ ï¼Ÿ(ç é‡å·¨å¤§) ã€‚</p><p>ä¸ï¼Œç”¨ $CDQ$ åˆ†æ²»ã€‚</p><p>å¯¹äºä¸€ä¸ª $i$ ï¼Œå¯èƒ½å¯ä»¥å¯¹ $i$ åšå‡ºè´¡çŒ®çš„åªæœ‰æ‰€æœ‰å°äº $i$ çš„ $j$ ã€‚ä¸ºäº†ä¿è¯ $x$ å•è°ƒæˆ‘ä»¬å…ˆå¤§åŠ›å°†åŸæ¥çš„æ•°ç»„æŒ‰ç…§ $x$ ä»å°åˆ°å¤§æ’ä¸ªåºï¼Œç„¶å $CDQ$ çš„æ—¶å€™åˆ†å·¦å³ä¸¤è¾¹ï¼Œå·¦è¾¹çš„æ‰€æœ‰å…ƒç´ åœ¨åˆå§‹æ•°ç»„çš„ä½ç½®éƒ½å°äºå³è¾¹çš„å·¦å³å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç›´æ¥ç”¨å·¦è¾¹å…ƒç´ å¯¹å³è¾¹å…ƒç´ åšå‡ºè´¡çŒ®ã€‚</p><p>åŒæ—¶è¿™é‡Œä¹Ÿä¿è¯äº†å·¦å³ä¸¤è¾¹çš„ $x$ ä¸€å®šæ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ï¼Œæ‰«ä¸€éå·¦è¾¹çš„å…ƒç´ ï¼Œç•™ä¸‹èƒ½åšè´¡çŒ®çš„ç‚¹(ä¸‹å‡¸å£³ä¸Šçš„ç‚¹)ï¼Œè¿™æ—¶å€™å·¦è¾¹çš„æ‰€æœ‰å…ƒç´ å¯ä»¥ä¿è¯ $x$ å’Œæ–œç‡éƒ½æ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>å³è¾¹å‘¢ï¼Ÿå› ä¸ºç›´çº¿çš„æ–œç‡æ˜¯ $2x$ ï¼Œè€Œå³è¾¹çš„ $x$ ä¹Ÿæ˜¯å•è°ƒä¸Šå¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„‰å¿«çš„åšæœ´ç´ çš„å•è°ƒé˜Ÿåˆ—äº†ã€‚</p><p>$CDQ$ åˆ†æ²»éƒ¨åˆ†çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;<span class="comment">/*ä¸€ä¸ªç‚¹çš„æ—¶å€™ç›´æ¥è®¡ç®—yå€¼*/</span></span><br><span class="line">        a[l].y=f[a[l].id]-s[a[l].id]+S(a[l].x);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(a[i].id&lt;=mid) b[c1++]=a[i]; <span class="comment">/*ç¼–å·å°çš„å·¦è¾¹å»*/</span></span><br><span class="line">        <span class="keyword">else</span> b[c2++]=a[i]; <span class="comment">/*ç¼–å·å¤§äº›çš„å³è¾¹å»*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    CDQ(l,mid); <span class="comment">/*è®¡ç®—å‡ºå·¦è¾¹æ‰€æœ‰å…ƒç´ çš„ f*/</span></span><br><span class="line">    <span class="keyword">int</span> head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=mid;++i) &#123; <span class="comment">/*å¤„ç†å‡ºå·¦è¾¹æ‰€æœ‰å…ƒç´ ç»„æˆçš„ä¸‹å‡¸å£³*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail<span class="number">-1</span>],q[tail])&gt;slope(q[tail],i)) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=mid+<span class="number">1</span>;i&lt;=r;++i) &#123; <span class="comment">/*è®¡ç®—å·¦è¾¹å…ƒç´ å¯¹å³è¾¹å…ƒç´ äº§ç”Ÿçš„è´¡çŒ®*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*a[i].x) ++head; <span class="comment">/*ç»´æŠ¤é˜Ÿåˆ—*/</span></span><br><span class="line">        <span class="keyword">int</span> x=a[i].id,y=a[q[head]].id;</span><br><span class="line">        f[x]=min(f[x],f[y]+s[x<span class="number">-1</span>]-s[y]+S(a[i].x-a[q[head]].x));</span><br><span class="line">        <span class="comment">/*å¯èƒ½è®¡ç®—å¤šæ¬¡æ‰€ä»¥è¦å–min*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i)  <span class="comment">/*è¿˜åŸaæ•°ç»„è‡³åˆå§‹çŠ¶æ€*/</span></span><br><span class="line">        <span class="keyword">if</span>(c2&gt;r||(c1&lt;=mid&amp;&amp;a[c1].x&lt;a[c2].x)) b[i]=a[c1++];</span><br><span class="line">        <span class="keyword">else</span> b[i]=a[c2++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//mainå‡½æ•°ä¸­</span></span><br><span class="line">sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n,cmp),CDQ(<span class="number">1</span>,n); <span class="comment">/*æ’åºåCDQå¼€å§‹*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]); <span class="comment">/*è¾“å‡º*/</span></span><br></pre></td></tr></table></figure><p>æœ€åå› ä¸ºå­˜åœ¨ $0$ ï¼Œåœ¨è®¡ç®—æ–œç‡çš„æ—¶å€™éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚è¿˜éœ€è¦æ³¨æ„ä¸€ä¸‹ $long\ long$ çš„é—®é¢˜ï¼Œè®°å¾—å°† $f$ æ•°ç»„åˆå§‹åŒ–ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf=<span class="number">1e18</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span><span class="keyword">int</span> x,id;ll y;&#125;a[N],b[N];</span><br><span class="line">ll s[N],w[N],f[N];<span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll x)</span> </span>&#123;<span class="keyword">return</span> x*x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(point x,point y)</span> </span>&#123;<span class="keyword">return</span> x.x&lt;y.x;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a[i].x==a[j].x) &#123;</span><br><span class="line">        <span class="keyword">return</span> a[i].y&lt;a[j].y?inf:-inf;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="keyword">double</span>(a[i].y-a[j].y)/<span class="keyword">double</span>(a[i].x-a[j].x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CDQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123;a[l].y=f[a[l].id]-s[a[l].id]+S(a[l].x);<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(a[i].id&lt;=mid) b[c1++]=a[i];</span><br><span class="line">        <span class="keyword">else</span> b[c2++]=a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    CDQ(l,mid);</span><br><span class="line">    <span class="keyword">int</span> head=<span class="number">1</span>,tail=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> q[N];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=mid;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail<span class="number">-1</span>],q[tail])&gt;slope(q[tail],i)) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=mid+<span class="number">1</span>;i&lt;=r;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*a[i].x) ++head;</span><br><span class="line">        <span class="keyword">int</span> x=a[i].id,y=a[q[head]].id;</span><br><span class="line">        f[x]=min(f[x],f[y]+s[x<span class="number">-1</span>]-s[y]+S(a[i].x-a[q[head]].x));</span><br><span class="line">    &#125;</span><br><span class="line">    CDQ(mid+<span class="number">1</span>,r);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l,c1=l,c2=mid+<span class="number">1</span>;i&lt;=r;++i) </span><br><span class="line">        <span class="keyword">if</span>(c2&gt;r||(c1&lt;=mid&amp;&amp;a[c1].x&lt;a[c2].x)) b[i]=a[c1++];</span><br><span class="line">        <span class="keyword">else</span> b[i]=a[c2++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;++i) a[i]=b[i];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) </span><br><span class="line">        IN(a[i].x),a[i].id=i,f[i]=inf;</span><br><span class="line">    f[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(w[i]),s[i]=s[i<span class="number">-1</span>]+w[i];</span><br><span class="line">    sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n,cmp),CDQ(<span class="number">1</span>,n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ„‰å¿«çš„æ¨å¼å­å§(ï¾‰â‰§âˆ€â‰¦)ï¾‰ï¼&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ æ ¹æŸ±å­å®Œå·¥åçš„æœ€å°ä»£ä»·ã€‚æšä¸¾ä¸€ä¸ªå°äº $i$ çš„ $j$ ï¼Œè¡¨ç¤ºä¸ºä» $j$ å‘ $i$ è¿äº†ä¸€åº§æ¡¥ï¼Œä¸­é—´çš„æŸ±å­å½“ç„¶å…¨éƒ¨æ¨æ‰ï¼Œè®¡ç®—ä¸€ä¸‹å°±å¥½ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\min\{f_j+(s_{i-1}-s_j)+(h_i-h_j)^2\}&lt;/script&gt;&lt;p&gt;*å…¶ä¸­ $s$ ä¸º $w$ çš„å‰ç¼€å’Œã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [HNOI2008]ç©å…·è£…ç®±TOY  æ–œç‡ä¼˜åŒ–DP  luoguP3195</title>
    <link href="http://qiulyblog.github.io/2019/04/24/%5B%E9%A2%98%E8%A7%A3%5DluoguP3195/"/>
    <id>http://qiulyblog.github.io/2019/04/24/[é¢˜è§£]luoguP3195/</id>
    <published>2019-04-23T16:00:00.000Z</published>
    <updated>2019-04-28T05:51:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>å·®ä¸å¤šææ‡‚äº†æ–œç‡ä¼˜åŒ–å§â€¦â€¦è¯´å®è¯ç½‘ä¸Šçš„æ–‡ç« éƒ½å†™å¾—å¾ˆè¿·ï¼Œè¿˜å¥½æ‰¾åˆ°äº†ä¸€ä¸ªä¸é”™çš„æ–‡ç« ï¼š<a href="https://www.cnblogs.com/yangsongyi/p/9630227.html" target="_blank" rel="noopener">è½¬é€é—¨æˆ³æˆ‘(ï¿£â–½ï¿£)~*</a> ã€‚(ä¸ºä»€ä¹ˆçªç„¶å‘ç°è¿™é“é¢˜å’Œè¯—äººå°Gå¾ˆåƒå‘¢) </p><p>è¿™ä¸ª $\texttt{DP}$ æ–¹ç¨‹è°éƒ½ä¼šè®¾ï¼šè®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªç©å…·çš„æœ€å°è´¹ç”¨ï¼Œè½¬ç§»æ˜¾ç„¶å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">f_i=\min\limits_{j=1}^{i-1}\{f_j+(sum_i-sum_j+i-j-l)^2\}</script><p>(å…¶ä¸­ $sum$ æ˜¯å‰ç¼€å’Œ)ã€‚è¿™ä¸ªå¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ï¼Œè¿‡ä¸å»â€¦â€¦</p><a id="more"></a><p>ç»§ç»­æ¨å¼å­ï¼š</p><script type="math/tex; mode=display">f_i=\min\limits_{j=1}^{i-1}\{f_j+[(sum_i+i)-(sum_j+j)-l]^2\}</script><p>è®¾ $s_i=sum_i+i$ ï¼Œæˆ‘ä»¬å‡è®¾ $j$ ä¸ºæœ€ä¼˜å†³ç­–ï¼Œå°† $\min$ å»æ‰ã€‚</p><script type="math/tex; mode=display">f_i=f_j+(s_i-s_j-l)^2\\f_i=f_j+s_i^2+(s_j+l)^2-2\cdot s_i\cdot(s_j+l)\\f_j+s_i^2+(s_j+l)^2=2\cdot s_i\cdot(s_j+l)+f_iâ€‹</script><p>äºæ˜¯ä¸Šé¢çš„å¼å­å˜æˆäº† $y=kx+b$ çš„å½¢å¼ï¼Œå…¶ä¸­ $y=f_j+s_i^2+(s_j+l)^2$ ï¼Œ$k=2\cdot s_i$ ï¼Œ$x=s_j+l$ ï¼Œ$b=f_i$ ã€‚</p><p>ç„¶åå°† $x,y$ ä¸¤ä¸ªå€¼ä½œä¸ºç‚¹ $(x,y)$ æ”¾åˆ°å¹³é¢ä¸Šå³å¯ï¼Œå› ä¸ºæœ€ç»ˆç­”æ¡ˆæ˜¯å– $min$ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»´æŠ¤çš„æ˜¯ä¸‹å‡¸å£³ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ç®—æ–œç‡çš„æ—¶å€™å¯ä»¥å°†æ¯ä¸ªç‚¹çš„å¸¸æ•°é¡¹æˆ–è€…åªå’Œ $i$ æœ‰å…³çš„é¡¹å»æ‰ï¼Œå› ä¸ºç®—æ–œç‡æ˜¯ç›¸å‡çš„ï¼Œå‡çš„æ—¶å€™è¿™äº›é¡¹åŒæ ·ä¹Ÿæ²¡äº†ã€‚</p><p>ä¸Šé¢çš„ $x$ ä¸­çš„ $l$ æ˜¯å¸¸æ•°é¡¹äºæ˜¯å¯ä»¥çœç•¥ï¼Œ$y$ ä¸­çš„ $s_i^2$ åªå’Œ $i$ æœ‰å…³ï¼Œäºæ˜¯ä¹Ÿçœç•¥æ‰ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) ((x)*(x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> n,l,head,tail;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[N],s[N],q[N];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">X</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> s[i];&#125;<span class="comment">/*æ¯ä¸ªç‚¹çš„xåæ ‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> f[i]+S(s[i]+l);&#125;<span class="comment">/*æ¯ä¸ªç‚¹çš„yåæ ‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;<span class="keyword">return</span> (Y(j)-Y(i))/(X(j)-X(i));&#125;<span class="comment">/*ç®—æ–œç‡*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;s[i]),s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) s[i]+=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*s[i]) ++head;</span><br><span class="line">        f[i]=f[q[head]]+S(s[i]-s[q[head]]-l<span class="number">-1</span>);<span class="comment">/*è½¬ç§»*/</span></span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail],i)&lt;slope(q[tail],q[tail<span class="number">-1</span>])) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ¥è§£é‡Šä¸€äº›é—®é¢˜ã€‚</p><h3 id="1-ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³"><a href="#1-ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³" class="headerlink" title="1.ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³"></a>1.ä¸ºä»€ä¹ˆè¦ç»´æŠ¤ä¸‹å‡¸å£³</h3><p>å› ä¸ºæˆ‘ä»¬çš„ $\texttt{DP}$ æ–¹ç¨‹æ˜¯åœ¨å– $\min$ ï¼Œå¦‚æœæ˜¯ $\max$ çš„è¯åˆ™ç»´æŠ¤ä¸Šå‡¸å£³ã€‚è€Œä¸”ç»´æŠ¤ä¸‹å‡¸å£³æ˜¾ç„¶æ˜¯è®© $f_i$ æ›´å°ã€‚</p><p>ä»¥ä¸Šé¢ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç”¨ $y=kx+bâ€‹$ çš„ç›´çº¿ä»ä¸‹é¢ç½‘ä¸Šæ‰«ï¼Œæ³¨æ„è¿™æ¡ç›´çº¿çš„æ–œç‡å°±æ˜¯ $kâ€‹$ ã€‚å¾ˆæ˜¾ç„¶å¦‚æœæˆ‘ä»¬ä»ä¸‹å¾€ä¸Šè¿™æ ·æ‰«è¶Šå¾€ä¸Šæ‰« $bâ€‹$ è¶Šå¤§(ä¸æ˜ç™½çš„ç”»ç”»å›¾)ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®çš„æ˜¯ä½¿å¾— $bâ€‹$ æœ€å°( $bâ€‹$ å°±æ˜¯ $f_iâ€‹$ ) ã€‚ä¸‹å‡¸å£³åŒ…å«äº†æœ€ä¸‹é¢çš„æ‰€æœ‰ç‚¹ï¼Œæ˜¾ç„¶ä¸æ˜¯ä¸‹å‡¸å£³ä¸Šçš„ç‚¹ä¸€å®šä¸èƒ½æˆä¸ºæœ€ä¼˜çš„ã€‚</p><h3 id="2-ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ"><a href="#2-ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ" class="headerlink" title="2.ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ"></a>2.ç»´æŠ¤é˜Ÿåˆ—çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆé¬¼æ“ä½œ</h3><p>é¦–å…ˆç¬¬ä¸€ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&lt;<span class="number">2</span>*s[i]) ++head;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è®²äº†æˆ‘ä»¬éœ€è¦ä½¿å¾— $bâ€‹$ æœ€å°ï¼Œé‚£ä¹ˆæœ€ä¼˜çš„å†³ç­–ç‚¹åœ¨ç›´çº¿ä»ä¸‹å¾€ä¸Šæ‰«çš„è¿‡ç¨‹ä¸­è‚¯å®šæ˜¯æœ€å…ˆæ‰«åˆ°çš„ï¼Œå› ä¸ºé‚£æ ·å¯ä»¥ä¿è¯ $f_iâ€‹$ æœ€å°ã€‚å‡è®¾æœ€ä¼˜çš„ç‚¹ä¸º $iâ€‹$ ï¼Œä¸Šä¸€ä¸ªç‚¹ä¸º $jâ€‹$ ï¼Œä¸‹ä¸€ä¸ªç‚¹ä¸º $kâ€‹$ ï¼Œé‚£ä¹ˆ $iâ€‹$ ä¸€å®šä¿è¯ $jâ€‹$ åˆ° $iâ€‹$ çš„æ–œç‡å°äºç›´çº¿æ–œç‡å¹¶ä¸” $iâ€‹$ åˆ° $kâ€‹$ çš„æ–œç‡å¤§äºç›´çº¿æ–œç‡ã€‚</p><p>ç„¶åæˆ‘ä»¬ä¼šå‘ç°å¯¹äºå•è°ƒä¸Šå¢çš„éœ€è¦æ›´æ–°çš„ $iâ€‹$ ï¼Œå…¶ç›´çº¿çš„æ–œç‡ $kâ€‹$ ä¸€å®šæ˜¯å•è°ƒä¸Šå¢çš„ï¼Œå› ä¸ºå‰ç¼€å’Œæ˜¯å•è°ƒä¸Šå¢çš„ã€‚</p><p>æ‰€ä»¥å¯¹äºæ–œç‡å·²ç»ä¸æ»¡è¶³è¦æ±‚çš„ç‚¹ç›´æ¥è¸¢å‡ºé˜Ÿå°±å¥½äº†ã€‚</p><p>ç„¶ååº·åº·å‡ºé˜Ÿçš„è¿‡ç¨‹ã€‚å¦‚æœåœ¨çº¸ä¸Šç”»ç”»ä¼šå‘ç°ï¼Œå¦‚æœæ»¡è¶³ <code>slope(q[tail],i)&lt;slope(q[tail],q[tail-1])</code> ï¼Œé‚£ä¹ˆè¯´æ˜ $q[tail]$ å·²ç»ä¸å†ä¸‹å‡¸å£³ä¸­äº†ï¼æ²¡é”™å§ï¼Ÿé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ $q[tail]$ æ°¸è¿œä¹Ÿä¸å¯èƒ½æˆä¸ºæœ€ä¼˜çš„è½¬ç§»ç‚¹äº†ï¼Œç›´æ¥ä¸¢æ‰å³å¯ã€‚</p><hr><p>æœ€åæœ‰ä¸€äº›æ–œç‡ä¼˜åŒ–çš„å¥—è·¯æ€»ç»“(è‡ªå·±æ€»ç»“å‡ºæ¥çš„)ï¼š</p><ul><li>$\texttt{DP}$ æ–¹ç¨‹å– $\min$ å°±ç»´æŠ¤ä¸‹å‡¸å£³ï¼Œå– $\max$ å°±ç»´æŠ¤ä¸Šå‡¸å£³</li><li>$y=kx+bâ€‹$ ä¸­çš„ $kâ€‹$ ä¸€å®šè¦æ˜¯å¸¸é‡æˆ–è€…æ˜¯å®Œå…¨æ˜¯ $iâ€‹$ çš„é‡(ä¾‹å¦‚ $s_i,2\cdot g_i^2â€‹$ ç­‰)ï¼Œ$bâ€‹$ ä¸€å®šæ˜¯ä½ éœ€è¦è½¬ç§»çš„å¯¹è±¡(å°±æ˜¯ $f_iâ€‹$ )ï¼Œ$xâ€‹$ å’Œ $yâ€‹$ ä¸¤ä¸ªå€¼ä¸€å®šè¦åŒ…å«å’Œ $jâ€‹$ æœ‰å…³çš„å€¼ï¼Œè¦éš $jâ€‹$ çš„å˜åŒ–è€Œå˜åŒ–ã€‚</li><li>æç‚¼å‡ºæ¥çš„ $x,y$ æ”¾åˆ°åæ ‡ç³»ä¸Šä¹‹å‰è®°å¾—å»æ‰æ²¡ç”¨çš„å€¼ã€‚</li></ul><p>å·®ä¸å¤šå°±è¿™äº›å§ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯å®Œå…¨æ­£ç¡®ï¼Œè‡³å°‘è¿™ä¸ªå¥—è·¯è¿˜æ˜¯è¿‡äº†å‡ é“é¢˜ç›®çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å·®ä¸å¤šææ‡‚äº†æ–œç‡ä¼˜åŒ–å§â€¦â€¦è¯´å®è¯ç½‘ä¸Šçš„æ–‡ç« éƒ½å†™å¾—å¾ˆè¿·ï¼Œè¿˜å¥½æ‰¾åˆ°äº†ä¸€ä¸ªä¸é”™çš„æ–‡ç« ï¼š&lt;a href=&quot;https://www.cnblogs.com/yangsongyi/p/9630227.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è½¬é€é—¨æˆ³æˆ‘(ï¿£â–½ï¿£)~*&lt;/a&gt; ã€‚(ä¸ºä»€ä¹ˆçªç„¶å‘ç°è¿™é“é¢˜å’Œè¯—äººå°Gå¾ˆåƒå‘¢) &lt;/p&gt;
&lt;p&gt;è¿™ä¸ª $\texttt{DP}$ æ–¹ç¨‹è°éƒ½ä¼šè®¾ï¼šè®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªç©å…·çš„æœ€å°è´¹ç”¨ï¼Œè½¬ç§»æ˜¾ç„¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\min\limits_{j=1}^{i-1}\{f_j+(sum_i-sum_j+i-j-l)^2\}&lt;/script&gt;&lt;p&gt;(å…¶ä¸­ $sum$ æ˜¯å‰ç¼€å’Œ)ã€‚è¿™ä¸ªå¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ï¼Œè¿‡ä¸å»â€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [APIO2010]ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ  æ–œç‡ä¼˜åŒ–DP  luoguP3628</title>
    <link href="http://qiulyblog.github.io/2019/04/24/%5B%E9%A2%98%E8%A7%A3%5DluoguP3628/"/>
    <id>http://qiulyblog.github.io/2019/04/24/[é¢˜è§£]luoguP3628/</id>
    <published>2019-04-23T16:00:00.000Z</published>
    <updated>2019-04-28T05:52:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¾æ—§æ˜¯æ–œç‡ä¼˜åŒ–çš„å¥—è·¯ã€‚</p><p>è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªå£«å…µçš„æœ€å¤§è´¡çŒ®ï¼Œè½¬ç§»æ˜¾ç„¶æ˜¯æšä¸¾ä¸€ä¸ª $j$ ï¼Œå°† $j+1$ åˆ° $i$ è¿™äº›å£«å…µç»„æˆç‰¹åˆ«è¡ŒåŠ¨é˜Ÿç®—è´¡çŒ®ï¼š</p><script type="math/tex; mode=display">f_i=\max\{f_j+a(s_i-s_j)^2+b(s_i-s_j)+c\}â€‹</script><p>å…¶ä¸­ $s_i$ ä¸ºæˆ˜æ–—åŠ›çš„å‰ç¼€å’Œã€‚è¿™ä¸ªæ–¹ç¨‹æ˜¯ $O(n^2)$ çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚å‘ç°è¿™ä¸ªè½¬ç§»å¼è²Œä¼¼ä¸æ»¡è¶³å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ¡ä»¶ï¼Œäºæ˜¯å°†ä¸­é—´çš„å¼å­æ‹†å¼€çœ‹çœ‹å¯ä¸å¯ä»¥æ–œç‡ä¼˜åŒ–ã€‚</p><a id="more"></a><script type="math/tex; mode=display">f_i=\max\{f_j+a(s_i^2+s_j^2-2s_is_j)+b\cdot s_i-b\cdot s_j+c\}\\f_i=\max\{f_j+a\cdot s_i^2+a\cdot s_j^2-2a\cdot s_is_j)+b\cdot s_i-b\cdot s_j+c\}\\f_i=f_j+a\cdot s_i^2+a\cdot s_j^2-2a\cdot s_is_j+b\cdot s_i-b\cdot s_j+c\\f_j+a\cdot s_i^2+a\cdot s_j^2+b\cdot s_i-b\cdot s_j+c=2a\cdot s_i\cdot s_j +f_iâ€‹</script><p>è¯¶ï¼Œæ˜¯ $y=kx+b$ çš„å½¢å¼ï¼Œè€Œä¸”æ»¡è¶³æ–œç‡ä¼˜åŒ–çš„æ¡ä»¶è¯¶ã€‚ç»§ç»­å°† $x,y$ æ‰¾å‡ºæ¥æ”¾åˆ°åæ ‡ç³»ä¸Š( $x=s_j$,$y=f_j+a\cdot s_j^2-b\cdot s_j$) ã€‚</p><p>å› ä¸ºæ˜¯ $\maxâ€‹$ ï¼Œæ‰€ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸€ä¸‹ä¸Šå‡¸å£³ç„¶åè½¬ç§»å³å¯ï¼Œå¤æ‚åº¦ $O(n)â€‹$ ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> S(x) ((x)*(x))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1e6</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> n,a,b,c,head,tail;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> s[N],f[N],q[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tp&gt; <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">IN</span><span class="params">(_Tp&amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">X</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> s[i];&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Y</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;<span class="keyword">return</span> f[i]+<span class="number">1l</span>l*S(s[i])*a<span class="number">-1l</span>l*s[i]*b;&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;<span class="keyword">return</span> (Y(j)-Y(i))/(X(j)-X(i));&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    f[i]=f[j]+<span class="number">1l</span>l*S(s[i]-s[j])*a+<span class="number">1l</span>l*(s[i]-s[j])*b+c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IN(n),IN(a),IN(b),IN(c);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) IN(s[i]),s[i]+=s[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[head],q[head+<span class="number">1</span>])&gt;<span class="number">2</span>*a*s[i]) ++head;</span><br><span class="line">        calc(i,q[head]);</span><br><span class="line">        <span class="keyword">while</span>(head&lt;tail&amp;&amp;slope(q[tail],i)&gt;slope(q[tail],q[tail<span class="number">-1</span>])) --tail;</span><br><span class="line">        q[++tail]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¾æ—§æ˜¯æ–œç‡ä¼˜åŒ–çš„å¥—è·¯ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªå£«å…µçš„æœ€å¤§è´¡çŒ®ï¼Œè½¬ç§»æ˜¾ç„¶æ˜¯æšä¸¾ä¸€ä¸ª $j$ ï¼Œå°† $j+1$ åˆ° $i$ è¿™äº›å£«å…µç»„æˆç‰¹åˆ«è¡ŒåŠ¨é˜Ÿç®—è´¡çŒ®ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;f_i=\max\{f_j+a(s_i-s_j)^2+b(s_i-s_j)+c\}â€‹&lt;/script&gt;&lt;p&gt;å…¶ä¸­ $s_i$ ä¸ºæˆ˜æ–—åŠ›çš„å‰ç¼€å’Œã€‚è¿™ä¸ªæ–¹ç¨‹æ˜¯ $O(n^2)$ çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚å‘ç°è¿™ä¸ªè½¬ç§»å¼è²Œä¼¼ä¸æ»¡è¶³å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ¡ä»¶ï¼Œäºæ˜¯å°†ä¸­é—´çš„å¼å­æ‹†å¼€çœ‹çœ‹å¯ä¸å¯ä»¥æ–œç‡ä¼˜åŒ–ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="æ–œç‡ä¼˜åŒ–" scheme="http://qiulyblog.github.io/tags/%E6%96%9C%E7%8E%87%E4%BC%98%E5%8C%96/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [SCOI2008]å¥–åŠ±å…³  çŠ¶å‹DP  luoguP2473</title>
    <link href="http://qiulyblog.github.io/2019/04/23/%5B%E9%A2%98%E8%A7%A3%5DluoguP2473/"/>
    <id>http://qiulyblog.github.io/2019/04/23/[é¢˜è§£]luoguP2473/</id>
    <published>2019-04-22T16:00:00.000Z</published>
    <updated>2019-04-24T07:47:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‘ç°æ•°æ®èŒƒå›´å¾ˆå°ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°â€é›†åˆâ€ï¼Œå¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ç”¨çŠ¶å‹ $\texttt{DP}$ ã€‚</p><p>è®¾ $f[i][j]$ è¡¨ç¤ºå·²ç»æŠ›å‡ºäº† $i$ æ¬¡å®ç‰©ï¼Œè·å¾—çš„å®ç‰©é›†åˆä¸º $j$ æ—¶çš„æœ€ä¼˜åˆ†å€¼ã€‚é‚£ä¹ˆè½¬ç§»çš„æ—¶å€™æšä¸¾æ¯ä¸€ä¸ªå®ç‰©ï¼Œåˆ†ä¸¤ç§æƒ…å†µå³å¯â€”â€”é€‰å½“å‰å®ç‰©æˆ–è€…ä¸é€‰ã€‚æ³¨æ„é€‰å½“å‰å®ç‰©çš„å‰ææ˜¯å¿…é¡»æ»¡è¶³å‰æï¼ŒæŒ‰ç…§æœ€ä¼˜æƒ…å†µé€‰å–å³å¯ã€‚æ³¨æ„æœ€åå°†æ‰€æœ‰çš„å®ç‰©çš„è´¡çŒ®åŠ ä¸Šåè¿˜éœ€è¦$/n$ ï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚çš„æ˜¯â€å¹³å‡â€ã€‚</p><a id="more"></a><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">double</span> f[<span class="number">101</span>][<span class="number">65540</span>];</span><br><span class="line"><span class="keyword">int</span> p[<span class="number">18</span>],d[<span class="number">18</span>],v[<span class="number">18</span>],N,K;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">16</span>;++i) p[i]=<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;K,&amp;N);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=N;++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;v[i],&amp;x);</span><br><span class="line">        <span class="keyword">while</span>(x) &#123;d[i]|=p[x];<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=K;i;--i) <span class="comment">/*å€’ç€æšä¸¾ä¼šå¥½äº›*/</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=p[N+<span class="number">1</span>]<span class="number">-1</span>;++j) &#123;</span><br><span class="line">            <span class="comment">/*ä¸Šé¢ä¸¤é‡å¾ªç¯æšä¸¾çŠ¶æ€*/</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=N;++k)<span class="comment">/*æšä¸¾æ‰€æœ‰å®ç‰©å¹¶è®¡ç®—è´¡çŒ®*/</span></span><br><span class="line">                <span class="keyword">if</span>((d[k]&amp;j)==d[k]) <span class="comment">/*å¯ä»¥é€‰å–å½“å‰å®ç‰©*/</span></span><br><span class="line">                    f[i][j]+=max(f[i+<span class="number">1</span>][j],f[i+<span class="number">1</span>][j|p[k]]+v[k]);</span><br><span class="line">                    <span class="comment">/*æŒ‰ç…§æœ€ä¼˜é€‰å–*/</span></span><br><span class="line">                <span class="keyword">else</span> f[i][j]+=f[i+<span class="number">1</span>][j]; <span class="comment">/*ä¸èƒ½é€‰å–ç›´æ¥è½¬ç§»*/</span></span><br><span class="line">            f[i][j]/=N;<span class="comment">/*æ‰€è°“"å¹³å‡"*/</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.6f\n"</span>,f[<span class="number">1</span>][<span class="number">0</span>]);<span class="comment">/*æœ€ç»ˆç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘ç°æ•°æ®èŒƒå›´å¾ˆå°ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°â€é›†åˆâ€ï¼Œå¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ç”¨çŠ¶å‹ $\texttt{DP}$ ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ $f[i][j]$ è¡¨ç¤ºå·²ç»æŠ›å‡ºäº† $i$ æ¬¡å®ç‰©ï¼Œè·å¾—çš„å®ç‰©é›†åˆä¸º $j$ æ—¶çš„æœ€ä¼˜åˆ†å€¼ã€‚é‚£ä¹ˆè½¬ç§»çš„æ—¶å€™æšä¸¾æ¯ä¸€ä¸ªå®ç‰©ï¼Œåˆ†ä¸¤ç§æƒ…å†µå³å¯â€”â€”é€‰å½“å‰å®ç‰©æˆ–è€…ä¸é€‰ã€‚æ³¨æ„é€‰å½“å‰å®ç‰©çš„å‰ææ˜¯å¿…é¡»æ»¡è¶³å‰æï¼ŒæŒ‰ç…§æœ€ä¼˜æƒ…å†µé€‰å–å³å¯ã€‚æ³¨æ„æœ€åå°†æ‰€æœ‰çš„å®ç‰©çš„è´¡çŒ®åŠ ä¸Šåè¿˜éœ€è¦$/n$ ï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚çš„æ˜¯â€å¹³å‡â€ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="çŠ¶å‹DP" scheme="http://qiulyblog.github.io/tags/%E7%8A%B6%E5%8E%8BDP/"/>
    
  </entry>
  
  <entry>
    <title>ã€é¢˜è§£ã€‘ [NOI2011]Noiå˜‰å¹´å  å†³ç­–å•è°ƒæ€§ä¼˜åŒ–DP  luoguP1973</title>
    <link href="http://qiulyblog.github.io/2019/04/22/%5B%E9%A2%98%E8%A7%A3%5DluoguP1973/"/>
    <id>http://qiulyblog.github.io/2019/04/22/[é¢˜è§£]luoguP1973/</id>
    <published>2019-04-21T16:00:00.000Z</published>
    <updated>2019-04-23T00:42:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é“é¢˜ä¸€å…±æœ‰ä¸¤é—®ï¼Œç¬¬ä¸€é—®çæ $\texttt{DP}$ ï¼Œç¬¬äºŒé—®å¦‚æœç›´æ¥ $\texttt{DP}$ çš„è¯å¤æ‚åº¦æ˜¯ $O(n^4)$ çš„è¿‡ä¸å»ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨åˆ°å†³ç­–å•è°ƒæ€§ä¼˜åŒ–å¤æ‚åº¦å°±å¯ä»¥é™ä½è‡³ $O(n^3)$ ï¼Œè¿™æ ·å°±è¿‡äº†ã€‚æˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹ç¬¬ä¸€é—®çš„åšæ³•ã€‚</p><p>æ—¶é—´çš„èŒƒå›´å¤ªå¤§äº†ï¼Œæˆ‘ä»¬éœ€è¦ç¦»æ•£åŒ–ä¸€ä¸‹ã€‚ç¦»æ•£åŒ–åæ—¶é—´å°±æ§åˆ¶åœ¨ $0$ åˆ° $2n$ çš„èŒƒå›´å†…äº†ã€‚</p><p>é¦–å…ˆå¯ä»¥å‘ç°æœ€ç»ˆçš„ç­”æ¡ˆä¸€å®šå°±æ˜¯ä¸€æ®µä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸€æ®µæ—¶é—´å†…çš„æ´»åŠ¨éƒ½æ˜¯åœ¨åŒä¸€ä¸ªä¼šåœºä¸¾è¡Œã€‚æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†ä¸€ä¸ª $tot_{l,r}$ è¡¨ç¤ºå®Œå…¨åœ¨æ—¶é—´ $l,r$ ä¹‹å†…çš„æ´»åŠ¨æœ‰å¤šå°‘ä¸ªã€‚è®¡ç®—ç›´æ¥æš´åŠ›ï¼Œé¢„å¤„ç†çš„å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚</p><a id="more"></a><p>ç„¶åè®¾ä¸€ä¸ª $pre_{i,j}â€‹$ è¡¨ç¤º <strong>$1â€‹$ åˆ° $iâ€‹$ çš„æ—¶é—´ä¸€ä¸ªä¼šåœºçš„æ´»åŠ¨æ•°ä¸º $jâ€‹$ æ—¶å¦ä¸€ä¸ªä¼šåœºçš„æœ€å¤§æ´»åŠ¨æ•°</strong>ã€‚é‚£ä¹ˆè½¬ç§»çš„è¯æˆ‘ä»¬æšä¸¾ä¸€ä¸ªæ—¶é—´ $kâ€‹$ ï¼Œç„¶åè€ƒè™‘ $kâ€‹$ åˆ° $iâ€‹$ è¿™æ®µæ—¶é—´ä¸­çš„æ‰€æœ‰æ´»åŠ¨åˆ†é…ç»™å“ªä¸ªä¼šåœºå³å¯ã€‚å¯ä»¥å¾—åˆ°è½¬ç§»æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">pre_{i,j}=\max\limits_{k=1}^{i}\{pre_{k,j}+tot_{k,i},pre_{k,j-tot_{k,i}}\}â€‹</script><p>è¿™é‡Œæˆ‘ä»¬ $pre$ æ–¹ç¨‹çš„å®šä¹‰ä¸­â€ä¸€ä¸ªä¼šåœºâ€å°±æ˜¯ä¸€å·ä¼šåœºï¼Œâ€å¦ä¸€ä¸ªä¼šåœºâ€å°±æ˜¯äºŒå·ä¼šåœº$ã€‚pre_{k,j}+tot_{k,i}$ å°±æ˜¯å°† $k$ åˆ° $i$ è¿™æ®µæ—¶é—´ä¸­æ‰€æœ‰æ´»åŠ¨éƒ½åˆ†é…ç»™äº†äºŒå·ä¼šåœºï¼Œ$pre_{k,j-tot_{k,i}}$ å¾ˆæ˜¾ç„¶å°±æ˜¯åˆ†é…ç»™äº†ä¸€å·ä¼šåœºã€‚è®¡ç®—æ—¶æšä¸¾ $i,j,k$ ï¼Œå¤æ‚åº¦æ˜¯ $O(n^3)$ ã€‚(å…¶å®å‡†ç¡®çš„å¤æ‚åº¦å¸¦ä¸ªå¸¸æ•°ï¼Œå› ä¸º $i$ æšä¸¾çš„æ˜¯æ—¶é—´ï¼Œè€Œæ—¶é—´æœ€å¤§æ˜¯ $2n$ çš„) ã€‚</p><p>æˆ‘ä»¬è®¾ç¦»æ•£åŒ–åæ—¶é—´æ€»é•¿ä¸º $m$ ï¼Œé‚£ä¹ˆç­”æ¡ˆæ˜¾ç„¶ä¸º $\max\limits_{i=1}^m\{\min(pre_{m,i},i)\}$ ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è§£å†³ç¬¬äºŒé—®ã€‚</p><p>æˆ‘ä»¬çš„ $tot_{l,r}$ ç»Ÿè®¡çš„å°±æ˜¯å®Œå…¨åœ¨æ—¶é—´ $l,r$ çš„åŒºé—´æœ‰å¤šå°‘ä¸ªã€‚é‚£ä¹ˆå¯¹äºç¬¬ $i$ ä¸ªæ´»åŠ¨ï¼Œè®¾è¯¥æ´»åŠ¨çš„èµ·å§‹æ—¶é—´ä¸ç»ˆæ­¢æ—¶é—´åˆ†åˆ«ä¸º $s_i,t_i$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†è€ƒè™‘ä¸€å¯¹ $x,y \ \ (x\leq s_i,t_i\leq y)$ ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°†ç­”æ¡ˆè®¡ç®—ä¸Š $tot_{x,y}$ ï¼Œé‚£ä¹ˆä¹Ÿå°±é€‰æ‹©äº†ç¬¬ $i$ ä¸ªæ´»åŠ¨äº†ã€‚</p><p>æˆ‘ä»¬è®¾ $f_{i,j}$ è¡¨ç¤ºä¸€å·ä¼šåœºå¼ºåˆ¶é€‰æ‹© $i$ åˆ° $j$ æ—¶é—´ä¸­çš„æ‰€æœ‰æ´»åŠ¨æ—¶çš„æœ€ä¼˜ç­”æ¡ˆã€‚(æ³¨æ„è¿™é‡Œçš„æœ€ä¼˜ç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªä¼šåœºä¸­æ´»åŠ¨å°‘çš„ä¸€æ–¹çš„æœ€å¤§å€¼ï¼Œæˆ‘ä»¬åªæ˜¯è€ƒè™‘åœ¨ä¸€å·ä¼šåœº<strong>å¼ºåˆ¶é€‰æ‹©</strong> $i$ åˆ° $jâ€‹$ ä¸­çš„æ‰€æœ‰æ´»åŠ¨çš„æƒ…å†µä¸‹è€ƒè™‘æœ€ä¼˜çš„å…¨å±€ç­”æ¡ˆ) ã€‚</p><p>ç»§ç»­çœ‹å‘ä¸€å·ä¼šåœºï¼Œå‡è®¾åœ¨ $i$ å‰é¢çš„æ—¶é—´ä¸­ä¸€å·ä¼šåœºå·²ç»åˆæ³•ä¸¾åŠäº† $x$ åœºæ´»åŠ¨ï¼Œåœ¨ $j$ åé¢çš„æ—¶é—´ä¸­ä¹Ÿåˆæ³•ä¸¾åŠäº† $y$ åœºæ´»åŠ¨ã€‚é‚£ä¹ˆæˆ‘ä»¬æšä¸¾ $i,j,x,y$ ä¹Ÿå¯ä»¥å¾—åˆ°äºŒå·ä¼šåœºçš„æ´»åŠ¨æ•°ï¼š$i$ å‰é¢çš„æ—¶é—´ç§æœ‰ $pre_{i,x}$ åœºæ´»åŠ¨ï¼Œ$j$ åé¢çš„æ—¶é—´ä¸­æœ‰â€¦â€¦è¯¶è¿™é‡Œç”¨ $pre$ è²Œä¼¼ä¸æ˜¯å¾ˆå¥½è¡¨ç¤ºè¯¶ï¼Œäºæ˜¯æˆ‘ä»¬æ–°å®šä¹‰ä¸€ä¸ª $suf$ ï¼Œ$suf_{i,j}$ è¡¨ç¤º <strong>$i$ åˆ° $m$ çš„æ—¶é—´ä¸€ä¸ªä¼šåœºçš„æ´»åŠ¨æ•°ä¸º $j$ æ—¶å¦ä¸€ä¸ªä¼šåœºçš„æœ€å¤§æ´»åŠ¨æ•°</strong>ï¼Œ$suf$ çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹å’Œ $pre$ çš„åŒç†ã€‚</p><p>æšä¸¾ $i,j,x,y$ åå°±å¯ä»¥å¾—åˆ°ä¸¤ä¸ªä¼šåœºçš„æ´»åŠ¨ä¸ªæ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç®—ç­”æ¡ˆäº†ï¼š</p><script type="math/tex; mode=display">f_{i,j}=\max\limits_{x=1}^{m}\max\limits_{y=1}^{m}\{\min(x+tot_{i,j}+y,pre_{i,x}+suf_{j,y})\}â€‹</script><p>ä½†æ˜¯è¿™æ ·å­çš„å¤æ‚åº¦æ˜¯ $O(n^4)â€‹$ çš„ï¼Œè¿‡ä¸äº†ã€‚</p><p>ä¸è¿‡ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œ<strong>å¯¹äºå•è°ƒé€’å¢çš„ $x$ ï¼Œå¯¹åº”çš„æœ€ä¼˜çš„ $y$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„</strong> ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿé¦–å…ˆå¯¹äºä¸€ä¸ªå•è°ƒé€’å¢çš„ $i$ ï¼Œ$pre_{?_i},suf_{?_i}$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„( $?$ ä¸ºä»»æ„æ•°) ã€‚é‚£ä¹ˆå¦‚æœå¯¹äºå•è°ƒé€’å¢çš„ $x$ ï¼Œ$pre_{i,x}$ ä¸€å®šæ˜¯å•è°ƒé€’å‡çš„ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœ $y$ å•è°ƒé€’å¢ä¹Ÿå°±æ„å‘³ç€ $suf_{j,y}$ ä¼šå•è°ƒé€’å‡ï¼Œé‚£ä¹ˆ $x+tot_{i,j}+y$ å’Œ $pre_{i,x}+suf_{j,y}$ å°†ä¼šè¶Šæ‹‰è¶Šå¤§ï¼Œå¯¹äºç­”æ¡ˆæ˜¾ç„¶æ˜¯ä¸åˆ©çš„ã€‚åè¿‡æ¥ï¼Œå¦‚æœ $y$ æ˜¯å•è°ƒé€’å‡çš„ï¼Œé‚£ä¹ˆå°±ä¼šç›¸å¯¹æ¯”è¾ƒå‡è¡¡ã€‚(æ„Ÿæ€§ç†è§£ç†è§£â€¦â€¦)</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦æšä¸¾ $y$ äº†ï¼Œåªéœ€è¦æ‰«ä¸€æ‰«å°±å¥½äº†ï¼Œæœ€ç»ˆè®¡ç®— $f$ çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚</p><p>æœ€ç»ˆç»Ÿè®¡ç­”æ¡ˆçš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªæ´»åŠ¨ $i$ ï¼Œæˆ‘ä»¬çš„ç­”æ¡ˆæ˜¾ç„¶ä¸º $\max\limits_{x=1}^{s_i}\max\limits_{y=t_i}^{m}f_{x,y}$ ã€‚å¿…é¡»æ»¡è¶³ $x\leq s_i,t_i\leq y$ ï¼Œå› ä¸ºè¿™æ ·å°±ä¼šæ»¡è¶³ä¸€å®šä¼šé€‰æ‹©ç¬¬ $i$ ä¸ªæ´»åŠ¨ã€‚</p><h3 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> F(i,j,k) for((i)=(j);(i)&lt;=(k);++i)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R(i,j,k) for((i)=(j);(i)&gt;=(k);--i)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">4e2</span>+<span class="number">9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,i,j,k,l,r,s[N],t[N],b[N];</span><br><span class="line"><span class="keyword">int</span> tot[N][N],pre[N][N],suf[N][N],f[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">IN</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;<span class="keyword">bool</span> flag=<span class="number">0</span>;<span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch=getchar(),!<span class="built_in">isdigit</span>(ch)) <span class="keyword">if</span>(ch==<span class="string">'-'</span>) flag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">isdigit</span>(ch)) x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">if</span>(flag) x=-x;<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">return</span> min(x+tot[l][r]+y,pre[l][x]+suf[r][y]);&#125;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n=IN();</span><br><span class="line">    F(i,<span class="number">1</span>,n) b[++m]=s[i]=IN(),b[++m]=t[i]=IN()+s[i];</span><br><span class="line">    sort(b+<span class="number">1</span>,b+<span class="number">1</span>+m),</span><br><span class="line">    m=unique(b+<span class="number">1</span>,b+<span class="number">1</span>+m)-b<span class="number">-1</span>;<span class="comment">/*ç¦»æ•£åŒ–å»é‡*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,n) &#123;</span><br><span class="line">        s[i]=lower_bound(b+<span class="number">1</span>,b+<span class="number">1</span>+m,s[i])-b;</span><br><span class="line">        t[i]=lower_bound(b+<span class="number">1</span>,b+<span class="number">1</span>+m,t[i])-b;</span><br><span class="line">        F(l,<span class="number">1</span>,s[i]) R(r,m,t[i]) ++tot[l][r];<span class="comment">/*è®¡ç®—å‡ºtot*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    F(i,<span class="number">1</span>,m) F(j,<span class="number">1</span>,n) pre[i][j]=suf[i][j]=-inf;<span class="comment">/*åˆå§‹åŒ–*/</span> </span><br><span class="line">    <span class="comment">/*----------è®¡ç®—å‡ºpreå’Œsuf----------*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,m) F(j,<span class="number">0</span>,tot[<span class="number">1</span>][i]) F(k,<span class="number">1</span>,i) &#123;</span><br><span class="line">        pre[i][j]=max(pre[i][j],pre[k][j]+tot[k][i]);</span><br><span class="line">        <span class="keyword">if</span>(j&gt;=tot[k][i]) pre[i][j]=max(pre[i][j],pre[k][j-tot[k][i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    R(i,m,<span class="number">1</span>) F(j,<span class="number">0</span>,tot[i][m]) F(k,i,m) &#123;</span><br><span class="line">        suf[i][j]=max(suf[i][j],suf[k][j]+tot[i][k]);</span><br><span class="line">        <span class="keyword">if</span>(j&gt;=tot[i][k]) suf[i][j]=max(suf[i][j],suf[k][j-tot[i][k]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è®¡ç®—f*/</span></span><br><span class="line">    F(l,<span class="number">1</span>,m) F(r,l+<span class="number">1</span>,m) <span class="keyword">for</span>(<span class="keyword">int</span> y=n,x=<span class="number">0</span>;x&lt;=n;++x) &#123;<span class="comment">/*yå½“åšæŒ‡é’ˆæ‰«ä¸€é*/</span></span><br><span class="line">        <span class="keyword">int</span> old_calc=calc(x,y),new_calc;</span><br><span class="line">        <span class="keyword">while</span>(y&amp;&amp;old_calc&lt;=(new_calc=calc(x,y<span class="number">-1</span>))) --y,old_calc=new_calc;</span><br><span class="line">        f[l][r]=max(f[l][r],calc(x,y));<span class="comment">/*è½¬ç§»*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è¾“å‡ºç­”æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    F(i,<span class="number">1</span>,n) ans=max(ans,min(pre[m][i],i));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);<span class="comment">/*ç¬¬ä¸€é—®*/</span></span><br><span class="line">    F(i,<span class="number">1</span>,n) &#123;</span><br><span class="line">        ans=<span class="number">0</span>;</span><br><span class="line">        F(l,<span class="number">1</span>,s[i]) R(r,m,t[i]) ans=max(ans,f[l][r]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);<span class="comment">/*ç¬¬äºŒé—®*/</span></span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™é“é¢˜ä¸€å…±æœ‰ä¸¤é—®ï¼Œç¬¬ä¸€é—®çæ $\texttt{DP}$ ï¼Œç¬¬äºŒé—®å¦‚æœç›´æ¥ $\texttt{DP}$ çš„è¯å¤æ‚åº¦æ˜¯ $O(n^4)$ çš„è¿‡ä¸å»ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦ç”¨åˆ°å†³ç­–å•è°ƒæ€§ä¼˜åŒ–å¤æ‚åº¦å°±å¯ä»¥é™ä½è‡³ $O(n^3)$ ï¼Œè¿™æ ·å°±è¿‡äº†ã€‚æˆ‘ä»¬å…ˆæ¥è®¨è®ºä¸€ä¸‹ç¬¬ä¸€é—®çš„åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´çš„èŒƒå›´å¤ªå¤§äº†ï¼Œæˆ‘ä»¬éœ€è¦ç¦»æ•£åŒ–ä¸€ä¸‹ã€‚ç¦»æ•£åŒ–åæ—¶é—´å°±æ§åˆ¶åœ¨ $0$ åˆ° $2n$ çš„èŒƒå›´å†…äº†ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå¯ä»¥å‘ç°æœ€ç»ˆçš„ç­”æ¡ˆä¸€å®šå°±æ˜¯ä¸€æ®µä¸€æ®µæ—¶é—´ï¼Œæ¯ä¸€æ®µæ—¶é—´å†…çš„æ´»åŠ¨éƒ½æ˜¯åœ¨åŒä¸€ä¸ªä¼šåœºä¸¾è¡Œã€‚æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†ä¸€ä¸ª $tot_{l,r}$ è¡¨ç¤ºå®Œå…¨åœ¨æ—¶é—´ $l,r$ ä¹‹å†…çš„æ´»åŠ¨æœ‰å¤šå°‘ä¸ªã€‚è®¡ç®—ç›´æ¥æš´åŠ›ï¼Œé¢„å¤„ç†çš„å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="OI" scheme="http://qiulyblog.github.io/categories/OI/"/>
    
    
      <category term="DP" scheme="http://qiulyblog.github.io/tags/DP/"/>
    
      <category term="é¢˜è§£" scheme="http://qiulyblog.github.io/tags/%E9%A2%98%E8%A7%A3/"/>
    
      <category term="å†³ç­–å•è°ƒæ€§" scheme="http://qiulyblog.github.io/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7/"/>
    
  </entry>
  
</feed>
